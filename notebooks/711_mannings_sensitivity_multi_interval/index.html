
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library for automating HEC-RAS operations">
      
      
        <meta name="author" content="William Katzenmeyer, P.E., C.F.M.">
      
      
        <link rel="canonical" href="https://gpt-cmdr.github.io/ras-commander/notebooks/711_mannings_sensitivity_multi_interval/">
      
      
        <link rel="prev" href="../710_mannings_sensitivity_bulk_analysis/">
      
      
        <link rel="next" href="../720_atlas14_aep_events/">
      
      
        
      
      
      <link rel="icon" href="../../assets/ras-commander_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Manning's n Multi-Interval - RAS Commander Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mannings-n-multi-interval" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="RAS Commander Documentation" class="md-header__button md-logo" aria-label="RAS Commander Documentation" data-md-component="logo">
      
  <img src="../../assets/ras-commander_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RAS Commander Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Manning's n Multi-Interval
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/gpt-cmdr/ras-commander" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    gpt-cmdr/ras-commander
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../examples/" class="md-tabs__link">
          
  
  
  Example Notebooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../parallel-compute/" class="md-tabs__link">
          
  
  
  Parallel Compute

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/file-formats/" class="md-tabs__link">
          
  
  
  RAS Data Formats

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cognitive-infrastructure/" class="md-tabs__link">
          
  
  
  Cognitive Infrastructure

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/llm-development/" class="md-tabs__link">
          
  
  
  LLM Forward Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/acknowledgments/" class="md-tabs__link">
          
  
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="RAS Commander Documentation" class="md-nav__button md-logo" aria-label="RAS Commander Documentation" data-md-component="logo">
      
  <img src="../../assets/ras-commander_logo.svg" alt="logo">

    </a>
    RAS Commander Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gpt-cmdr/ras-commander" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    gpt-cmdr/ras-commander
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/project-initialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Project Initialization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/plan-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plan Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/workflows-and-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflows & Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/boundary-conditions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Boundary Conditions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/spatial-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spatial Data & RASMapper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/hdf-data-extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HDF Data Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/geometry-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometry Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/steady-flow-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Steady Flow Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/dam-breach-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dam Breach Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/dss-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSS Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_12" >
        
          
          <label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Quality Assurance (RasCheck)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quality Assurance (RasCheck)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/nt-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NT Check (Manning's n)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/xs-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    XS Check (Cross Sections)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/structure-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structure Check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/floodway-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Floodway Check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/quality-assurance/profiles-check/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profiles Check
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/legacy-com-interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Legacy COM Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/remote-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Example Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Example Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Basic Automation & Project Data (100s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Basic Automation & Project Data (100s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../100_using_ras_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using RasExamples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../101_project_initialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Project Initialization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../102_multiple_project_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple Project Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../103_plan_and_geometry_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plan and Geometry Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../104_plan_parameter_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plan Parameter Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../110_single_plan_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single Plan Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../111_executing_plan_sets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Executing Plan Sets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../112_sequential_plan_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sequential Plan Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../113_parallel_execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parallel Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../120_automating_ras_with_win32com/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Win32COM Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../121_legacy_hecrascontroller_and_rascontrol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Legacy HECRASController
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Geometry Parsing & Operations (200s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Geometry Parsing & Operations (200s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../201_1d_plaintext_geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1D Plaintext Geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../202_2d_plaintext_geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2D Plaintext Geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../210_fixit_blocked_obstructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fixit Blocked Obstructions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Boundary Conditions (300s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Boundary Conditions (300s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../300_unsteady_flow_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unsteady Flow Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../310_dss_boundary_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSS Boundary Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../311_validating_dss_paths/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSS Path Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../320_1d_boundary_condition_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1D Boundary Visualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    HDF Data Operations (400s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    HDF Data Operations (400s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../400_1d_hdf_data_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1D HDF Data Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../401_steady_flow_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Steady Flow Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../410_2d_hdf_data_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2D HDF Data Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../411_2d_hdf_pipes_and_pumps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pipes and Pumps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../412_2d_detail_face_data_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2D Face Data Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../420_breach_results_extraction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Breach Results Extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Remote Plan Execution (500s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Remote Plan Execution (500s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../500_remote_execution_psexec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Execution (PsExec)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Data Analysis (600s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Data Analysis (600s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../600_floodplain_mapping_gui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Floodplain Mapping GUI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../601_floodplain_mapping_rasprocess/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Floodplain Mapping RasProcess
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../602_floodplain_mapping_python_gis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Floodplain Mapping Python GIS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../610_fluvial_pluvial_delineation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fluvial-Pluvial Delineation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../611_validating_map_layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Map Layer Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" checked>
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Sensitivity & Benchmarking (700s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sensitivity & Benchmarking (700s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../700_core_sensitivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Sensitivity Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../701_benchmarking_versions_6.1_to_6.6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version Benchmarking (6.1-6.6)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../710_mannings_sensitivity_bulk_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manning's n Bulk Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Manning's n Multi-Interval
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Manning's n Multi-Interval
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../720_atlas14_aep_events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Atlas 14 AEP Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../721_atlas14_caching_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Atlas 14 Caching Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../722_atlas14_multi_project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Atlas 14 Multi-Project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Quality Assurance (800s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quality Assurance (800s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../800_quality_assurance_rascheck/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RasCheck Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../801_advanced_structure_validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Structure Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../802_custom_workflows_and_standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Workflows & Standards
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    External Data Integrations (900s)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    External Data Integrations (900s)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../900_aorc_precipitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AORC Precipitation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../901_aorc_precipitation_catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AORC Precipitation Catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../910_usgs_gauge_catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    USGS Gauge Catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../911_usgs_gauge_data_integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    USGS Gauge Data Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../912_usgs_real_time_monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    USGS Real-Time Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../913_bc_generation_from_live_gauge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BC from Live Gauge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../914_model_validation_with_usgs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Validation with USGS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Parallel Compute
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Parallel Compute
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel-compute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel-compute/local-parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Local Parallel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel-compute/remote-parallel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Parallel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel-compute/scaling-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel-compute/worker-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/hdf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HDF Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometry Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fixit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fixit Module
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/dss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DSS Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/remote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/dataframe-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DataFrame Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RAS Data Formats
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    RAS Data Formats
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/file-formats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/prj-parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PRJ File Parsing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/geometry-parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometry Parsing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/unsteady-parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unsteady File Parsing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/steady-parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Steady File Parsing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/hdf-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HDF Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/hdf-writing-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HDF Writing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/quick-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cognitive Infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cognitive-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cognitive-infrastructure/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cognitive-infrastructure/skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skills
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cognitive-infrastructure/commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM Forward Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM Forward Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/llm-development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/agent-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Acknowledgments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mannings-n-multi-interval">Manning's n Multi-Interval<a class="headerlink" href="#mannings-n-multi-interval" title="Permanent link">&para;</a></h1>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># =============================================================================</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="c1"># DEVELOPMENT MODE TOGGLE</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># =============================================================================</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">USE_LOCAL_SOURCE</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># &lt;-- TOGGLE THIS</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">if</span> <span class="n">USE_LOCAL_SOURCE</span><span class="p">:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">local_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="k">if</span> <span class="n">local_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">local_path</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; LOCAL SOURCE MODE: Loading from </span><span class="si">{</span><span class="n">local_path</span><span class="si">}</span><span class="s2">/ras_commander&quot;</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; PIP PACKAGE MODE: Loading installed ras-commander&quot;</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Import ras-commander</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ras_commander</span><span class="w"> </span><span class="kn">import</span> <span class="n">HdfMesh</span><span class="p">,</span> <span class="n">HdfResultsMesh</span><span class="p">,</span> <span class="n">RasCmdr</span><span class="p">,</span> <span class="n">RasExamples</span><span class="p">,</span> <span class="n">RasGeo</span><span class="p">,</span> <span class="n">RasPlan</span><span class="p">,</span> <span class="n">init_ras_project</span><span class="p">,</span> <span class="n">ras</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Verify which version loaded</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ras_commander</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Loaded: </span><span class="si">{</span><span class="n">ras_commander</span><span class="o">.</span><span class="vm">__file__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code> PIP PACKAGE MODE: Loading installed ras-commander


 Loaded: c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\site-packages\ras_commander\__init__.py
</code></pre></div>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h2>
<p>Configure these values to customize the notebook for your project.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># =============================================================================</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1"># PARAMETERS - Edit these to customize the notebook</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># =============================================================================</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># Project Configuration</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">PROJECT_NAME</span> <span class="o">=</span> <span class="s2">&quot;BaldEagleCrkMulti2D&quot;</span>  <span class="c1"># Example project to extract</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">RAS_VERSION</span> <span class="o">=</span> <span class="s2">&quot;6.6&quot;</span>                   <span class="c1"># HEC-RAS version</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="c1"># Manning&#39;s Sensitivity Settings</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">PLAN</span> <span class="o">=</span> <span class="s2">&quot;03&quot;</span>                           <span class="c1"># Template plan</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">PARAMETER_VALUES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>  <span class="c1"># Manning&#39;s n multipliers</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">POINT_OF_INTEREST</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2081544</span><span class="p">,</span> <span class="mi">365715</span><span class="p">)</span>  <span class="c1"># (x, y) for result extraction</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c1"># Execution Settings</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">RUN_PARALLEL</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">MAX_WORKERS</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="n">NUM_CORES</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="c1"># Output Configuration</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="n">OUTPUTS_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;_outputs&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;711_mannings_sensitivity_multi_interval&quot;</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="c1"># Create output directory</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="n">OUTPUTS_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Outputs will be saved to: </span><span class="si">{</span><span class="n">OUTPUTS_DIR</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h1 id="mannings-n-sensitivity-analysis-multi-interval-approach">Manning's n Sensitivity Analysis: Multi-Interval Approach<a class="headerlink" href="#mannings-n-sensitivity-analysis-multi-interval-approach" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>This notebook demonstrates <strong>regional Manning's n sensitivity analysis</strong> for HEC-RAS 2D models with multiple roughness zones. This approach isolates the influence of individual regions rather than varying all parameters simultaneously.</p>
<h3 id="sensitivity-analysis-methodology">Sensitivity Analysis Methodology<a class="headerlink" href="#sensitivity-analysis-methodology" title="Permanent link">&para;</a></h3>
<p><strong>One-at-a-Time (OAT) Method</strong>:
1. Establish baseline Manning's n values for all regions
2. Vary ONE region at a time while holding others constant
3. Measure water surface elevation change at point of interest
4. Calculate sensitivity metric: WS E/ n for each region
5. Rank regions by sensitivity to prioritize calibration efforts</p>
<p><strong>Why Multi-Interval?</strong></p>
<ul>
<li><strong>Individual Attribution</strong>: Isolates effect of each specific region</li>
<li><strong>Calibration Strategy</strong>: Identifies which regions need refinement</li>
<li><strong>Data Prioritization</strong>: Focuses field surveys on high-sensitivity areas</li>
<li><strong>Interaction Detection</strong>: Reveals if regions have coupled effects</li>
</ul>
<h3 id="llm-forward-principle-professional-judgment">LLM Forward Principle: Professional Judgment<a class="headerlink" href="#llm-forward-principle-professional-judgment" title="Permanent link">&para;</a></h3>
<p>Manning's n calibration requires engineering expertise:
- <strong>Physical Realism</strong>: Parameters must match actual land cover
- <strong>Observational Data</strong>: Calibrate to measured water surfaces when available
- <strong>Parameter Bounds</strong>: Stay within physically defensible ranges
- <strong>Model Purpose</strong>: Calibration rigor depends on decision stakes</p>
<h3 id="expected-sensitivity-patterns">Expected Sensitivity Patterns<a class="headerlink" href="#expected-sensitivity-patterns" title="Permanent link">&para;</a></h3>
<p><strong>High Sensitivity Regions</strong>:
- <strong>Main channel</strong>: Direct impact on conveyance
- <strong>Floodplain upstream of POI</strong>: Large area, significant storage/conveyance
- <strong>Constrictions</strong>: Bottlenecks amplify roughness effects</p>
<p><strong>Low Sensitivity Regions</strong>:
- <strong>Isolated floodplain pockets</strong>: Limited hydraulic connectivity
- <strong>High-ground areas</strong>: Rarely inundated
- <strong>Downstream of POI</strong>: Backwater effects minimal for subcritical flow</p>
<h3 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h3>
<p>For sensitivity analysis in hydraulic modeling:
- <a href="https://www.hec.usace.army.mil/software/hec-ras/documentation.aspx">HEC-RAS User Manual, Chapter 11: Model Calibration</a>
- <a href="https://ascelibrary.org/">ASCE Task Committee on Calibration: Guidelines</a></p>
<p>For Manning's n uncertainty bounds:
- <a href="https://www.amazon.com/Open-Channel-Hydraulics-Ven-Chow/dp/1932846182">Chow (1959) Open-Channel Hydraulics, Table 5-6</a>
- <a href="https://pubs.er.usgs.gov/publication/wsp2339">Arcement &amp; Schneider (1989) USGS WSP 2339: Roughness in Natural Channels</a></p>
<p>For advanced sensitivity methods:
- <a href="https://onlinelibrary.wiley.com/doi/book/10.1002/9780470725184">Saltelli et al. (2008) Global Sensitivity Analysis</a>
- <a href="https://www.sciencedirect.com/science/article/pii/S0022169410006335">Sobol Indices for hydraulic models</a></p>
<h3 id="workflow-overview">Workflow Overview<a class="headerlink" href="#workflow-overview" title="Permanent link">&para;</a></h3>
<p><strong>Part 1: Setup and Configuration</strong>
- Extract project and initialize ras-commander
- Define Manning's n baseline and variation ranges</p>
<p><strong>Part 2: Base Override Sensitivity</strong>
- Test global Manning's n scaling (all regions varied proportionally)
- Establishes overall model sensitivity to roughness</p>
<p><strong>Part 3: Regional Override Sensitivity</strong>
- Test individual Manning's n regions (one at a time)
- Identifies most influential zones for calibration focus</p>
<h3 id="interpretation-guidance">Interpretation Guidance<a class="headerlink" href="#interpretation-guidance" title="Permanent link">&para;</a></h3>
<p><strong>Sensitivity Metrics</strong>:
- <strong>Absolute Sensitivity</strong>: WSE (ft) / n (dimensionless)
  - Example: 0.5 ft/0.01 = 50 ft change per unit Manning's n change</p>
<ul>
<li><strong>Relative Sensitivity (Elasticity)</strong>: (WSE/WSE) / (n/n)</li>
<li>
<p>Normalized, allows comparison across different parameter ranges</p>
</li>
<li>
<p><strong>Variance Contribution</strong>: Fraction of total output variance explained by parameter</p>
</li>
</ul>
<p><strong>Typical Values</strong>:
- <strong>High sensitivity</strong>: &gt;1 ft WSE change for 20% Manning's n variation
- <strong>Moderate sensitivity</strong>: 0.1-1 ft WSE change
- <strong>Low sensitivity</strong>: &lt;0.1 ft WSE change</p>
<h3 id="common-pitfalls">Common Pitfalls<a class="headerlink" href="#common-pitfalls" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Ignoring Parameter Correlation</strong>: Manning's n values may be physically correlated (e.g., seasonal vegetation)</li>
<li><strong>Extrapolating Beyond Bounds</strong>: Sensitivity is local - nonlinear beyond tested range</li>
<li><strong>Confounding Effects</strong>: Other parameters (bathymetry, boundary conditions) may mask roughness effects</li>
<li><strong>Calibration Overfitting</strong>: Don't over-calibrate to single event - validate with independent data</li>
</ul>
<h5 id="optional-code-cell-for-developmenttesting-mode-local-copy">Optional Code Cell For Development/Testing Mode (Local Copy)<a class="headerlink" href="#optional-code-cell-for-developmenttesting-mode-local-copy" title="Permanent link">&para;</a></h5>
<h5 id="uncomment-and-run-this-cell-instead-of-the-pip-cell-above">Uncomment and run this cell instead of the pip cell above<a class="headerlink" href="#uncomment-and-run-this-cell-instead-of-the-pip-cell-above" title="Permanent link">&para;</a></h5>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># For Development Mode, add the parent directory to the Python path</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">current_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">rascmdr_directory</span> <span class="o">=</span> <span class="n">current_file</span><span class="o">.</span><span class="n">parent</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1"># Use insert(0) instead of append() to give highest priority to local version</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">rascmdr_directory</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rascmdr_directory</span><span class="p">))</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading ras-commander from local dev copy&quot;</span><span class="p">)</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">ras_commander</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span></code></pre></div>
<h1 id="part-1-setup-and-configuration">Part 1: Setup and Configuration<a class="headerlink" href="#part-1-setup-and-configuration" title="Permanent link">&para;</a></h1>
<h2 id="important-note-on-dataframe-column-naming">Important Note on DataFrame Column Naming<a class="headerlink" href="#important-note-on-dataframe-column-naming" title="Permanent link">&para;</a></h2>
<p><strong>Column Naming Convention in ras-commander:</strong></p>
<p>The <code>ras-commander</code> library uses simplified column names in DataFrames for Manning's n values:</p>
<ul>
<li><strong>DataFrame column</strong>: <code>Mannings n</code> (no apostrophe)</li>
<li><strong>HEC-RAS HDF files</strong>: <code>Manning's n</code> (with apostrophe - official technical term)</li>
</ul>
<p>This design decision simplifies DataFrame operations by avoiding special characters in column names, while HEC-RAS's internal HDF structure retains the technically correct spelling with the apostrophe.</p>
<p><strong>Key Point</strong>: When working with Manning's n values from <code>ras-commander</code>, always reference the column as <code>Mannings n</code> (without apostrophe) in your DataFrame operations.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">## Standard Library and Third-Party Imports</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c1"># Configure matplotlib for inline display in Jupyter</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Define the mannings n max and min values as a range. </span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">manning_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;NoData&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.050</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.070</span><span class="p">},</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Barren Land Rock/Sand/Clay&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.023</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.100</span><span class="p">},</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cultivated Crops&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.020</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.100</span><span class="p">},</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deciduous Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.100</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.200</span><span class="p">},</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, High Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.120</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.200</span><span class="p">},</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Low Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.060</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.120</span><span class="p">},</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Medium Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.080</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.160</span><span class="p">},</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Open Space&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.030</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.090</span><span class="p">},</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Emergent Herbaceous Wetlands&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.050</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.120</span><span class="p">},</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Evergreen Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.080</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.160</span><span class="p">},</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Grassland/Herbaceous&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.070</span><span class="p">},</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mixed Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.080</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.200</span><span class="p">},</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Open Water&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.050</span><span class="p">},</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Pasture/Hay&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.025</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.090</span><span class="p">},</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Shrub/Scrub&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.070</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.160</span><span class="p">},</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Woody Wetlands&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.045</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.150</span><span class="p">}</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="p">]</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="c1"># Create DataFrame</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="n">manning_minmax_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">manning_data</span><span class="p">)</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="c1"># Calculate the midpoint value</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;mid_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="c1"># Sort by land cover name</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="n">manning_minmax_df</span> <span class="o">=</span> <span class="n">manning_minmax_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="c1"># Print summary information</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n value ranges for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> land cover types:&quot;</span><span class="p">)</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="nb">print</span><span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Manning&#39;s n value ranges for 16 land cover types:
                 Land Cover Name  min_n  max_n   mid_n
0     Barren Land Rock/Sand/Clay  0.023   0.10  0.0615
1               Cultivated Crops  0.020   0.10  0.0600
2               Deciduous Forest  0.100   0.20  0.1500
3      Developed, High Intensity  0.120   0.20  0.1600
4       Developed, Low Intensity  0.060   0.12  0.0900
5    Developed, Medium Intensity  0.080   0.16  0.1200
6          Developed, Open Space  0.030   0.09  0.0600
7   Emergent Herbaceous Wetlands  0.050   0.12  0.0850
8               Evergreen Forest  0.080   0.16  0.1200
9           Grassland/Herbaceous  0.025   0.07  0.0475
10                  Mixed Forest  0.080   0.20  0.1400
11                        NoData  0.050   0.07  0.0600
12                    Open Water  0.025   0.05  0.0375
13                   Pasture/Hay  0.025   0.09  0.0575
14                   Shrub/Scrub  0.070   0.16  0.1150
15                Woody Wetlands  0.045   0.15  0.0975
</code></pre></div>
<h2 id="helper-functions-for-sensitivity-analysis">Helper Functions for Sensitivity Analysis<a class="headerlink" href="#helper-functions-for-sensitivity-analysis" title="Permanent link">&para;</a></h2>
<p>The following functions support the sensitivity analysis workflow by:
1. <strong>Analyzing land cover statistics</strong> in the 2D mesh
2. <strong>Generating test values</strong> at specified intervals
3. <strong>Estimating plan counts</strong> to avoid exceeding HEC-RAS limits</p>
<p>These utilities are used by both base and regional override sensitivity functions.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_sensitivity_values</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">current_val</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="sd">    Generate a list of Manning&#39;s n values for sensitivity testing.</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="sd">    Args:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="sd">        min_val (float): Minimum value from literature</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="sd">        max_val (float): Maximum value from literature</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="sd">        current_val (float): Current value in the model</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="sd">        interval (float): Interval between test values</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="sd">    Returns:</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="sd">        list: List of n values to test</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="c1"># Round values to avoid floating point issues</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="n">min_val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="n">max_val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">max_val</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="n">current_val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">current_val</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="n">interval</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>    <span class="c1"># Generate values from min to max at specified interval</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="n">all_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">+</span> <span class="n">interval</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="n">all_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">all_values</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Round to avoid floating point issues</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="c1"># Remove current value if it&#39;s in the range</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">all_values</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">current_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">interval</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>    <span class="c1"># Make sure current value is not in the list</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>    <span class="k">if</span> <span class="n">current_val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>        <span class="n">values</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">current_val</span><span class="p">)</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>    <span class="k">return</span> <span class="n">values</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="k">def</span><span class="w"> </span><span class="nf">estimate_plan_count</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">,</span> <span class="n">n_ranges</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="sd">    Estimate the number of plans that will be created for sensitivity analysis.</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="sd">    Args:</span>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="sd">        significant_landuses (pd.DataFrame): DataFrame with significant land cover types</span>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="sd">        n_ranges (pd.DataFrame): DataFrame with Manning&#39;s n ranges</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="sd">        interval (float): Interval between test values</span>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="sd">    Returns:</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="sd">        int: Estimated number of plans</span>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>    <span class="n">total_plans</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landuse</span> <span class="ow">in</span> <span class="n">significant_landuses</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>        <span class="n">land_cover</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]</span>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>        <span class="n">current_n</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Current_n&#39;</span><span class="p">]</span>
</span><span id="__span-5-50"><a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>
</span><span id="__span-5-51"><a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>        <span class="c1"># Find matching land cover in n_ranges</span>
</span><span id="__span-5-52"><a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">n_ranges</span><span class="p">[</span><span class="n">n_ranges</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span>
</span><span id="__span-5-53"><a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>        <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-5-54"><a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>            <span class="k">continue</span>
</span><span id="__span-5-55"><a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>
</span><span id="__span-5-56"><a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a>        <span class="n">min_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-5-57"><a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>        <span class="n">max_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-5-58"><a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>
</span><span id="__span-5-59"><a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a>        <span class="c1"># Count values between min and max at interval spacing, excluding current value</span>
</span><span id="__span-5-60"><a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>        <span class="n">values</span> <span class="o">=</span> <span class="n">generate_sensitivity_values</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">,</span> <span class="n">current_n</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-5-61"><a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>        <span class="n">total_plans</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-5-62"><a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a>
</span><span id="__span-5-63"><a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a>    <span class="k">return</span> <span class="n">total_plans</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">analyze_mesh_land_cover_statistics</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">geom_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plan_number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="sd">    Analyze the land cover statistics for a 2D mesh area in a HEC-RAS model,</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="sd">    excluding areas controlled by regional Manning&#39;s n overrides.</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="sd">    Args:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="sd">        project_folder (str): Path to the HEC-RAS project folder</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="sd">        geom_number (str, optional): Geometry number to use. If None, will use</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="sd">                                    geometry from plan_number or the first geometry.</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="sd">        plan_number (str, optional): Plan number to use. If None, will use the first plan.</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="sd">    Returns:</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="sd">        pd.DataFrame: DataFrame with land cover statistics for areas controlled by base overrides</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>    <span class="c1"># Initialize RAS project</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>    <span class="n">ras</span> <span class="o">=</span> <span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    <span class="c1"># [existing code to get geometry number and paths]</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>    <span class="c1"># Get the geometry file path</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    <span class="n">geom_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">geom_number</span><span class="p">,</span> <span class="s1">&#39;full_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>    <span class="c1"># Get the geometry HDF path</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>    <span class="n">geom_hdf_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">geom_number</span><span class="p">,</span> <span class="s1">&#39;hdf_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>    <span class="c1"># Get mesh areas from the geometry</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>    <span class="n">mesh_areas_gdf</span> <span class="o">=</span> <span class="n">HdfMesh</span><span class="o">.</span><span class="n">get_mesh_areas</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">)</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>    <span class="n">num_mesh_areas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mesh_areas_gdf</span><span class="p">)</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>    <span class="c1"># Get the base Manning&#39;s overrides to compare with land cover statistics</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>    <span class="n">base_overrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_baseoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>    <span class="c1"># Get regional override information</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>    <span class="n">region_overrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_regionoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>    <span class="n">regional_mask</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>    <span class="c1"># If regional overrides exist, get their geometries to exclude them</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regional Manning&#39;s n overrides found - these areas will be excluded from base sensitivity analysis&quot;</span><span class="p">)</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>        <span class="c1"># Get regional override polygons from the geometry</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>        <span class="n">regional_polygons_gdf</span> <span class="o">=</span> <span class="n">get_regional_override_polygons</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">)</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">regional_polygons_gdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>            <span class="c1"># Create a union of all regional override polygons to use as a mask</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>            <span class="n">regional_mask</span> <span class="o">=</span> <span class="n">regional_polygons_gdf</span><span class="o">.</span><span class="n">unary_union</span>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Excluding </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">regional_polygons_gdf</span><span class="p">)</span><span class="si">}</span><span class="s2"> regional override areas from analysis&quot;</span><span class="p">)</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>    <span class="n">all_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">mesh_areas_gdf</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>        <span class="n">mesh_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;mesh_name&#39;</span><span class="p">]</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>        <span class="n">mesh_geom</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzing land cover for mesh area: </span><span class="si">{</span><span class="n">mesh_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>        <span class="c1"># Get effective mesh area (excluding regional overrides)</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>        <span class="n">effective_mesh_geom</span> <span class="o">=</span> <span class="n">mesh_geom</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>        <span class="k">if</span> <span class="n">regional_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>            <span class="k">if</span> <span class="n">mesh_geom</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">regional_mask</span><span class="p">):</span>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>                <span class="n">effective_mesh_geom</span> <span class="o">=</span> <span class="n">mesh_geom</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">regional_mask</span><span class="p">)</span>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Excluded regional override areas from mesh </span><span class="si">{</span><span class="n">mesh_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>        <span class="n">total_area</span> <span class="o">=</span> <span class="n">effective_mesh_geom</span><span class="o">.</span><span class="n">area</span>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a>        <span class="c1"># Create a simulated land cover distribution based on base_overrides</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a>        <span class="c1"># In reality, you would use actual spatial analysis with the land cover raster</span>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>        <span class="n">landcover_stats</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>        <span class="c1"># Use the land cover types from the base overrides</span>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">override_row</span> <span class="ow">in</span> <span class="n">base_overrides</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a>            <span class="n">land_cover</span> <span class="o">=</span> <span class="n">override_row</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span>
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a>            <span class="n">n_value</span> <span class="o">=</span> <span class="n">override_row</span><span class="p">[</span><span class="s2">&quot;Base Mannings n Value&quot;</span><span class="p">]</span>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a>            <span class="c1"># Generate a random percentage for this example</span>
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a>            <span class="c1"># In reality, this would come from actual spatial analysis</span>
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a>            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">land_cover</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># Use the land cover name as a seed</span>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a>            <span class="n">percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">25</span>  <span class="c1"># Random percentage between 0-25%</span>
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>            <span class="n">area</span> <span class="o">=</span> <span class="n">total_area</span> <span class="o">*</span> <span class="p">(</span><span class="n">percentage</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a>
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>            <span class="n">landcover_stats</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a>                <span class="s1">&#39;Land Cover Type&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a>                <span class="s1">&#39;Area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a>                <span class="s1">&#39;Percentage&#39;</span><span class="p">:</span> <span class="n">percentage</span><span class="p">,</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>                <span class="s1">&#39;Current_n&#39;</span><span class="p">:</span> <span class="n">n_value</span>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a>            <span class="p">})</span>
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a>
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a>        <span class="c1"># Create DataFrame and sort by percentage</span>
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a>        <span class="n">landcover_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">landcover_stats</span><span class="p">)</span>
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a>        <span class="n">landcover_df</span> <span class="o">=</span> <span class="n">landcover_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a>        <span class="c1"># Store the results</span>
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a>        <span class="n">all_results</span><span class="p">[</span><span class="n">mesh_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">landcover_df</span>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a>
</span><span id="__span-6-95"><a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a>    <span class="c1"># If there&#39;s only one mesh area, return its dataframe directly</span>
</span><span id="__span-6-96"><a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-6-97"><a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a>        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">all_results</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
</span><span id="__span-6-98"><a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a>
</span><span id="__span-6-99"><a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a>    <span class="k">return</span> <span class="n">all_results</span>
</span><span id="__span-6-100"><a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a>
</span><span id="__span-6-101"><a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_regional_override_polygons</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">):</span>
</span><span id="__span-6-102"><a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-6-103"><a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a><span class="sd">    Extract regional override polygon geometries from a HEC-RAS geometry HDF file.</span>
</span><span id="__span-6-104"><a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a>
</span><span id="__span-6-105"><a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a><span class="sd">    Returns:</span>
</span><span id="__span-6-106"><a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a><span class="sd">        geopandas.GeoDataFrame: GeoDataFrame with regional override polygons,</span>
</span><span id="__span-6-107"><a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a><span class="sd">                                 or empty GeoDataFrame if no regional areas exist</span>
</span><span id="__span-6-108"><a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a>
</span><span id="__span-6-109"><a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a><span class="sd">    Raises:</span>
</span><span id="__span-6-110"><a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a><span class="sd">        FileNotFoundError: If geom_hdf_path doesn&#39;t exist</span>
</span><span id="__span-6-111"><a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a><span class="sd">        OSError: If HDF file is corrupted or inaccessible</span>
</span><span id="__span-6-112"><a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-6-113"><a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">h5py</span>
</span><span id="__span-6-114"><a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
</span><span id="__span-6-115"><a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Polygon</span>
</span><span id="__span-6-116"><a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-6-117"><a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a>
</span><span id="__span-6-118"><a id="__codelineno-6-118" name="__codelineno-6-118" href="#__codelineno-6-118"></a>    <span class="c1"># Validate file exists before opening</span>
</span><span id="__span-6-119"><a id="__codelineno-6-119" name="__codelineno-6-119" href="#__codelineno-6-119"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-6-120"><a id="__codelineno-6-120" name="__codelineno-6-120" href="#__codelineno-6-120"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Geometry HDF file not found: </span><span class="si">{</span><span class="n">geom_hdf_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-121"><a id="__codelineno-6-121" name="__codelineno-6-121" href="#__codelineno-6-121"></a>
</span><span id="__span-6-122"><a id="__codelineno-6-122" name="__codelineno-6-122" href="#__codelineno-6-122"></a>    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-6-123"><a id="__codelineno-6-123" name="__codelineno-6-123" href="#__codelineno-6-123"></a>        <span class="c1"># Check if regional overrides exist</span>
</span><span id="__span-6-124"><a id="__codelineno-6-124" name="__codelineno-6-124" href="#__codelineno-6-124"></a>        <span class="k">if</span> <span class="s1">&#39;Geometry/Regional Manning Areas&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-6-125"><a id="__codelineno-6-125" name="__codelineno-6-125" href="#__codelineno-6-125"></a>            <span class="c1"># Expected case: no regional overrides in this model</span>
</span><span id="__span-6-126"><a id="__codelineno-6-126" name="__codelineno-6-126" href="#__codelineno-6-126"></a>            <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
</span><span id="__span-6-127"><a id="__codelineno-6-127" name="__codelineno-6-127" href="#__codelineno-6-127"></a>
</span><span id="__span-6-128"><a id="__codelineno-6-128" name="__codelineno-6-128" href="#__codelineno-6-128"></a>        <span class="n">region_group</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;Geometry/Regional Manning Areas&#39;</span><span class="p">]</span>
</span><span id="__span-6-129"><a id="__codelineno-6-129" name="__codelineno-6-129" href="#__codelineno-6-129"></a>        <span class="n">polygons</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-6-130"><a id="__codelineno-6-130" name="__codelineno-6-130" href="#__codelineno-6-130"></a>        <span class="n">region_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-6-131"><a id="__codelineno-6-131" name="__codelineno-6-131" href="#__codelineno-6-131"></a>
</span><span id="__span-6-132"><a id="__codelineno-6-132" name="__codelineno-6-132" href="#__codelineno-6-132"></a>        <span class="c1"># Process each regional override polygon</span>
</span><span id="__span-6-133"><a id="__codelineno-6-133" name="__codelineno-6-133" href="#__codelineno-6-133"></a>        <span class="k">for</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">region_data</span> <span class="ow">in</span> <span class="n">region_group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-6-134"><a id="__codelineno-6-134" name="__codelineno-6-134" href="#__codelineno-6-134"></a>            <span class="k">if</span> <span class="s1">&#39;Polygon&#39;</span> <span class="ow">in</span> <span class="n">region_data</span><span class="p">:</span>
</span><span id="__span-6-135"><a id="__codelineno-6-135" name="__codelineno-6-135" href="#__codelineno-6-135"></a>                <span class="n">coords</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="s1">&#39;Polygon&#39;</span><span class="p">][:]</span>
</span><span id="__span-6-136"><a id="__codelineno-6-136" name="__codelineno-6-136" href="#__codelineno-6-136"></a>                <span class="n">polygon</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</span><span id="__span-6-137"><a id="__codelineno-6-137" name="__codelineno-6-137" href="#__codelineno-6-137"></a>                <span class="n">polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
</span><span id="__span-6-138"><a id="__codelineno-6-138" name="__codelineno-6-138" href="#__codelineno-6-138"></a>                <span class="n">region_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_name</span><span class="p">)</span>
</span><span id="__span-6-139"><a id="__codelineno-6-139" name="__codelineno-6-139" href="#__codelineno-6-139"></a>
</span><span id="__span-6-140"><a id="__codelineno-6-140" name="__codelineno-6-140" href="#__codelineno-6-140"></a>        <span class="c1"># Return GeoDataFrame with regional overrides (or empty if none)</span>
</span><span id="__span-6-141"><a id="__codelineno-6-141" name="__codelineno-6-141" href="#__codelineno-6-141"></a>        <span class="k">if</span> <span class="n">polygons</span><span class="p">:</span>
</span><span id="__span-6-142"><a id="__codelineno-6-142" name="__codelineno-6-142" href="#__codelineno-6-142"></a>            <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
</span><span id="__span-6-143"><a id="__codelineno-6-143" name="__codelineno-6-143" href="#__codelineno-6-143"></a>                <span class="p">{</span><span class="s1">&#39;region_name&#39;</span><span class="p">:</span> <span class="n">region_names</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">:</span> <span class="n">polygons</span><span class="p">},</span>
</span><span id="__span-6-144"><a id="__codelineno-6-144" name="__codelineno-6-144" href="#__codelineno-6-144"></a>                <span class="n">crs</span><span class="o">=</span><span class="s1">&#39;EPSG:4326&#39;</span>  <span class="c1"># Set appropriate CRS</span>
</span><span id="__span-6-145"><a id="__codelineno-6-145" name="__codelineno-6-145" href="#__codelineno-6-145"></a>            <span class="p">)</span>
</span><span id="__span-6-146"><a id="__codelineno-6-146" name="__codelineno-6-146" href="#__codelineno-6-146"></a>            <span class="k">return</span> <span class="n">gdf</span>
</span><span id="__span-6-147"><a id="__codelineno-6-147" name="__codelineno-6-147" href="#__codelineno-6-147"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-148"><a id="__codelineno-6-148" name="__codelineno-6-148" href="#__codelineno-6-148"></a>            <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
</span></code></pre></div>
<h1 id="part-2-base-override-sensitivity-analysis">Part 2: Base Override Sensitivity Analysis<a class="headerlink" href="#part-2-base-override-sensitivity-analysis" title="Permanent link">&para;</a></h1>
<h2 id="overview_1">Overview<a class="headerlink" href="#overview_1" title="Permanent link">&para;</a></h2>
<p>Base override sensitivity analysis varies Manning's n values for individual land cover types across the entire 2D mesh area. This approach is appropriate when:
- Evaluating the impact of global land cover roughness changes
- Calibrating models with uniform land cover distributions
- Assessing which land cover types have the greatest influence on results</p>
<p>The analysis automatically:
1. Identifies land covers exceeding the area coverage threshold
2. Generates test scenarios at specified intervals within literature ranges
3. Executes plans in parallel
4. Extracts results at a point of interest
5. Creates sensitivity plots and time series comparisons</p>
<h2 id="function-individual_landuse_sensitivity_base">Function: individual_landuse_sensitivity_base()<a class="headerlink" href="#function-individual_landuse_sensitivity_base" title="Permanent link">&para;</a></h2>
<p>This function performs the complete base override sensitivity workflow.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">individual_landuse_sensitivity_base</span><span class="p">(</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">project_folder</span><span class="p">,</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">point_of_interest</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">area_threshold</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># percentage threshold for significant land uses</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="n">max_workers</span><span class="o">=</span><span class="n">MAX_WORKERS</span><span class="p">,</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">,</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;Individual_Landuse_Sensitivity&quot;</span><span class="p">,</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    <span class="n">n_ranges</span><span class="o">=</span><span class="kc">None</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="p">):</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="sd">    Perform sensitivity analysis by varying individual land use Manning&#39;s n values</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="sd">    in the base overrides.</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="sd">    Args:</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="sd">        project_folder (str): Path to HEC-RAS project folder</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="sd">        template_plan (str): Plan number to use as template</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="sd">        point_of_interest (tuple or Point): Coordinates for extracting results</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="sd">        area_threshold (float): Percentage threshold for significant land uses</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="sd">        interval (float): Interval for Manning&#39;s n test values</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="sd">        max_workers (int): Number of parallel workers</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="sd">        num_cores (int): Number of cores per worker</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="sd">        output_folder (str): Name of output folder</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="sd">        n_ranges (pd.DataFrame): DataFrame containing min/max Manning&#39;s n values.</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="sd">                                    Must contain columns: &#39;Land Cover Name&#39;, &#39;min_n&#39;, &#39;max_n&#39;</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="sd">    Returns:</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="sd">        dict: Results of sensitivity analysis</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>    <span class="c1"># Convert point_of_interest to Point if not already</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>        <span class="n">point_of_interest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point_of_interest</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>    <span class="c1"># Verify n_ranges is provided</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>    <span class="k">if</span> <span class="n">n_ranges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n_ranges DataFrame must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>    <span class="c1"># Create timestamp for unique run identifier</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>    <span class="c1"># Initialize RAS project</span>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initializing HEC-RAS project: </span><span class="si">{</span><span class="n">project_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>    <span class="n">ras</span> <span class="o">=</span> <span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>    <span class="c1"># Create output directory</span>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>    <span class="n">results_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">project_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">output_folder</span>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>    <span class="n">results_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results will be saved to: </span><span class="si">{</span><span class="n">results_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>    <span class="c1"># Verify template plan exists</span>
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>    <span class="k">if</span> <span class="n">template_plan</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> not found in project&quot;</span><span class="p">)</span>
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>    <span class="c1"># Get the geometry number for the template plan</span>
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>    <span class="n">template_geom</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_plan</span><span class="p">,</span> <span class="s1">&#39;geometry_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Template plan: </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> (Geometry: </span><span class="si">{</span><span class="n">template_geom</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>    <span class="c1"># Get the geometry file path</span>
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>    <span class="n">geom_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_geom</span><span class="p">,</span> <span class="s1">&#39;full_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a>    <span class="c1"># Get the original Manning&#39;s values</span>
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a>    <span class="n">original_baseoverrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_baseoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>    <span class="n">original_regionoverrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_regionoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>
</span><span id="__span-7-69"><a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a>    <span class="c1"># Analyze land cover statistics for the 2D mesh areas</span>
</span><span id="__span-7-70"><a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analyzing land cover statistics for the 2D mesh areas...&quot;</span><span class="p">)</span>
</span><span id="__span-7-71"><a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a>    <span class="n">landcover_stats</span> <span class="o">=</span> <span class="n">analyze_mesh_land_cover_statistics</span><span class="p">(</span>
</span><span id="__span-7-72"><a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a>        <span class="n">project_folder</span><span class="p">,</span> 
</span><span id="__span-7-73"><a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a>        <span class="n">geom_number</span><span class="o">=</span><span class="n">template_geom</span>
</span><span id="__span-7-74"><a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a>    <span class="p">)</span>
</span><span id="__span-7-75"><a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a>
</span><span id="__span-7-76"><a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a>    <span class="k">if</span> <span class="n">landcover_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-77"><a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not analyze land cover statistics&quot;</span><span class="p">)</span>
</span><span id="__span-7-78"><a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>
</span><span id="__span-7-79"><a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a>    <span class="c1"># Identify significant land uses (above threshold)</span>
</span><span id="__span-7-80"><a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a>    <span class="n">significant_landuses</span> <span class="o">=</span> <span class="n">landcover_stats</span><span class="p">[</span><span class="n">landcover_stats</span><span class="p">[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">area_threshold</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-7-81"><a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a>    <span class="n">significant_landuses</span> <span class="o">=</span> <span class="n">significant_landuses</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-82"><a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a>
</span><span id="__span-7-83"><a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-7-84"><a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No land uses found with coverage above </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">% threshold&quot;</span><span class="p">)</span>
</span><span id="__span-7-85"><a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-7-86"><a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a>
</span><span id="__span-7-87"><a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">)</span><span class="si">}</span><span class="s2"> significant land uses (&gt;= </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">% coverage):&quot;</span><span class="p">)</span>
</span><span id="__span-7-88"><a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">[[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">,</span> <span class="s1">&#39;Current_n&#39;</span><span class="p">]])</span>
</span><span id="__span-7-89"><a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a>
</span><span id="__span-7-90"><a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a>    <span class="c1"># Check if we&#39;ll exceed the plan limit</span>
</span><span id="__span-7-91"><a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a>    <span class="n">current_plan_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">)</span>
</span><span id="__span-7-92"><a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a>    <span class="n">max_plans</span> <span class="o">=</span> <span class="mi">99</span>  <span class="c1"># HEC-RAS limit</span>
</span><span id="__span-7-93"><a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a>    <span class="n">remaining_plans</span> <span class="o">=</span> <span class="n">max_plans</span> <span class="o">-</span> <span class="n">current_plan_count</span>
</span><span id="__span-7-94"><a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a>
</span><span id="__span-7-95"><a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a>    <span class="c1"># Estimate the number of plans needed</span>
</span><span id="__span-7-96"><a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a>    <span class="n">estimated_plan_count</span> <span class="o">=</span> <span class="n">estimate_plan_count</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">,</span> <span class="n">n_ranges</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-7-97"><a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a>
</span><span id="__span-7-98"><a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a>    <span class="k">if</span> <span class="n">estimated_plan_count</span> <span class="o">&gt;</span> <span class="n">remaining_plans</span><span class="p">:</span>
</span><span id="__span-7-99"><a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">WARNING: This analysis would create approximately </span><span class="si">{</span><span class="n">estimated_plan_count</span><span class="si">}</span><span class="s2"> plans, but only </span><span class="si">{</span><span class="n">remaining_plans</span><span class="si">}</span><span class="s2"> more plans can be added (limit is 99)&quot;</span><span class="p">)</span>
</span><span id="__span-7-100"><a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Consider adjusting the following to reduce the number of plans:&quot;</span><span class="p">)</span>
</span><span id="__span-7-101"><a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. Increase the area threshold (currently </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="__span-7-102"><a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Increase the interval between test values (currently </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-7-103"><a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3. Reduce the min/max ranges for land uses&quot;</span><span class="p">)</span>
</span><span id="__span-7-104"><a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4. Select fewer land uses to test&quot;</span><span class="p">)</span>
</span><span id="__span-7-105"><a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a>
</span><span id="__span-7-106"><a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a>        <span class="c1"># Ask for confirmation to continue</span>
</span><span id="__span-7-107"><a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a>        <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Do you want to continue anyway? (y/n): &quot;</span><span class="p">)</span>
</span><span id="__span-7-108"><a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="__span-7-109"><a id="__codelineno-7-109" name="__codelineno-7-109" href="#__codelineno-7-109"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis canceled&quot;</span><span class="p">)</span>
</span><span id="__span-7-110"><a id="__codelineno-7-110" name="__codelineno-7-110" href="#__codelineno-7-110"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-7-111"><a id="__codelineno-7-111" name="__codelineno-7-111" href="#__codelineno-7-111"></a>
</span><span id="__span-7-112"><a id="__codelineno-7-112" name="__codelineno-7-112" href="#__codelineno-7-112"></a>    <span class="c1"># Store the current (template) plan as base scenario</span>
</span><span id="__span-7-113"><a id="__codelineno-7-113" name="__codelineno-7-113" href="#__codelineno-7-113"></a>    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[{</span>
</span><span id="__span-7-114"><a id="__codelineno-7-114" name="__codelineno-7-114" href="#__codelineno-7-114"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span>
</span><span id="__span-7-115"><a id="__codelineno-7-115" name="__codelineno-7-115" href="#__codelineno-7-115"></a>        <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-7-116"><a id="__codelineno-7-116" name="__codelineno-7-116" href="#__codelineno-7-116"></a>        <span class="s1">&#39;geom_number&#39;</span><span class="p">:</span> <span class="n">template_geom</span><span class="p">,</span>
</span><span id="__span-7-117"><a id="__codelineno-7-117" name="__codelineno-7-117" href="#__codelineno-7-117"></a>        <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span>
</span><span id="__span-7-118"><a id="__codelineno-7-118" name="__codelineno-7-118" href="#__codelineno-7-118"></a>        <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-7-119"><a id="__codelineno-7-119" name="__codelineno-7-119" href="#__codelineno-7-119"></a>        <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-7-120"><a id="__codelineno-7-120" name="__codelineno-7-120" href="#__codelineno-7-120"></a>        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;Original Manning&#39;s n Values&quot;</span>
</span><span id="__span-7-121"><a id="__codelineno-7-121" name="__codelineno-7-121" href="#__codelineno-7-121"></a>    <span class="p">}]</span>
</span><span id="__span-7-122"><a id="__codelineno-7-122" name="__codelineno-7-122" href="#__codelineno-7-122"></a>
</span><span id="__span-7-123"><a id="__codelineno-7-123" name="__codelineno-7-123" href="#__codelineno-7-123"></a>    <span class="c1"># Function to create a modified plan with adjusted Manning&#39;s values for a specific land use</span>
</span><span id="__span-7-124"><a id="__codelineno-7-124" name="__codelineno-7-124" href="#__codelineno-7-124"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_modified_plan</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="n">new_n_value</span><span class="p">):</span>
</span><span id="__span-7-125"><a id="__codelineno-7-125" name="__codelineno-7-125" href="#__codelineno-7-125"></a>        <span class="c1"># Create a shortid based on land cover and n value</span>
</span><span id="__span-7-126"><a id="__codelineno-7-126" name="__codelineno-7-126" href="#__codelineno-7-126"></a>        <span class="c1"># Convert land cover name to code (e.g. &quot;Open Water&quot; -&gt; &quot;OW&quot;)</span>
</span><span id="__span-7-127"><a id="__codelineno-7-127" name="__codelineno-7-127" href="#__codelineno-7-127"></a>        <span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">land_cover</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()])</span>
</span><span id="__span-7-128"><a id="__codelineno-7-128" name="__codelineno-7-128" href="#__codelineno-7-128"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
</span><span id="__span-7-129"><a id="__codelineno-7-129" name="__codelineno-7-129" href="#__codelineno-7-129"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">land_cover</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-7-130"><a id="__codelineno-7-130" name="__codelineno-7-130" href="#__codelineno-7-130"></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="__span-7-131"><a id="__codelineno-7-131" name="__codelineno-7-131" href="#__codelineno-7-131"></a>
</span><span id="__span-7-132"><a id="__codelineno-7-132" name="__codelineno-7-132" href="#__codelineno-7-132"></a>        <span class="c1"># Format n value for shortid</span>
</span><span id="__span-7-133"><a id="__codelineno-7-133" name="__codelineno-7-133" href="#__codelineno-7-133"></a>        <span class="n">n_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-7-134"><a id="__codelineno-7-134" name="__codelineno-7-134" href="#__codelineno-7-134"></a>        <span class="n">shortid</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;B_</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-135"><a id="__codelineno-7-135" name="__codelineno-7-135" href="#__codelineno-7-135"></a>
</span><span id="__span-7-136"><a id="__codelineno-7-136" name="__codelineno-7-136" href="#__codelineno-7-136"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating plan for &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; with n = </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">}</span><span class="s2"> (ShortID: </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-7-137"><a id="__codelineno-7-137" name="__codelineno-7-137" href="#__codelineno-7-137"></a>
</span><span id="__span-7-138"><a id="__codelineno-7-138" name="__codelineno-7-138" href="#__codelineno-7-138"></a>        <span class="c1"># Clone the template plan</span>
</span><span id="__span-7-139"><a id="__codelineno-7-139" name="__codelineno-7-139" href="#__codelineno-7-139"></a>        <span class="n">new_plan_number</span> <span class="o">=</span> <span class="n">RasPlan</span><span class="o">.</span><span class="n">clone_plan</span><span class="p">(</span><span class="n">template_plan</span><span class="p">,</span> <span class="n">new_plan_shortid</span><span class="o">=</span><span class="n">shortid</span><span class="p">)</span>
</span><span id="__span-7-140"><a id="__codelineno-7-140" name="__codelineno-7-140" href="#__codelineno-7-140"></a>
</span><span id="__span-7-141"><a id="__codelineno-7-141" name="__codelineno-7-141" href="#__codelineno-7-141"></a>        <span class="c1"># Clone the template geometry</span>
</span><span id="__span-7-142"><a id="__codelineno-7-142" name="__codelineno-7-142" href="#__codelineno-7-142"></a>        <span class="n">new_geom_number</span> <span class="o">=</span> <span class="n">RasPlan</span><span class="o">.</span><span class="n">clone_geom</span><span class="p">(</span><span class="n">template_geom</span><span class="p">)</span>
</span><span id="__span-7-143"><a id="__codelineno-7-143" name="__codelineno-7-143" href="#__codelineno-7-143"></a>
</span><span id="__span-7-144"><a id="__codelineno-7-144" name="__codelineno-7-144" href="#__codelineno-7-144"></a>        <span class="c1"># Set the new plan to use the new geometry</span>
</span><span id="__span-7-145"><a id="__codelineno-7-145" name="__codelineno-7-145" href="#__codelineno-7-145"></a>        <span class="n">RasPlan</span><span class="o">.</span><span class="n">set_geom</span><span class="p">(</span><span class="n">new_plan_number</span><span class="p">,</span> <span class="n">new_geom_number</span><span class="p">)</span>
</span><span id="__span-7-146"><a id="__codelineno-7-146" name="__codelineno-7-146" href="#__codelineno-7-146"></a>
</span><span id="__span-7-147"><a id="__codelineno-7-147" name="__codelineno-7-147" href="#__codelineno-7-147"></a>        <span class="c1"># Get the new geometry file path</span>
</span><span id="__span-7-148"><a id="__codelineno-7-148" name="__codelineno-7-148" href="#__codelineno-7-148"></a>        <span class="n">new_geom_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_geom_number</span><span class="p">,</span> <span class="s1">&#39;full_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-149"><a id="__codelineno-7-149" name="__codelineno-7-149" href="#__codelineno-7-149"></a>
</span><span id="__span-7-150"><a id="__codelineno-7-150" name="__codelineno-7-150" href="#__codelineno-7-150"></a>        <span class="c1"># Create modified base overrides</span>
</span><span id="__span-7-151"><a id="__codelineno-7-151" name="__codelineno-7-151" href="#__codelineno-7-151"></a>        <span class="n">modified_baseoverrides</span> <span class="o">=</span> <span class="n">original_baseoverrides</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-7-152"><a id="__codelineno-7-152" name="__codelineno-7-152" href="#__codelineno-7-152"></a>
</span><span id="__span-7-153"><a id="__codelineno-7-153" name="__codelineno-7-153" href="#__codelineno-7-153"></a>        <span class="c1"># Update the Manning&#39;s n value for this specific land cover type</span>
</span><span id="__span-7-154"><a id="__codelineno-7-154" name="__codelineno-7-154" href="#__codelineno-7-154"></a>        <span class="n">land_cover_mask</span> <span class="o">=</span> <span class="n">modified_baseoverrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span>
</span><span id="__span-7-155"><a id="__codelineno-7-155" name="__codelineno-7-155" href="#__codelineno-7-155"></a>        <span class="k">if</span> <span class="n">land_cover_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-7-156"><a id="__codelineno-7-156" name="__codelineno-7-156" href="#__codelineno-7-156"></a>            <span class="n">current_n</span> <span class="o">=</span> <span class="n">modified_baseoverrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">land_cover_mask</span><span class="p">,</span> <span class="s2">&quot;Base Mannings n Value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-157"><a id="__codelineno-7-157" name="__codelineno-7-157" href="#__codelineno-7-157"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Changing &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; from </span><span class="si">{</span><span class="n">current_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-158"><a id="__codelineno-7-158" name="__codelineno-7-158" href="#__codelineno-7-158"></a>            <span class="n">modified_baseoverrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">land_cover_mask</span><span class="p">,</span> <span class="s2">&quot;Base Mannings n Value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_n_value</span>
</span><span id="__span-7-159"><a id="__codelineno-7-159" name="__codelineno-7-159" href="#__codelineno-7-159"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-160"><a id="__codelineno-7-160" name="__codelineno-7-160" href="#__codelineno-7-160"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Warning: Land cover &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; not found in base overrides&quot;</span><span class="p">)</span>
</span><span id="__span-7-161"><a id="__codelineno-7-161" name="__codelineno-7-161" href="#__codelineno-7-161"></a>
</span><span id="__span-7-162"><a id="__codelineno-7-162" name="__codelineno-7-162" href="#__codelineno-7-162"></a>        <span class="c1"># Apply the modified base overrides</span>
</span><span id="__span-7-163"><a id="__codelineno-7-163" name="__codelineno-7-163" href="#__codelineno-7-163"></a>        <span class="n">RasGeo</span><span class="o">.</span><span class="n">set_mannings_baseoverrides</span><span class="p">(</span><span class="n">new_geom_path</span><span class="p">,</span> <span class="n">modified_baseoverrides</span><span class="p">)</span>
</span><span id="__span-7-164"><a id="__codelineno-7-164" name="__codelineno-7-164" href="#__codelineno-7-164"></a>
</span><span id="__span-7-165"><a id="__codelineno-7-165" name="__codelineno-7-165" href="#__codelineno-7-165"></a>        <span class="c1"># Copy regional overrides unchanged if they exist</span>
</span><span id="__span-7-166"><a id="__codelineno-7-166" name="__codelineno-7-166" href="#__codelineno-7-166"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">original_regionoverrides</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-167"><a id="__codelineno-7-167" name="__codelineno-7-167" href="#__codelineno-7-167"></a>            <span class="n">RasGeo</span><span class="o">.</span><span class="n">set_mannings_regionoverrides</span><span class="p">(</span><span class="n">new_geom_path</span><span class="p">,</span> <span class="n">original_regionoverrides</span><span class="p">)</span>
</span><span id="__span-7-168"><a id="__codelineno-7-168" name="__codelineno-7-168" href="#__codelineno-7-168"></a>
</span><span id="__span-7-169"><a id="__codelineno-7-169" name="__codelineno-7-169" href="#__codelineno-7-169"></a>        <span class="c1"># Store scenario details</span>
</span><span id="__span-7-170"><a id="__codelineno-7-170" name="__codelineno-7-170" href="#__codelineno-7-170"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-7-171"><a id="__codelineno-7-171" name="__codelineno-7-171" href="#__codelineno-7-171"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-7-172"><a id="__codelineno-7-172" name="__codelineno-7-172" href="#__codelineno-7-172"></a>            <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">new_plan_number</span><span class="p">,</span>
</span><span id="__span-7-173"><a id="__codelineno-7-173" name="__codelineno-7-173" href="#__codelineno-7-173"></a>            <span class="s1">&#39;geom_number&#39;</span><span class="p">:</span> <span class="n">new_geom_number</span><span class="p">,</span>
</span><span id="__span-7-174"><a id="__codelineno-7-174" name="__codelineno-7-174" href="#__codelineno-7-174"></a>            <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="n">shortid</span><span class="p">,</span>
</span><span id="__span-7-175"><a id="__codelineno-7-175" name="__codelineno-7-175" href="#__codelineno-7-175"></a>            <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-7-176"><a id="__codelineno-7-176" name="__codelineno-7-176" href="#__codelineno-7-176"></a>            <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="n">new_n_value</span><span class="p">,</span>
</span><span id="__span-7-177"><a id="__codelineno-7-177" name="__codelineno-7-177" href="#__codelineno-7-177"></a>            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Manning&#39;s n = </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-178"><a id="__codelineno-7-178" name="__codelineno-7-178" href="#__codelineno-7-178"></a>        <span class="p">}</span>
</span><span id="__span-7-179"><a id="__codelineno-7-179" name="__codelineno-7-179" href="#__codelineno-7-179"></a>
</span><span id="__span-7-180"><a id="__codelineno-7-180" name="__codelineno-7-180" href="#__codelineno-7-180"></a>    <span class="c1"># Create plans for each significant land use with varying n values</span>
</span><span id="__span-7-181"><a id="__codelineno-7-181" name="__codelineno-7-181" href="#__codelineno-7-181"></a>    <span class="n">all_plans_to_run</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-7-182"><a id="__codelineno-7-182" name="__codelineno-7-182" href="#__codelineno-7-182"></a>
</span><span id="__span-7-183"><a id="__codelineno-7-183" name="__codelineno-7-183" href="#__codelineno-7-183"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landuse</span> <span class="ow">in</span> <span class="n">significant_landuses</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-7-184"><a id="__codelineno-7-184" name="__codelineno-7-184" href="#__codelineno-7-184"></a>        <span class="n">land_cover</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]</span>
</span><span id="__span-7-185"><a id="__codelineno-7-185" name="__codelineno-7-185" href="#__codelineno-7-185"></a>        <span class="n">current_n</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Current_n&#39;</span><span class="p">]</span>
</span><span id="__span-7-186"><a id="__codelineno-7-186" name="__codelineno-7-186" href="#__codelineno-7-186"></a>
</span><span id="__span-7-187"><a id="__codelineno-7-187" name="__codelineno-7-187" href="#__codelineno-7-187"></a>        <span class="c1"># Find matching land cover in n_ranges</span>
</span><span id="__span-7-188"><a id="__codelineno-7-188" name="__codelineno-7-188" href="#__codelineno-7-188"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">n_ranges</span><span class="p">[</span><span class="n">n_ranges</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span>
</span><span id="__span-7-189"><a id="__codelineno-7-189" name="__codelineno-7-189" href="#__codelineno-7-189"></a>
</span><span id="__span-7-190"><a id="__codelineno-7-190" name="__codelineno-7-190" href="#__codelineno-7-190"></a>        <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-191"><a id="__codelineno-7-191" name="__codelineno-7-191" href="#__codelineno-7-191"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: No Manning&#39;s n range found for &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39;. Skipping.&quot;</span><span class="p">)</span>
</span><span id="__span-7-192"><a id="__codelineno-7-192" name="__codelineno-7-192" href="#__codelineno-7-192"></a>            <span class="k">continue</span>
</span><span id="__span-7-193"><a id="__codelineno-7-193" name="__codelineno-7-193" href="#__codelineno-7-193"></a>
</span><span id="__span-7-194"><a id="__codelineno-7-194" name="__codelineno-7-194" href="#__codelineno-7-194"></a>        <span class="n">min_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-195"><a id="__codelineno-7-195" name="__codelineno-7-195" href="#__codelineno-7-195"></a>        <span class="n">max_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-196"><a id="__codelineno-7-196" name="__codelineno-7-196" href="#__codelineno-7-196"></a>
</span><span id="__span-7-197"><a id="__codelineno-7-197" name="__codelineno-7-197" href="#__codelineno-7-197"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing land cover: </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-198"><a id="__codelineno-7-198" name="__codelineno-7-198" href="#__codelineno-7-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current n: </span><span class="si">{</span><span class="n">current_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-199"><a id="__codelineno-7-199" name="__codelineno-7-199" href="#__codelineno-7-199"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Literature range: </span><span class="si">{</span><span class="n">min_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">max_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-200"><a id="__codelineno-7-200" name="__codelineno-7-200" href="#__codelineno-7-200"></a>
</span><span id="__span-7-201"><a id="__codelineno-7-201" name="__codelineno-7-201" href="#__codelineno-7-201"></a>        <span class="c1"># Generate test values within the range, excluding the current value</span>
</span><span id="__span-7-202"><a id="__codelineno-7-202" name="__codelineno-7-202" href="#__codelineno-7-202"></a>        <span class="n">test_values</span> <span class="o">=</span> <span class="n">generate_sensitivity_values</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">,</span> <span class="n">current_n</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-7-203"><a id="__codelineno-7-203" name="__codelineno-7-203" href="#__codelineno-7-203"></a>
</span><span id="__span-7-204"><a id="__codelineno-7-204" name="__codelineno-7-204" href="#__codelineno-7-204"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Testing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> values: </span><span class="si">{</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">test_values</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-205"><a id="__codelineno-7-205" name="__codelineno-7-205" href="#__codelineno-7-205"></a>
</span><span id="__span-7-206"><a id="__codelineno-7-206" name="__codelineno-7-206" href="#__codelineno-7-206"></a>        <span class="c1"># Create a plan for each test value</span>
</span><span id="__span-7-207"><a id="__codelineno-7-207" name="__codelineno-7-207" href="#__codelineno-7-207"></a>        <span class="k">for</span> <span class="n">n_value</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">:</span>
</span><span id="__span-7-208"><a id="__codelineno-7-208" name="__codelineno-7-208" href="#__codelineno-7-208"></a>            <span class="n">new_scenario</span> <span class="o">=</span> <span class="n">create_modified_plan</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="n">n_value</span><span class="p">)</span>
</span><span id="__span-7-209"><a id="__codelineno-7-209" name="__codelineno-7-209" href="#__codelineno-7-209"></a>            <span class="n">scenarios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scenario</span><span class="p">)</span>
</span><span id="__span-7-210"><a id="__codelineno-7-210" name="__codelineno-7-210" href="#__codelineno-7-210"></a>            <span class="n">all_plans_to_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">])</span>
</span><span id="__span-7-211"><a id="__codelineno-7-211" name="__codelineno-7-211" href="#__codelineno-7-211"></a>
</span><span id="__span-7-212"><a id="__codelineno-7-212" name="__codelineno-7-212" href="#__codelineno-7-212"></a>    <span class="c1"># Save scenario information</span>
</span><span id="__span-7-213"><a id="__codelineno-7-213" name="__codelineno-7-213" href="#__codelineno-7-213"></a>    <span class="n">scenario_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scenarios</span><span class="p">)</span>
</span><span id="__span-7-214"><a id="__codelineno-7-214" name="__codelineno-7-214" href="#__codelineno-7-214"></a>    <span class="n">scenario_info_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="s2">&quot;scenarios.csv&quot;</span>
</span><span id="__span-7-215"><a id="__codelineno-7-215" name="__codelineno-7-215" href="#__codelineno-7-215"></a>    <span class="n">scenario_info</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">scenario_info_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-7-216"><a id="__codelineno-7-216" name="__codelineno-7-216" href="#__codelineno-7-216"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Scenario information saved to: </span><span class="si">{</span><span class="n">scenario_info_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-217"><a id="__codelineno-7-217" name="__codelineno-7-217" href="#__codelineno-7-217"></a>
</span><span id="__span-7-218"><a id="__codelineno-7-218" name="__codelineno-7-218" href="#__codelineno-7-218"></a>    <span class="c1"># Run the plans (excluding the template which is already computed)</span>
</span><span id="__span-7-219"><a id="__codelineno-7-219" name="__codelineno-7-219" href="#__codelineno-7-219"></a>    <span class="n">plans_to_run</span> <span class="o">=</span> <span class="p">[</span><span class="n">plan</span> <span class="k">for</span> <span class="n">plan</span> <span class="ow">in</span> <span class="n">all_plans_to_run</span> <span class="k">if</span> <span class="n">plan</span> <span class="o">!=</span> <span class="n">template_plan</span><span class="p">]</span>
</span><span id="__span-7-220"><a id="__codelineno-7-220" name="__codelineno-7-220" href="#__codelineno-7-220"></a>
</span><span id="__span-7-221"><a id="__codelineno-7-221" name="__codelineno-7-221" href="#__codelineno-7-221"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">plans_to_run</span><span class="p">:</span>
</span><span id="__span-7-222"><a id="__codelineno-7-222" name="__codelineno-7-222" href="#__codelineno-7-222"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No plans to run.&quot;</span><span class="p">)</span>
</span><span id="__span-7-223"><a id="__codelineno-7-223" name="__codelineno-7-223" href="#__codelineno-7-223"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;scenarios&#39;</span><span class="p">:</span> <span class="n">scenarios</span><span class="p">,</span> <span class="s1">&#39;output_folder&#39;</span><span class="p">:</span> <span class="n">results_dir</span><span class="p">}</span>
</span><span id="__span-7-224"><a id="__codelineno-7-224" name="__codelineno-7-224" href="#__codelineno-7-224"></a>
</span><span id="__span-7-225"><a id="__codelineno-7-225" name="__codelineno-7-225" href="#__codelineno-7-225"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Running </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">plans_to_run</span><span class="p">)</span><span class="si">}</span><span class="s2"> plans in parallel...&quot;</span><span class="p">)</span>
</span><span id="__span-7-226"><a id="__codelineno-7-226" name="__codelineno-7-226" href="#__codelineno-7-226"></a>    <span class="n">execution_results</span> <span class="o">=</span> <span class="n">RasCmdr</span><span class="o">.</span><span class="n">compute_parallel</span><span class="p">(</span>
</span><span id="__span-7-227"><a id="__codelineno-7-227" name="__codelineno-7-227" href="#__codelineno-7-227"></a>        <span class="n">plan_number</span><span class="o">=</span><span class="n">plans_to_run</span><span class="p">,</span>
</span><span id="__span-7-228"><a id="__codelineno-7-228" name="__codelineno-7-228" href="#__codelineno-7-228"></a>        <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
</span><span id="__span-7-229"><a id="__codelineno-7-229" name="__codelineno-7-229" href="#__codelineno-7-229"></a>        <span class="n">num_cores</span><span class="o">=</span><span class="n">num_cores</span><span class="p">,</span>
</span><span id="__span-7-230"><a id="__codelineno-7-230" name="__codelineno-7-230" href="#__codelineno-7-230"></a>        <span class="n">clear_geompre</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-7-231"><a id="__codelineno-7-231" name="__codelineno-7-231" href="#__codelineno-7-231"></a>    <span class="p">)</span>
</span><span id="__span-7-232"><a id="__codelineno-7-232" name="__codelineno-7-232" href="#__codelineno-7-232"></a>
</span><span id="__span-7-233"><a id="__codelineno-7-233" name="__codelineno-7-233" href="#__codelineno-7-233"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution results:&quot;</span><span class="p">)</span>
</span><span id="__span-7-234"><a id="__codelineno-7-234" name="__codelineno-7-234" href="#__codelineno-7-234"></a>    <span class="k">for</span> <span class="n">plan</span><span class="p">,</span> <span class="n">success</span> <span class="ow">in</span> <span class="n">execution_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-7-235"><a id="__codelineno-7-235" name="__codelineno-7-235" href="#__codelineno-7-235"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Plan </span><span class="si">{</span><span class="n">plan</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39;Successful&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-236"><a id="__codelineno-7-236" name="__codelineno-7-236" href="#__codelineno-7-236"></a>
</span><span id="__span-7-237"><a id="__codelineno-7-237" name="__codelineno-7-237" href="#__codelineno-7-237"></a>    <span class="c1"># If point of interest provided, extract and compare results</span>
</span><span id="__span-7-238"><a id="__codelineno-7-238" name="__codelineno-7-238" href="#__codelineno-7-238"></a>    <span class="k">if</span> <span class="n">point_of_interest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-239"><a id="__codelineno-7-239" name="__codelineno-7-239" href="#__codelineno-7-239"></a>        <span class="c1"># Get geometry HDF path for cell identification</span>
</span><span id="__span-7-240"><a id="__codelineno-7-240" name="__codelineno-7-240" href="#__codelineno-7-240"></a>        <span class="n">geom_hdf_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_geom</span><span class="p">,</span> <span class="s1">&#39;hdf_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-241"><a id="__codelineno-7-241" name="__codelineno-7-241" href="#__codelineno-7-241"></a>
</span><span id="__span-7-242"><a id="__codelineno-7-242" name="__codelineno-7-242" href="#__codelineno-7-242"></a>        <span class="c1"># Find the nearest mesh cell</span>
</span><span id="__span-7-243"><a id="__codelineno-7-243" name="__codelineno-7-243" href="#__codelineno-7-243"></a>        <span class="n">mesh_cells_gdf</span> <span class="o">=</span> <span class="n">HdfMesh</span><span class="o">.</span><span class="n">get_mesh_cell_points</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">)</span>
</span><span id="__span-7-244"><a id="__codelineno-7-244" name="__codelineno-7-244" href="#__codelineno-7-244"></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">geom</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">))</span>
</span><span id="__span-7-245"><a id="__codelineno-7-245" name="__codelineno-7-245" href="#__codelineno-7-245"></a>        <span class="n">nearest_idx</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
</span><span id="__span-7-246"><a id="__codelineno-7-246" name="__codelineno-7-246" href="#__codelineno-7-246"></a>        <span class="n">mesh_cell_id</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">,</span> <span class="s1">&#39;cell_id&#39;</span><span class="p">]</span>
</span><span id="__span-7-247"><a id="__codelineno-7-247" name="__codelineno-7-247" href="#__codelineno-7-247"></a>        <span class="n">mesh_name</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">,</span> <span class="s1">&#39;mesh_name&#39;</span><span class="p">]</span>
</span><span id="__span-7-248"><a id="__codelineno-7-248" name="__codelineno-7-248" href="#__codelineno-7-248"></a>
</span><span id="__span-7-249"><a id="__codelineno-7-249" name="__codelineno-7-249" href="#__codelineno-7-249"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nearest cell ID: </span><span class="si">{</span><span class="n">mesh_cell_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-250"><a id="__codelineno-7-250" name="__codelineno-7-250" href="#__codelineno-7-250"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distance: </span><span class="si">{</span><span class="n">distances</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> units&quot;</span><span class="p">)</span>
</span><span id="__span-7-251"><a id="__codelineno-7-251" name="__codelineno-7-251" href="#__codelineno-7-251"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mesh area: </span><span class="si">{</span><span class="n">mesh_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-252"><a id="__codelineno-7-252" name="__codelineno-7-252" href="#__codelineno-7-252"></a>
</span><span id="__span-7-253"><a id="__codelineno-7-253" name="__codelineno-7-253" href="#__codelineno-7-253"></a>        <span class="c1"># Extract results for each scenario</span>
</span><span id="__span-7-254"><a id="__codelineno-7-254" name="__codelineno-7-254" href="#__codelineno-7-254"></a>        <span class="n">all_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-7-255"><a id="__codelineno-7-255" name="__codelineno-7-255" href="#__codelineno-7-255"></a>        <span class="n">max_ws_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-7-256"><a id="__codelineno-7-256" name="__codelineno-7-256" href="#__codelineno-7-256"></a>
</span><span id="__span-7-257"><a id="__codelineno-7-257" name="__codelineno-7-257" href="#__codelineno-7-257"></a>        <span class="n">failed_scenarios</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-7-258"><a id="__codelineno-7-258" name="__codelineno-7-258" href="#__codelineno-7-258"></a>
</span><span id="__span-7-259"><a id="__codelineno-7-259" name="__codelineno-7-259" href="#__codelineno-7-259"></a>        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
</span><span id="__span-7-260"><a id="__codelineno-7-260" name="__codelineno-7-260" href="#__codelineno-7-260"></a>            <span class="n">plan_number</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-7-261"><a id="__codelineno-7-261" name="__codelineno-7-261" href="#__codelineno-7-261"></a>            <span class="n">land_cover</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span>
</span><span id="__span-7-262"><a id="__codelineno-7-262" name="__codelineno-7-262" href="#__codelineno-7-262"></a>            <span class="n">n_value</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span>
</span><span id="__span-7-263"><a id="__codelineno-7-263" name="__codelineno-7-263" href="#__codelineno-7-263"></a>            <span class="n">shortid</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span>
</span><span id="__span-7-264"><a id="__codelineno-7-264" name="__codelineno-7-264" href="#__codelineno-7-264"></a>
</span><span id="__span-7-265"><a id="__codelineno-7-265" name="__codelineno-7-265" href="#__codelineno-7-265"></a>            <span class="c1"># Extract results with specific error handling</span>
</span><span id="__span-7-266"><a id="__codelineno-7-266" name="__codelineno-7-266" href="#__codelineno-7-266"></a>            <span class="n">results_xr</span> <span class="o">=</span> <span class="n">HdfResultsMesh</span><span class="o">.</span><span class="n">get_mesh_cells_timeseries</span><span class="p">(</span><span class="n">plan_number</span><span class="p">,</span> <span class="n">ras_object</span><span class="o">=</span><span class="n">ras</span><span class="p">)</span>
</span><span id="__span-7-267"><a id="__codelineno-7-267" name="__codelineno-7-267" href="#__codelineno-7-267"></a>
</span><span id="__span-7-268"><a id="__codelineno-7-268" name="__codelineno-7-268" href="#__codelineno-7-268"></a>            <span class="c1"># Verify mesh exists in results</span>
</span><span id="__span-7-269"><a id="__codelineno-7-269" name="__codelineno-7-269" href="#__codelineno-7-269"></a>            <span class="k">if</span> <span class="n">mesh_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results_xr</span><span class="p">:</span>
</span><span id="__span-7-270"><a id="__codelineno-7-270" name="__codelineno-7-270" href="#__codelineno-7-270"></a>                <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Mesh &#39;</span><span class="si">{</span><span class="n">mesh_name</span><span class="si">}</span><span class="s2">&#39; not found in results for </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-271"><a id="__codelineno-7-271" name="__codelineno-7-271" href="#__codelineno-7-271"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ERROR: </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-272"><a id="__codelineno-7-272" name="__codelineno-7-272" href="#__codelineno-7-272"></a>                <span class="n">failed_scenarios</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="n">shortid</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="n">error_msg</span><span class="p">})</span>
</span><span id="__span-7-273"><a id="__codelineno-7-273" name="__codelineno-7-273" href="#__codelineno-7-273"></a>                <span class="k">continue</span>
</span><span id="__span-7-274"><a id="__codelineno-7-274" name="__codelineno-7-274" href="#__codelineno-7-274"></a>
</span><span id="__span-7-275"><a id="__codelineno-7-275" name="__codelineno-7-275" href="#__codelineno-7-275"></a>            <span class="c1"># Extract water surface data</span>
</span><span id="__span-7-276"><a id="__codelineno-7-276" name="__codelineno-7-276" href="#__codelineno-7-276"></a>            <span class="n">ws_data</span> <span class="o">=</span> <span class="n">results_xr</span><span class="p">[</span><span class="n">mesh_name</span><span class="p">][</span><span class="s1">&#39;Water Surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cell_id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mesh_cell_id</span><span class="p">))</span>
</span><span id="__span-7-277"><a id="__codelineno-7-277" name="__codelineno-7-277" href="#__codelineno-7-277"></a>
</span><span id="__span-7-278"><a id="__codelineno-7-278" name="__codelineno-7-278" href="#__codelineno-7-278"></a>            <span class="c1"># Convert to DataFrame</span>
</span><span id="__span-7-279"><a id="__codelineno-7-279" name="__codelineno-7-279" href="#__codelineno-7-279"></a>            <span class="n">ws_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-7-280"><a id="__codelineno-7-280" name="__codelineno-7-280" href="#__codelineno-7-280"></a>                <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ws_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-7-281"><a id="__codelineno-7-281" name="__codelineno-7-281" href="#__codelineno-7-281"></a>                <span class="s1">&#39;water_surface&#39;</span><span class="p">:</span> <span class="n">ws_data</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-7-282"><a id="__codelineno-7-282" name="__codelineno-7-282" href="#__codelineno-7-282"></a>            <span class="p">})</span>
</span><span id="__span-7-283"><a id="__codelineno-7-283" name="__codelineno-7-283" href="#__codelineno-7-283"></a>
</span><span id="__span-7-284"><a id="__codelineno-7-284" name="__codelineno-7-284" href="#__codelineno-7-284"></a>            <span class="c1"># Store results</span>
</span><span id="__span-7-285"><a id="__codelineno-7-285" name="__codelineno-7-285" href="#__codelineno-7-285"></a>            <span class="n">max_ws</span> <span class="o">=</span> <span class="n">ws_df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-7-286"><a id="__codelineno-7-286" name="__codelineno-7-286" href="#__codelineno-7-286"></a>
</span><span id="__span-7-287"><a id="__codelineno-7-287" name="__codelineno-7-287" href="#__codelineno-7-287"></a>            <span class="n">all_results</span><span class="p">[</span><span class="n">plan_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-7-288"><a id="__codelineno-7-288" name="__codelineno-7-288" href="#__codelineno-7-288"></a>                <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="n">scenario</span><span class="p">,</span>
</span><span id="__span-7-289"><a id="__codelineno-7-289" name="__codelineno-7-289" href="#__codelineno-7-289"></a>                <span class="s1">&#39;df&#39;</span><span class="p">:</span> <span class="n">ws_df</span><span class="p">,</span>
</span><span id="__span-7-290"><a id="__codelineno-7-290" name="__codelineno-7-290" href="#__codelineno-7-290"></a>                <span class="s1">&#39;max_water_surface&#39;</span><span class="p">:</span> <span class="n">max_ws</span>
</span><span id="__span-7-291"><a id="__codelineno-7-291" name="__codelineno-7-291" href="#__codelineno-7-291"></a>            <span class="p">}</span>
</span><span id="__span-7-292"><a id="__codelineno-7-292" name="__codelineno-7-292" href="#__codelineno-7-292"></a>
</span><span id="__span-7-293"><a id="__codelineno-7-293" name="__codelineno-7-293" href="#__codelineno-7-293"></a>            <span class="n">max_ws_values</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-7-294"><a id="__codelineno-7-294" name="__codelineno-7-294" href="#__codelineno-7-294"></a>                <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">plan_number</span><span class="p">,</span>
</span><span id="__span-7-295"><a id="__codelineno-7-295" name="__codelineno-7-295" href="#__codelineno-7-295"></a>                <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="n">shortid</span><span class="p">,</span>
</span><span id="__span-7-296"><a id="__codelineno-7-296" name="__codelineno-7-296" href="#__codelineno-7-296"></a>                <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-7-297"><a id="__codelineno-7-297" name="__codelineno-7-297" href="#__codelineno-7-297"></a>                <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="n">n_value</span><span class="p">,</span>
</span><span id="__span-7-298"><a id="__codelineno-7-298" name="__codelineno-7-298" href="#__codelineno-7-298"></a>                <span class="s1">&#39;max_water_surface&#39;</span><span class="p">:</span> <span class="n">max_ws</span>
</span><span id="__span-7-299"><a id="__codelineno-7-299" name="__codelineno-7-299" href="#__codelineno-7-299"></a>            <span class="p">})</span>
</span><span id="__span-7-300"><a id="__codelineno-7-300" name="__codelineno-7-300" href="#__codelineno-7-300"></a>
</span><span id="__span-7-301"><a id="__codelineno-7-301" name="__codelineno-7-301" href="#__codelineno-7-301"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">: Max WSE = </span><span class="si">{</span><span class="n">max_ws</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-302"><a id="__codelineno-7-302" name="__codelineno-7-302" href="#__codelineno-7-302"></a>
</span><span id="__span-7-303"><a id="__codelineno-7-303" name="__codelineno-7-303" href="#__codelineno-7-303"></a>            <span class="c1"># Save time series to CSV</span>
</span><span id="__span-7-304"><a id="__codelineno-7-304" name="__codelineno-7-304" href="#__codelineno-7-304"></a>            <span class="n">ws_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;timeseries_</span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-7-305"><a id="__codelineno-7-305" name="__codelineno-7-305" href="#__codelineno-7-305"></a>
</span><span id="__span-7-306"><a id="__codelineno-7-306" name="__codelineno-7-306" href="#__codelineno-7-306"></a>        <span class="c1"># Report failed scenarios at end</span>
</span><span id="__span-7-307"><a id="__codelineno-7-307" name="__codelineno-7-307" href="#__codelineno-7-307"></a>        <span class="k">if</span> <span class="n">failed_scenarios</span><span class="p">:</span>
</span><span id="__span-7-308"><a id="__codelineno-7-308" name="__codelineno-7-308" href="#__codelineno-7-308"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> WARNING: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">failed_scenarios</span><span class="p">)</span><span class="si">}</span><span class="s2"> scenarios failed:&quot;</span><span class="p">)</span>
</span><span id="__span-7-309"><a id="__codelineno-7-309" name="__codelineno-7-309" href="#__codelineno-7-309"></a>            <span class="k">for</span> <span class="n">fail</span> <span class="ow">in</span> <span class="n">failed_scenarios</span><span class="p">:</span>
</span><span id="__span-7-310"><a id="__codelineno-7-310" name="__codelineno-7-310" href="#__codelineno-7-310"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">fail</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">fail</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-311"><a id="__codelineno-7-311" name="__codelineno-7-311" href="#__codelineno-7-311"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Review errors above to determine if results are valid.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-312"><a id="__codelineno-7-312" name="__codelineno-7-312" href="#__codelineno-7-312"></a>
</span><span id="__span-7-313"><a id="__codelineno-7-313" name="__codelineno-7-313" href="#__codelineno-7-313"></a>        <span class="c1"># Create summary DataFrame</span>
</span><span id="__span-7-314"><a id="__codelineno-7-314" name="__codelineno-7-314" href="#__codelineno-7-314"></a>        <span class="k">if</span> <span class="n">max_ws_values</span><span class="p">:</span>
</span><span id="__span-7-315"><a id="__codelineno-7-315" name="__codelineno-7-315" href="#__codelineno-7-315"></a>            <span class="n">max_ws_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">max_ws_values</span><span class="p">)</span>
</span><span id="__span-7-316"><a id="__codelineno-7-316" name="__codelineno-7-316" href="#__codelineno-7-316"></a>            <span class="n">max_ws_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">/</span> <span class="s2">&quot;max_water_surface_summary.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-7-317"><a id="__codelineno-7-317" name="__codelineno-7-317" href="#__codelineno-7-317"></a>
</span><span id="__span-7-318"><a id="__codelineno-7-318" name="__codelineno-7-318" href="#__codelineno-7-318"></a>            <span class="c1"># Prepare mapping of land cover -&gt; percentage (from significant_landuses)</span>
</span><span id="__span-7-319"><a id="__codelineno-7-319" name="__codelineno-7-319" href="#__codelineno-7-319"></a>            <span class="n">lc_percentage_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">],</span> <span class="n">significant_landuses</span><span class="p">[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">]))</span>
</span><span id="__span-7-320"><a id="__codelineno-7-320" name="__codelineno-7-320" href="#__codelineno-7-320"></a>
</span><span id="__span-7-321"><a id="__codelineno-7-321" name="__codelineno-7-321" href="#__codelineno-7-321"></a>            <span class="c1"># Create plots by land cover type</span>
</span><span id="__span-7-322"><a id="__codelineno-7-322" name="__codelineno-7-322" href="#__codelineno-7-322"></a>            <span class="k">for</span> <span class="n">land_cover</span> <span class="ow">in</span> <span class="n">significant_landuses</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]:</span>
</span><span id="__span-7-323"><a id="__codelineno-7-323" name="__codelineno-7-323" href="#__codelineno-7-323"></a>                <span class="c1"># Filter scenarios for this land cover</span>
</span><span id="__span-7-324"><a id="__codelineno-7-324" name="__codelineno-7-324" href="#__codelineno-7-324"></a>                <span class="n">land_cover_scenarios</span> <span class="o">=</span> <span class="n">max_ws_df</span><span class="p">[</span><span class="n">max_ws_df</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-7-325"><a id="__codelineno-7-325" name="__codelineno-7-325" href="#__codelineno-7-325"></a>
</span><span id="__span-7-326"><a id="__codelineno-7-326" name="__codelineno-7-326" href="#__codelineno-7-326"></a>                <span class="c1"># Add the template scenario</span>
</span><span id="__span-7-327"><a id="__codelineno-7-327" name="__codelineno-7-327" href="#__codelineno-7-327"></a>                <span class="n">template_row</span> <span class="o">=</span> <span class="n">max_ws_df</span><span class="p">[</span><span class="n">max_ws_df</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Template&#39;</span><span class="p">]</span>
</span><span id="__span-7-328"><a id="__codelineno-7-328" name="__codelineno-7-328" href="#__codelineno-7-328"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-329"><a id="__codelineno-7-329" name="__codelineno-7-329" href="#__codelineno-7-329"></a>                    <span class="n">land_cover_scenarios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">template_row</span><span class="p">,</span> <span class="n">land_cover_scenarios</span><span class="p">])</span>
</span><span id="__span-7-330"><a id="__codelineno-7-330" name="__codelineno-7-330" href="#__codelineno-7-330"></a>
</span><span id="__span-7-331"><a id="__codelineno-7-331" name="__codelineno-7-331" href="#__codelineno-7-331"></a>                <span class="k">if</span> <span class="n">land_cover_scenarios</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-332"><a id="__codelineno-7-332" name="__codelineno-7-332" href="#__codelineno-7-332"></a>                    <span class="k">continue</span>
</span><span id="__span-7-333"><a id="__codelineno-7-333" name="__codelineno-7-333" href="#__codelineno-7-333"></a>
</span><span id="__span-7-334"><a id="__codelineno-7-334" name="__codelineno-7-334" href="#__codelineno-7-334"></a>                <span class="c1"># Sort by n_value</span>
</span><span id="__span-7-335"><a id="__codelineno-7-335" name="__codelineno-7-335" href="#__codelineno-7-335"></a>                <span class="n">land_cover_scenarios</span> <span class="o">=</span> <span class="n">land_cover_scenarios</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;n_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-7-336"><a id="__codelineno-7-336" name="__codelineno-7-336" href="#__codelineno-7-336"></a>
</span><span id="__span-7-337"><a id="__codelineno-7-337" name="__codelineno-7-337" href="#__codelineno-7-337"></a>                <span class="c1"># Add coverage percentage string to label</span>
</span><span id="__span-7-338"><a id="__codelineno-7-338" name="__codelineno-7-338" href="#__codelineno-7-338"></a>                <span class="n">perc</span> <span class="o">=</span> <span class="n">lc_percentage_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-7-339"><a id="__codelineno-7-339" name="__codelineno-7-339" href="#__codelineno-7-339"></a>                <span class="k">if</span> <span class="n">perc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-340"><a id="__codelineno-7-340" name="__codelineno-7-340" href="#__codelineno-7-340"></a>                    <span class="n">perc_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">perc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% coverage)&quot;</span>
</span><span id="__span-7-341"><a id="__codelineno-7-341" name="__codelineno-7-341" href="#__codelineno-7-341"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-342"><a id="__codelineno-7-342" name="__codelineno-7-342" href="#__codelineno-7-342"></a>                    <span class="n">perc_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-7-343"><a id="__codelineno-7-343" name="__codelineno-7-343" href="#__codelineno-7-343"></a>
</span><span id="__span-7-344"><a id="__codelineno-7-344" name="__codelineno-7-344" href="#__codelineno-7-344"></a>                <span class="c1"># Create plot</span>
</span><span id="__span-7-345"><a id="__codelineno-7-345" name="__codelineno-7-345" href="#__codelineno-7-345"></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-7-346"><a id="__codelineno-7-346" name="__codelineno-7-346" href="#__codelineno-7-346"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">land_cover_scenarios</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">],</span> <span class="n">land_cover_scenarios</span><span class="p">[</span><span class="s1">&#39;max_water_surface&#39;</span><span class="p">],</span> 
</span><span id="__span-7-347"><a id="__codelineno-7-347" name="__codelineno-7-347" href="#__codelineno-7-347"></a>                         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-7-348"><a id="__codelineno-7-348" name="__codelineno-7-348" href="#__codelineno-7-348"></a>
</span><span id="__span-7-349"><a id="__codelineno-7-349" name="__codelineno-7-349" href="#__codelineno-7-349"></a>                <span class="c1"># Add template point in a different color if it exists</span>
</span><span id="__span-7-350"><a id="__codelineno-7-350" name="__codelineno-7-350" href="#__codelineno-7-350"></a>                <span class="n">template_idx</span> <span class="o">=</span> <span class="n">land_cover_scenarios</span><span class="p">[</span><span class="n">land_cover_scenarios</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Template&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="__span-7-351"><a id="__codelineno-7-351" name="__codelineno-7-351" href="#__codelineno-7-351"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_idx</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-352"><a id="__codelineno-7-352" name="__codelineno-7-352" href="#__codelineno-7-352"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">land_cover_scenarios</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">template_idx</span><span class="p">,</span> <span class="s1">&#39;n_value&#39;</span><span class="p">],</span> 
</span><span id="__span-7-353"><a id="__codelineno-7-353" name="__codelineno-7-353" href="#__codelineno-7-353"></a>                                <span class="n">land_cover_scenarios</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">template_idx</span><span class="p">,</span> <span class="s1">&#39;max_water_surface&#39;</span><span class="p">],</span>
</span><span id="__span-7-354"><a id="__codelineno-7-354" name="__codelineno-7-354" href="#__codelineno-7-354"></a>                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Template&#39;</span><span class="p">)</span>
</span><span id="__span-7-355"><a id="__codelineno-7-355" name="__codelineno-7-355" href="#__codelineno-7-355"></a>
</span><span id="__span-7-356"><a id="__codelineno-7-356" name="__codelineno-7-356" href="#__codelineno-7-356"></a>                <span class="c1"># Add labels and title, showing percentage of coverage</span>
</span><span id="__span-7-357"><a id="__codelineno-7-357" name="__codelineno-7-357" href="#__codelineno-7-357"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}{</span><span class="n">perc_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-358"><a id="__codelineno-7-358" name="__codelineno-7-358" href="#__codelineno-7-358"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Maximum Water Surface Elevation (ft)&quot;</span><span class="p">)</span>
</span><span id="__span-7-359"><a id="__codelineno-7-359" name="__codelineno-7-359" href="#__codelineno-7-359"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sensitivity to </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}{</span><span class="n">perc_str</span><span class="si">}</span><span class="s2"> Manning&#39;s n Value&quot;</span><span class="p">)</span>
</span><span id="__span-7-360"><a id="__codelineno-7-360" name="__codelineno-7-360" href="#__codelineno-7-360"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-7-361"><a id="__codelineno-7-361" name="__codelineno-7-361" href="#__codelineno-7-361"></a>
</span><span id="__span-7-362"><a id="__codelineno-7-362" name="__codelineno-7-362" href="#__codelineno-7-362"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_idx</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-7-363"><a id="__codelineno-7-363" name="__codelineno-7-363" href="#__codelineno-7-363"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-7-364"><a id="__codelineno-7-364" name="__codelineno-7-364" href="#__codelineno-7-364"></a>
</span><span id="__span-7-365"><a id="__codelineno-7-365" name="__codelineno-7-365" href="#__codelineno-7-365"></a>                <span class="c1"># Save plot</span>
</span><span id="__span-7-366"><a id="__codelineno-7-366" name="__codelineno-7-366" href="#__codelineno-7-366"></a>                <span class="n">plot_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sensitivity_</span><span class="si">{</span><span class="n">land_cover</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span>
</span><span id="__span-7-367"><a id="__codelineno-7-367" name="__codelineno-7-367" href="#__codelineno-7-367"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-7-368"><a id="__codelineno-7-368" name="__codelineno-7-368" href="#__codelineno-7-368"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_path</span><span class="p">)</span>
</span><span id="__span-7-369"><a id="__codelineno-7-369" name="__codelineno-7-369" href="#__codelineno-7-369"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-7-370"><a id="__codelineno-7-370" name="__codelineno-7-370" href="#__codelineno-7-370"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-7-371"><a id="__codelineno-7-371" name="__codelineno-7-371" href="#__codelineno-7-371"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created sensitivity plot for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-372"><a id="__codelineno-7-372" name="__codelineno-7-372" href="#__codelineno-7-372"></a>
</span><span id="__span-7-373"><a id="__codelineno-7-373" name="__codelineno-7-373" href="#__codelineno-7-373"></a>            <span class="c1"># Create time series comparison plot for each land cover</span>
</span><span id="__span-7-374"><a id="__codelineno-7-374" name="__codelineno-7-374" href="#__codelineno-7-374"></a>            <span class="k">for</span> <span class="n">land_cover</span> <span class="ow">in</span> <span class="n">significant_landuses</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]:</span>
</span><span id="__span-7-375"><a id="__codelineno-7-375" name="__codelineno-7-375" href="#__codelineno-7-375"></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-7-376"><a id="__codelineno-7-376" name="__codelineno-7-376" href="#__codelineno-7-376"></a>
</span><span id="__span-7-377"><a id="__codelineno-7-377" name="__codelineno-7-377" href="#__codelineno-7-377"></a>                <span class="c1"># Add coverage percentage string to label</span>
</span><span id="__span-7-378"><a id="__codelineno-7-378" name="__codelineno-7-378" href="#__codelineno-7-378"></a>                <span class="n">perc</span> <span class="o">=</span> <span class="n">lc_percentage_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-7-379"><a id="__codelineno-7-379" name="__codelineno-7-379" href="#__codelineno-7-379"></a>                <span class="k">if</span> <span class="n">perc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-380"><a id="__codelineno-7-380" name="__codelineno-7-380" href="#__codelineno-7-380"></a>                    <span class="n">perc_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">perc</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% coverage)&quot;</span>
</span><span id="__span-7-381"><a id="__codelineno-7-381" name="__codelineno-7-381" href="#__codelineno-7-381"></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-382"><a id="__codelineno-7-382" name="__codelineno-7-382" href="#__codelineno-7-382"></a>                    <span class="n">perc_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="__span-7-383"><a id="__codelineno-7-383" name="__codelineno-7-383" href="#__codelineno-7-383"></a>
</span><span id="__span-7-384"><a id="__codelineno-7-384" name="__codelineno-7-384" href="#__codelineno-7-384"></a>                <span class="c1"># Get template results</span>
</span><span id="__span-7-385"><a id="__codelineno-7-385" name="__codelineno-7-385" href="#__codelineno-7-385"></a>                <span class="n">template_plan</span> <span class="o">=</span> <span class="n">scenarios</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-7-386"><a id="__codelineno-7-386" name="__codelineno-7-386" href="#__codelineno-7-386"></a>                <span class="k">if</span> <span class="n">template_plan</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">:</span>
</span><span id="__span-7-387"><a id="__codelineno-7-387" name="__codelineno-7-387" href="#__codelineno-7-387"></a>                    <span class="n">template_df</span> <span class="o">=</span> <span class="n">all_results</span><span class="p">[</span><span class="n">template_plan</span><span class="p">][</span><span class="s1">&#39;df&#39;</span><span class="p">]</span>
</span><span id="__span-7-388"><a id="__codelineno-7-388" name="__codelineno-7-388" href="#__codelineno-7-388"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">template_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">template_df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">],</span>
</span><span id="__span-7-389"><a id="__codelineno-7-389" name="__codelineno-7-389" href="#__codelineno-7-389"></a>                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Template&#39;</span><span class="p">)</span>
</span><span id="__span-7-390"><a id="__codelineno-7-390" name="__codelineno-7-390" href="#__codelineno-7-390"></a>
</span><span id="__span-7-391"><a id="__codelineno-7-391" name="__codelineno-7-391" href="#__codelineno-7-391"></a>                <span class="c1"># Filter scenarios for this land cover and plot</span>
</span><span id="__span-7-392"><a id="__codelineno-7-392" name="__codelineno-7-392" href="#__codelineno-7-392"></a>                <span class="n">land_cover_scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scenarios</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span>
</span><span id="__span-7-393"><a id="__codelineno-7-393" name="__codelineno-7-393" href="#__codelineno-7-393"></a>
</span><span id="__span-7-394"><a id="__codelineno-7-394" name="__codelineno-7-394" href="#__codelineno-7-394"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">land_cover_scenarios</span><span class="p">:</span>
</span><span id="__span-7-395"><a id="__codelineno-7-395" name="__codelineno-7-395" href="#__codelineno-7-395"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-7-396"><a id="__codelineno-7-396" name="__codelineno-7-396" href="#__codelineno-7-396"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-7-397"><a id="__codelineno-7-397" name="__codelineno-7-397" href="#__codelineno-7-397"></a>                    <span class="k">continue</span>
</span><span id="__span-7-398"><a id="__codelineno-7-398" name="__codelineno-7-398" href="#__codelineno-7-398"></a>
</span><span id="__span-7-399"><a id="__codelineno-7-399" name="__codelineno-7-399" href="#__codelineno-7-399"></a>                <span class="c1"># Setup colormap for n values</span>
</span><span id="__span-7-400"><a id="__codelineno-7-400" name="__codelineno-7-400" href="#__codelineno-7-400"></a>                <span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">land_cover_scenarios</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="__span-7-401"><a id="__codelineno-7-401" name="__codelineno-7-401" href="#__codelineno-7-401"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">n_values</span><span class="p">:</span>
</span><span id="__span-7-402"><a id="__codelineno-7-402" name="__codelineno-7-402" href="#__codelineno-7-402"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-7-403"><a id="__codelineno-7-403" name="__codelineno-7-403" href="#__codelineno-7-403"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-7-404"><a id="__codelineno-7-404" name="__codelineno-7-404" href="#__codelineno-7-404"></a>                    <span class="k">continue</span>
</span><span id="__span-7-405"><a id="__codelineno-7-405" name="__codelineno-7-405" href="#__codelineno-7-405"></a>
</span><span id="__span-7-406"><a id="__codelineno-7-406" name="__codelineno-7-406" href="#__codelineno-7-406"></a>                <span class="n">min_n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_values</span><span class="p">)</span>
</span><span id="__span-7-407"><a id="__codelineno-7-407" name="__codelineno-7-407" href="#__codelineno-7-407"></a>                <span class="n">max_n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_values</span><span class="p">)</span>
</span><span id="__span-7-408"><a id="__codelineno-7-408" name="__codelineno-7-408" href="#__codelineno-7-408"></a>                <span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">)</span>
</span><span id="__span-7-409"><a id="__codelineno-7-409" name="__codelineno-7-409" href="#__codelineno-7-409"></a>                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span>
</span><span id="__span-7-410"><a id="__codelineno-7-410" name="__codelineno-7-410" href="#__codelineno-7-410"></a>
</span><span id="__span-7-411"><a id="__codelineno-7-411" name="__codelineno-7-411" href="#__codelineno-7-411"></a>                <span class="c1"># Plot each scenario with explicit legend entries, showing label with percentage</span>
</span><span id="__span-7-412"><a id="__codelineno-7-412" name="__codelineno-7-412" href="#__codelineno-7-412"></a>                <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">land_cover_scenarios</span><span class="p">:</span>
</span><span id="__span-7-413"><a id="__codelineno-7-413" name="__codelineno-7-413" href="#__codelineno-7-413"></a>                    <span class="n">plan_number</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-7-414"><a id="__codelineno-7-414" name="__codelineno-7-414" href="#__codelineno-7-414"></a>                    <span class="n">n_value</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span>
</span><span id="__span-7-415"><a id="__codelineno-7-415" name="__codelineno-7-415" href="#__codelineno-7-415"></a>                    <span class="k">if</span> <span class="n">plan_number</span> <span class="ow">in</span> <span class="n">all_results</span> <span class="ow">and</span> <span class="n">n_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-416"><a id="__codelineno-7-416" name="__codelineno-7-416" href="#__codelineno-7-416"></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">all_results</span><span class="p">[</span><span class="n">plan_number</span><span class="p">][</span><span class="s1">&#39;df&#39;</span><span class="p">]</span>
</span><span id="__span-7-417"><a id="__codelineno-7-417" name="__codelineno-7-417" href="#__codelineno-7-417"></a>                        <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">n_value</span><span class="p">))</span>
</span><span id="__span-7-418"><a id="__codelineno-7-418" name="__codelineno-7-418" href="#__codelineno-7-418"></a>                        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}{</span><span class="n">perc_str</span><span class="si">}</span><span class="s2">: n = </span><span class="si">{</span><span class="n">n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-7-419"><a id="__codelineno-7-419" name="__codelineno-7-419" href="#__codelineno-7-419"></a>                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> 
</span><span id="__span-7-420"><a id="__codelineno-7-420" name="__codelineno-7-420" href="#__codelineno-7-420"></a>                                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
</span><span id="__span-7-421"><a id="__codelineno-7-421" name="__codelineno-7-421" href="#__codelineno-7-421"></a>
</span><span id="__span-7-422"><a id="__codelineno-7-422" name="__codelineno-7-422" href="#__codelineno-7-422"></a>                <span class="c1"># Add labels and title, showing percentage of coverage</span>
</span><span id="__span-7-423"><a id="__codelineno-7-423" name="__codelineno-7-423" href="#__codelineno-7-423"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="__span-7-424"><a id="__codelineno-7-424" name="__codelineno-7-424" href="#__codelineno-7-424"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water Surface Elevation (ft)&quot;</span><span class="p">)</span>
</span><span id="__span-7-425"><a id="__codelineno-7-425" name="__codelineno-7-425" href="#__codelineno-7-425"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WSE Time Series for Different </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}{</span><span class="n">perc_str</span><span class="si">}</span><span class="s2"> Manning&#39;s n Values&quot;</span><span class="p">)</span>
</span><span id="__span-7-426"><a id="__codelineno-7-426" name="__codelineno-7-426" href="#__codelineno-7-426"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-7-427"><a id="__codelineno-7-427" name="__codelineno-7-427" href="#__codelineno-7-427"></a>
</span><span id="__span-7-428"><a id="__codelineno-7-428" name="__codelineno-7-428" href="#__codelineno-7-428"></a>                <span class="c1"># Add legend with land cover and n values</span>
</span><span id="__span-7-429"><a id="__codelineno-7-429" name="__codelineno-7-429" href="#__codelineno-7-429"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Scenarios&quot;</span><span class="p">)</span>
</span><span id="__span-7-430"><a id="__codelineno-7-430" name="__codelineno-7-430" href="#__codelineno-7-430"></a>
</span><span id="__span-7-431"><a id="__codelineno-7-431" name="__codelineno-7-431" href="#__codelineno-7-431"></a>                <span class="c1"># Add colorbar</span>
</span><span id="__span-7-432"><a id="__codelineno-7-432" name="__codelineno-7-432" href="#__codelineno-7-432"></a>                <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</span><span id="__span-7-433"><a id="__codelineno-7-433" name="__codelineno-7-433" href="#__codelineno-7-433"></a>                <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
</span><span id="__span-7-434"><a id="__codelineno-7-434" name="__codelineno-7-434" href="#__codelineno-7-434"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}{</span><span class="n">perc_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-435"><a id="__codelineno-7-435" name="__codelineno-7-435" href="#__codelineno-7-435"></a>
</span><span id="__span-7-436"><a id="__codelineno-7-436" name="__codelineno-7-436" href="#__codelineno-7-436"></a>                <span class="c1"># Save plot</span>
</span><span id="__span-7-437"><a id="__codelineno-7-437" name="__codelineno-7-437" href="#__codelineno-7-437"></a>                <span class="n">plot_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;timeseries_</span><span class="si">{</span><span class="n">land_cover</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.png&quot;</span>
</span><span id="__span-7-438"><a id="__codelineno-7-438" name="__codelineno-7-438" href="#__codelineno-7-438"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-7-439"><a id="__codelineno-7-439" name="__codelineno-7-439" href="#__codelineno-7-439"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_path</span><span class="p">)</span>
</span><span id="__span-7-440"><a id="__codelineno-7-440" name="__codelineno-7-440" href="#__codelineno-7-440"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-7-441"><a id="__codelineno-7-441" name="__codelineno-7-441" href="#__codelineno-7-441"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-7-442"><a id="__codelineno-7-442" name="__codelineno-7-442" href="#__codelineno-7-442"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created time series plot for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-443"><a id="__codelineno-7-443" name="__codelineno-7-443" href="#__codelineno-7-443"></a>
</span><span id="__span-7-444"><a id="__codelineno-7-444" name="__codelineno-7-444" href="#__codelineno-7-444"></a>    <span class="c1"># Return results</span>
</span><span id="__span-7-445"><a id="__codelineno-7-445" name="__codelineno-7-445" href="#__codelineno-7-445"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-7-446"><a id="__codelineno-7-446" name="__codelineno-7-446" href="#__codelineno-7-446"></a>        <span class="s1">&#39;scenarios&#39;</span><span class="p">:</span> <span class="n">scenarios</span><span class="p">,</span>
</span><span id="__span-7-447"><a id="__codelineno-7-447" name="__codelineno-7-447" href="#__codelineno-7-447"></a>        <span class="s1">&#39;execution_results&#39;</span><span class="p">:</span> <span class="n">execution_results</span> <span class="k">if</span> <span class="s1">&#39;execution_results&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-7-448"><a id="__codelineno-7-448" name="__codelineno-7-448" href="#__codelineno-7-448"></a>        <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">all_results</span> <span class="k">if</span> <span class="s1">&#39;all_results&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-7-449"><a id="__codelineno-7-449" name="__codelineno-7-449" href="#__codelineno-7-449"></a>        <span class="s1">&#39;max_ws_summary&#39;</span><span class="p">:</span> <span class="n">max_ws_df</span> <span class="k">if</span> <span class="s1">&#39;max_ws_df&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-7-450"><a id="__codelineno-7-450" name="__codelineno-7-450" href="#__codelineno-7-450"></a>        <span class="s1">&#39;significant_landuses&#39;</span><span class="p">:</span> <span class="n">significant_landuses</span><span class="p">,</span>
</span><span id="__span-7-451"><a id="__codelineno-7-451" name="__codelineno-7-451" href="#__codelineno-7-451"></a>        <span class="s1">&#39;output_folder&#39;</span><span class="p">:</span> <span class="n">results_dir</span>
</span><span id="__span-7-452"><a id="__codelineno-7-452" name="__codelineno-7-452" href="#__codelineno-7-452"></a>    <span class="p">}</span>
</span></code></pre></div>
<h2 id="executing-base-override-sensitivity-analysis">Executing Base Override Sensitivity Analysis<a class="headerlink" href="#executing-base-override-sensitivity-analysis" title="Permanent link">&para;</a></h2>
<h3 id="configuration-parameters">Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">&para;</a></h3>
<p>The following example demonstrates how to run the base override sensitivity analysis with the BaldEagleCrkMulti2D sample project.</p>
<p><strong>Key Parameters:</strong>
- <code>project_folder</code>: Path to the HEC-RAS project
- <code>template_plan</code>: Base plan number to clone for sensitivity tests
- <code>point_of_interest</code>: Coordinates where results will be extracted (x, y)
- <code>area_threshold</code>: Minimum percentage of mesh coverage for land use to be analyzed (default: 10%)
- <code>interval</code>: Step size for Manning's n test values (default: 0.01)
- <code>max_workers</code>: Number of parallel execution workers
- <code>num_cores</code>: CPU cores per HEC-RAS instance
- <code>output_folder</code>: Directory name for results</p>
<h3 id="execution-steps">Execution Steps<a class="headerlink" href="#execution-steps" title="Permanent link">&para;</a></h3>
<ol>
<li>Extract the example project</li>
<li>Configure analysis parameters</li>
<li>Run the sensitivity analysis (creates plans, executes them, and generates plots)</li>
<li>Review results in the output folder</li>
</ol>
<h3 id="managing-plan-limits-with-separate-project-folders">Managing Plan Limits with Separate Project Folders<a class="headerlink" href="#managing-plan-limits-with-separate-project-folders" title="Permanent link">&para;</a></h3>
<p><strong>Why are we creating copies of the project folder?</strong></p>
<p>HEC-RAS has a hard limit of 99 plans per project (.p01 to .p99). Sensitivity analyses, especially those testing multiple parameters at fine intervals, can easily generate dozens of plans.</p>
<p>To avoid hitting this limit and to keep our analyses organized, we will:
1.  <strong>Extract</strong> the base project once.
2.  <strong>Copy</strong> it to a dedicated folder for <strong>Base Override</strong> sensitivity (suffix <code>_BOMIS</code>).
3.  <strong>Copy</strong> it again to a dedicated folder for <strong>Regional Override</strong> sensitivity (suffix <code>_ROMIS</code>).</p>
<p>This approach ensures that:
*   Each analysis starts with a clean slate.
*   We have a full 99-plan capacity for <em>each</em> type of sensitivity analysis.
*   We don't accidentally overwrite or interfere with plans from the other analysis.
*   The original extracted project remains a pristine backup.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Example usage for Base Overrides Sensitivity Analysis</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="c1"># To run this, uncomment the code, adjust parameters as needed, and execute the cell</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c1"># 1. Extract the example project (the source)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1">#    We extract to the default location first</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="n">source_project_folder</span> <span class="o">=</span> <span class="n">RasExamples</span><span class="o">.</span><span class="n">extract_project</span><span class="p">(</span><span class="n">PROJECT_NAME</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;106&quot;</span><span class="p">)</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c1"># 2. Create a specific folder for Base Override Multi-Interval Sensitivity (BOMIS)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="c1">#    This prevents hitting the 99-plan limit by isolating this analysis</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="n">project_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;example_projects&quot;</span> <span class="o">/</span> <span class="s2">&quot;BaldEagleCrkMulti2D_BOMIS&quot;</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="c1"># Clean up if it already exists to ensure a fresh start</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="k">if</span> <span class="n">project_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">project_folder</span><span class="p">)</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="c1"># Copy the fresh source project to the BOMIS folder</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating dedicated BOMIS project folder...&quot;</span><span class="p">)</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">source_project_folder</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created: </span><span class="si">{</span><span class="n">project_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="c1"># 3. Initialize the BOMIS project</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="c1">#    (This updates the global &#39;ras&#39; object to point to this new folder)</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="c1"># Define parameters</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="n">template_plan</span> <span class="o">=</span> <span class="s2">&quot;01&quot;</span>  <span class="c1"># Use plan 03 as the template</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="n">point_of_interest</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2076402</span><span class="p">,</span> <span class="mi">366670</span><span class="p">)</span>  <span class="c1"># Coordinates where you want to extract results</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>2025-12-16 18:08:07 - ras_commander.RasExamples - INFO - Found zip file: C:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\site-packages\examples\Example_Projects_6_6.zip


2025-12-16 18:08:07 - ras_commander.RasExamples - INFO - Loading project data from CSV...


2025-12-16 18:08:07 - ras_commander.RasExamples - INFO - Loaded 68 projects from CSV.


2025-12-16 18:08:07 - ras_commander.RasExamples - INFO - ----- RasExamples Extracting Project -----


2025-12-16 18:08:07 - ras_commander.RasExamples - INFO - Extracting project &#39;BaldEagleCrkMulti2D&#39; as &#39;BaldEagleCrkMulti2D_106&#39;


2025-12-16 18:08:09 - ras_commander.RasExamples - INFO - Successfully extracted project &#39;BaldEagleCrkMulti2D&#39; to C:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\site-packages\examples\example_projects\BaldEagleCrkMulti2D_106


Creating dedicated BOMIS project folder...


Created: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS


2025-12-16 18:08:10 - ras_commander.RasMap - INFO - Successfully parsed RASMapper file: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.rasmap
</code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Execute the template plan first (required for mesh cell identification and result extraction)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> before sensitivity analysis...&quot;</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">RasCmdr</span><span class="o">.</span><span class="n">compute_plan</span><span class="p">(</span><span class="n">template_plan</span><span class="p">,</span> <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> execution complete.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>2025-12-16 18:08:10 - ras_commander.RasMap - INFO - Successfully parsed RASMapper file: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.rasmap


2025-12-16 18:08:10 - ras_commander.RasCmdr - INFO - Using ras_object with project folder: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS


2025-12-16 18:08:10 - ras_commander.RasUtils - INFO - Using provided plan file path: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.p01


2025-12-16 18:08:10 - ras_commander.RasUtils - INFO - Successfully updated file: C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.p01


2025-12-16 18:08:10 - ras_commander.RasCmdr - INFO - Set number of cores to 2 for plan: 01


2025-12-16 18:08:10 - ras_commander.RasCmdr - INFO - Running HEC-RAS from the Command Line:


2025-12-16 18:08:10 - ras_commander.RasCmdr - INFO - Running command: &quot;C:\Program Files (x86)\HEC\HEC-RAS\6.6\Ras.exe&quot; -c &quot;C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.prj&quot; &quot;C:\GH\ras-commander\examples\example_projects\BaldEagleCrkMulti2D_BOMIS\BaldEagleDamBrk.p01&quot;


Executing template plan 01 before sensitivity analysis...



---------------------------------------------------------------------------

KeyboardInterrupt                         Traceback (most recent call last)

Cell In[8], line 4
      2 print(f&quot;Executing template plan {template_plan} before sensitivity analysis...&quot;)
      3 init_ras_project(project_folder, &quot;6.6&quot;)
----&gt; 4 RasCmdr.compute_plan(template_plan, num_cores=2)
      5 print(f&quot;Template plan {template_plan} execution complete.&quot;)


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\site-packages\ras_commander\Decorators.py:16, in log_call.&lt;locals&gt;.wrapper(*args, **kwargs)
     14 logger = logging.getLogger(func.__module__)
     15 logger.debug(f&quot;Calling {func.__name__}&quot;)
---&gt; 16 result = func(*args, **kwargs)
     17 logger.debug(f&quot;Finished {func.__name__}&quot;)
     18 return result


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\site-packages\ras_commander\RasCmdr.py:364, in RasCmdr.compute_plan(plan_number, dest_folder, ras_object, clear_geompre, num_cores, overwrite_dest, skip_existing, verify, stream_callback)
    360         raise subprocess.CalledProcessError(return_code, cmd)
    362 else:
    363     # Original behavior when no callback
--&gt; 364     subprocess.run(cmd, check=True, shell=True, capture_output=True, text=True)
    366 end_time = time.time()
    367 run_time = end_time - start_time


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\subprocess.py:556, in run(input, capture_output, timeout, check, *popenargs, **kwargs)
    554 with Popen(*popenargs, **kwargs) as process:
    555     try:
--&gt; 556         stdout, stderr = process.communicate(input, timeout=timeout)
    557     except TimeoutExpired as exc:
    558         process.kill()


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\subprocess.py:1222, in Popen.communicate(self, input, timeout)
   1219     endtime = None
   1221 try:
-&gt; 1222     stdout, stderr = self._communicate(input, endtime, timeout)
   1223 except KeyboardInterrupt:
   1224     # https://bugs.python.org/issue25942
   1225     # See the detailed comment in .wait().
   1226     if timeout is not None:


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\subprocess.py:1644, in Popen._communicate(self, input, endtime, orig_timeout)
   1640 # Wait for the reader threads, or time out.  If we time out, the
   1641 # threads remain reading and the fds left open in case the user
   1642 # calls communicate again.
   1643 if self.stdout is not None:
-&gt; 1644     self.stdout_thread.join(self._remaining_time(endtime))
   1645     if self.stdout_thread.is_alive():
   1646         raise TimeoutExpired(self.args, orig_timeout)


File c:\Users\billk_clb\anaconda3\envs\rascmdr_piptest\Lib\threading.py:1094, in Thread.join(self, timeout)
   1091 if timeout is not None:
   1092     timeout = max(timeout, 0)
-&gt; 1094 self._handle.join(timeout)


KeyboardInterrupt:
</code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Run the base sensitivity analysis</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">base_sensitivity_results</span> <span class="o">=</span> <span class="n">individual_landuse_sensitivity_base</span><span class="p">(</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">project_folder</span><span class="o">=</span><span class="n">project_folder</span><span class="p">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">template_plan</span><span class="o">=</span><span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">point_of_interest</span><span class="o">=</span><span class="n">point_of_interest</span><span class="p">,</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="n">area_threshold</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>  <span class="c1"># Only analyze land uses covering at least 10% of the mesh area</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="n">interval</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>       <span class="c1"># Adjust interval to reduce the number of test values</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">,</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;Base_Landuse_Sensitivity&quot;</span><span class="p">,</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="n">n_ranges</span><span class="o">=</span><span class="n">manning_minmax_df</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="p">)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c1"># Print summary information</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="k">if</span> <span class="n">base_sensitivity_results</span><span class="p">:</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analysis complete! Results saved to:&quot;</span><span class="p">,</span> <span class="n">base_sensitivity_results</span><span class="p">[</span><span class="s1">&#39;output_folder&#39;</span><span class="p">])</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>    <span class="k">if</span> <span class="s1">&#39;significant_landuses&#39;</span> <span class="ow">in</span> <span class="n">base_sensitivity_results</span><span class="p">:</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Significant land uses analyzed:&quot;</span><span class="p">)</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">base_sensitivity_results</span><span class="p">[</span><span class="s1">&#39;significant_landuses&#39;</span><span class="p">][[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">]])</span>
</span></code></pre></div>
<hr />
<h2 id="base-override-sensitivity-results">Base Override Sensitivity Results<a class="headerlink" href="#base-override-sensitivity-results" title="Permanent link">&para;</a></h2>
<h3 id="interpreting-the-results">Interpreting the Results<a class="headerlink" href="#interpreting-the-results" title="Permanent link">&para;</a></h3>
<p>The following plots show sensitivity analysis results from the BaldEagleCrkMulti2D example project (Plan 03):</p>
<p><strong>Sensitivity Plots (Right):</strong>
- Show how maximum water surface elevation varies with Manning's n
- X-axis: Manning's n value for the specific land cover type
- Y-axis: Maximum water surface elevation at the point of interest
- Red dot: Current/template Manning's n value
- Steeper slopes indicate higher sensitivity to that parameter</p>
<p><strong>Time Series Plots (Left):</strong>
- Show complete hydrographs for all Manning's n scenarios
- Color gradient represents different Manning's n values
- Black line: Template (original) scenario
- Useful for understanding how timing and peak magnitude respond to parameter changes</p>
<p><strong>Key Observations to Look For:</strong>
- Which land covers cause the largest changes in water surface elevation?
- Are the responses linear or non-linear?
- Does increasing roughness always increase water levels (as expected)?
- Are there threshold effects or inflection points?</p>
<hr />
<h1 id="part-3-regional-override-sensitivity-analysis">Part 3: Regional Override Sensitivity Analysis<a class="headerlink" href="#part-3-regional-override-sensitivity-analysis" title="Permanent link">&para;</a></h1>
<h2 id="overview_2">Overview<a class="headerlink" href="#overview_2" title="Permanent link">&para;</a></h2>
<p>Regional override sensitivity analysis focuses on Manning's n variations within specific calibration regions of the model. This approach is appropriate when:
- Calibrating main channel roughness separately from floodplain
- Analyzing the impact of localized land cover changes
- Testing region-specific parameter uncertainty
- Evaluating different roughness values in distinct hydraulic zones</p>
<p><strong>Key Differences from Base Sensitivity:</strong>
- Tests only land covers present in the specified region(s)
- Can target a single region or analyze all regions
- Useful for main channel calibration or localized sensitivity testing
- Regional overrides take precedence over base mesh values in HEC-RAS</p>
<h2 id="function-individual_landuse_sensitivity_region">Function: individual_landuse_sensitivity_region()<a class="headerlink" href="#function-individual_landuse_sensitivity_region" title="Permanent link">&para;</a></h2>
<p>This function performs the complete regional override sensitivity workflow with region-specific filtering.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">individual_landuse_sensitivity_region</span><span class="p">(</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="n">project_folder</span><span class="p">,</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="n">point_of_interest</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="n">area_threshold</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># percentage threshold for significant land uses</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="n">max_workers</span><span class="o">=</span><span class="n">MAX_WORKERS</span><span class="p">,</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">,</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="n">region_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># optional specific region to analyze</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;Regional_Landuse_Sensitivity&quot;</span><span class="p">,</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="n">n_ranges</span><span class="o">=</span><span class="kc">None</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="p">):</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="sd">    Perform sensitivity analysis by varying individual land use Manning&#39;s n values</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="sd">    in the regional overrides.</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="sd">    Args:</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="sd">        project_folder (str): Path to HEC-RAS project folder</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="sd">        template_plan (str): Plan number to use as template</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="sd">        point_of_interest (tuple or Point): Coordinates for extracting results</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="sd">        area_threshold (float): Percentage threshold for significant land uses</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="sd">        interval (float): Interval for Manning&#39;s n test values</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="sd">        max_workers (int): Number of parallel workers</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="sd">        num_cores (int): Number of cores per worker</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="sd">        region_name (str): Optional specific region to analyze</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="sd">        output_folder (str): Name of output folder</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="sd">        n_ranges (pd.DataFrame): DataFrame containing min/max Manning&#39;s n values.</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="sd">                                    Must contain columns: &#39;Land Cover Name&#39;, &#39;min_n&#39;, &#39;max_n&#39;</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="sd">    Returns:</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="sd">        dict: Results of sensitivity analysis</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>    <span class="c1"># Convert point_of_interest to Point if not already</span>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a>        <span class="n">point_of_interest</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point_of_interest</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a>
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a>    <span class="c1"># Verify n_ranges is provided</span>
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a>    <span class="k">if</span> <span class="n">n_ranges</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;n_ranges DataFrame must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-11-43"><a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a>
</span><span id="__span-11-44"><a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a>    <span class="c1"># Create timestamp for unique run identifier</span>
</span><span id="__span-11-45"><a id="__codelineno-11-45" name="__codelineno-11-45" href="#__codelineno-11-45"></a>    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
</span><span id="__span-11-46"><a id="__codelineno-11-46" name="__codelineno-11-46" href="#__codelineno-11-46"></a>
</span><span id="__span-11-47"><a id="__codelineno-11-47" name="__codelineno-11-47" href="#__codelineno-11-47"></a>    <span class="c1"># Initialize RAS project</span>
</span><span id="__span-11-48"><a id="__codelineno-11-48" name="__codelineno-11-48" href="#__codelineno-11-48"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initializing HEC-RAS project: </span><span class="si">{</span><span class="n">project_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-49"><a id="__codelineno-11-49" name="__codelineno-11-49" href="#__codelineno-11-49"></a>    <span class="n">ras</span> <span class="o">=</span> <span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-11-50"><a id="__codelineno-11-50" name="__codelineno-11-50" href="#__codelineno-11-50"></a>
</span><span id="__span-11-51"><a id="__codelineno-11-51" name="__codelineno-11-51" href="#__codelineno-11-51"></a>    <span class="c1"># Create output directory</span>
</span><span id="__span-11-52"><a id="__codelineno-11-52" name="__codelineno-11-52" href="#__codelineno-11-52"></a>    <span class="n">results_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">project_folder</span><span class="p">)</span> <span class="o">/</span> <span class="n">output_folder</span>
</span><span id="__span-11-53"><a id="__codelineno-11-53" name="__codelineno-11-53" href="#__codelineno-11-53"></a>    <span class="n">results_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-54"><a id="__codelineno-11-54" name="__codelineno-11-54" href="#__codelineno-11-54"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Results will be saved to: </span><span class="si">{</span><span class="n">results_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-55"><a id="__codelineno-11-55" name="__codelineno-11-55" href="#__codelineno-11-55"></a>
</span><span id="__span-11-56"><a id="__codelineno-11-56" name="__codelineno-11-56" href="#__codelineno-11-56"></a>    <span class="c1"># Verify template plan exists</span>
</span><span id="__span-11-57"><a id="__codelineno-11-57" name="__codelineno-11-57" href="#__codelineno-11-57"></a>    <span class="k">if</span> <span class="n">template_plan</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
</span><span id="__span-11-58"><a id="__codelineno-11-58" name="__codelineno-11-58" href="#__codelineno-11-58"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> not found in project&quot;</span><span class="p">)</span>
</span><span id="__span-11-59"><a id="__codelineno-11-59" name="__codelineno-11-59" href="#__codelineno-11-59"></a>
</span><span id="__span-11-60"><a id="__codelineno-11-60" name="__codelineno-11-60" href="#__codelineno-11-60"></a>    <span class="c1"># Get the geometry number for the template plan</span>
</span><span id="__span-11-61"><a id="__codelineno-11-61" name="__codelineno-11-61" href="#__codelineno-11-61"></a>    <span class="n">template_geom</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_plan</span><span class="p">,</span> <span class="s1">&#39;geometry_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-62"><a id="__codelineno-11-62" name="__codelineno-11-62" href="#__codelineno-11-62"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Template plan: </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> (Geometry: </span><span class="si">{</span><span class="n">template_geom</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-63"><a id="__codelineno-11-63" name="__codelineno-11-63" href="#__codelineno-11-63"></a>
</span><span id="__span-11-64"><a id="__codelineno-11-64" name="__codelineno-11-64" href="#__codelineno-11-64"></a>    <span class="c1"># Get the geometry file path</span>
</span><span id="__span-11-65"><a id="__codelineno-11-65" name="__codelineno-11-65" href="#__codelineno-11-65"></a>    <span class="n">geom_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_geom</span><span class="p">,</span> <span class="s1">&#39;full_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-66"><a id="__codelineno-11-66" name="__codelineno-11-66" href="#__codelineno-11-66"></a>
</span><span id="__span-11-67"><a id="__codelineno-11-67" name="__codelineno-11-67" href="#__codelineno-11-67"></a>    <span class="c1"># Get the original Manning&#39;s values</span>
</span><span id="__span-11-68"><a id="__codelineno-11-68" name="__codelineno-11-68" href="#__codelineno-11-68"></a>    <span class="n">original_baseoverrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_baseoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-11-69"><a id="__codelineno-11-69" name="__codelineno-11-69" href="#__codelineno-11-69"></a>    <span class="n">original_regionoverrides</span> <span class="o">=</span> <span class="n">RasGeo</span><span class="o">.</span><span class="n">get_mannings_regionoverrides</span><span class="p">(</span><span class="n">geom_path</span><span class="p">)</span>
</span><span id="__span-11-70"><a id="__codelineno-11-70" name="__codelineno-11-70" href="#__codelineno-11-70"></a>
</span><span id="__span-11-71"><a id="__codelineno-11-71" name="__codelineno-11-71" href="#__codelineno-11-71"></a>    <span class="c1"># Check if regional overrides exist</span>
</span><span id="__span-11-72"><a id="__codelineno-11-72" name="__codelineno-11-72" href="#__codelineno-11-72"></a>    <span class="k">if</span> <span class="n">original_regionoverrides</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-73"><a id="__codelineno-11-73" name="__codelineno-11-73" href="#__codelineno-11-73"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No regional Manning&#39;s overrides found in the model&quot;</span><span class="p">)</span>
</span><span id="__span-11-74"><a id="__codelineno-11-74" name="__codelineno-11-74" href="#__codelineno-11-74"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-75"><a id="__codelineno-11-75" name="__codelineno-11-75" href="#__codelineno-11-75"></a>
</span><span id="__span-11-76"><a id="__codelineno-11-76" name="__codelineno-11-76" href="#__codelineno-11-76"></a>    <span class="c1"># If a specific region name is provided, filter the regional overrides</span>
</span><span id="__span-11-77"><a id="__codelineno-11-77" name="__codelineno-11-77" href="#__codelineno-11-77"></a>    <span class="k">if</span> <span class="n">region_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-78"><a id="__codelineno-11-78" name="__codelineno-11-78" href="#__codelineno-11-78"></a>        <span class="n">region_mask</span> <span class="o">=</span> <span class="n">original_regionoverrides</span><span class="p">[</span><span class="s1">&#39;Region Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region_name</span>
</span><span id="__span-11-79"><a id="__codelineno-11-79" name="__codelineno-11-79" href="#__codelineno-11-79"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">region_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-11-80"><a id="__codelineno-11-80" name="__codelineno-11-80" href="#__codelineno-11-80"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Region &#39;</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&#39; not found in the model&quot;</span><span class="p">)</span>
</span><span id="__span-11-81"><a id="__codelineno-11-81" name="__codelineno-11-81" href="#__codelineno-11-81"></a>            <span class="n">available_regions</span> <span class="o">=</span> <span class="n">original_regionoverrides</span><span class="p">[</span><span class="s1">&#39;Region Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="__span-11-82"><a id="__codelineno-11-82" name="__codelineno-11-82" href="#__codelineno-11-82"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available regions: </span><span class="si">{</span><span class="n">available_regions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-83"><a id="__codelineno-11-83" name="__codelineno-11-83" href="#__codelineno-11-83"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-84"><a id="__codelineno-11-84" name="__codelineno-11-84" href="#__codelineno-11-84"></a>
</span><span id="__span-11-85"><a id="__codelineno-11-85" name="__codelineno-11-85" href="#__codelineno-11-85"></a>        <span class="n">region_overrides</span> <span class="o">=</span> <span class="n">original_regionoverrides</span><span class="p">[</span><span class="n">region_mask</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-86"><a id="__codelineno-11-86" name="__codelineno-11-86" href="#__codelineno-11-86"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analyzing sensitivity for region: </span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-87"><a id="__codelineno-11-87" name="__codelineno-11-87" href="#__codelineno-11-87"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-88"><a id="__codelineno-11-88" name="__codelineno-11-88" href="#__codelineno-11-88"></a>        <span class="n">region_overrides</span> <span class="o">=</span> <span class="n">original_regionoverrides</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-89"><a id="__codelineno-11-89" name="__codelineno-11-89" href="#__codelineno-11-89"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analyzing sensitivity for all regions&quot;</span><span class="p">)</span>
</span><span id="__span-11-90"><a id="__codelineno-11-90" name="__codelineno-11-90" href="#__codelineno-11-90"></a>
</span><span id="__span-11-91"><a id="__codelineno-11-91" name="__codelineno-11-91" href="#__codelineno-11-91"></a>    <span class="c1"># Get unique region tables</span>
</span><span id="__span-11-92"><a id="__codelineno-11-92" name="__codelineno-11-92" href="#__codelineno-11-92"></a>    <span class="n">region_tables</span> <span class="o">=</span> <span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Table Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="__span-11-93"><a id="__codelineno-11-93" name="__codelineno-11-93" href="#__codelineno-11-93"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Region tables: </span><span class="si">{</span><span class="n">region_tables</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-94"><a id="__codelineno-11-94" name="__codelineno-11-94" href="#__codelineno-11-94"></a>
</span><span id="__span-11-95"><a id="__codelineno-11-95" name="__codelineno-11-95" href="#__codelineno-11-95"></a>    <span class="c1"># Analyze land cover statistics for the 2D mesh areas</span>
</span><span id="__span-11-96"><a id="__codelineno-11-96" name="__codelineno-11-96" href="#__codelineno-11-96"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analyzing land cover statistics for the 2D mesh areas...&quot;</span><span class="p">)</span>
</span><span id="__span-11-97"><a id="__codelineno-11-97" name="__codelineno-11-97" href="#__codelineno-11-97"></a>    <span class="n">landcover_stats</span> <span class="o">=</span> <span class="n">analyze_mesh_land_cover_statistics</span><span class="p">(</span>
</span><span id="__span-11-98"><a id="__codelineno-11-98" name="__codelineno-11-98" href="#__codelineno-11-98"></a>        <span class="n">project_folder</span><span class="p">,</span> 
</span><span id="__span-11-99"><a id="__codelineno-11-99" name="__codelineno-11-99" href="#__codelineno-11-99"></a>        <span class="n">geom_number</span><span class="o">=</span><span class="n">template_geom</span>
</span><span id="__span-11-100"><a id="__codelineno-11-100" name="__codelineno-11-100" href="#__codelineno-11-100"></a>    <span class="p">)</span>
</span><span id="__span-11-101"><a id="__codelineno-11-101" name="__codelineno-11-101" href="#__codelineno-11-101"></a>
</span><span id="__span-11-102"><a id="__codelineno-11-102" name="__codelineno-11-102" href="#__codelineno-11-102"></a>    <span class="k">if</span> <span class="n">landcover_stats</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-103"><a id="__codelineno-11-103" name="__codelineno-11-103" href="#__codelineno-11-103"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not analyze land cover statistics&quot;</span><span class="p">)</span>
</span><span id="__span-11-104"><a id="__codelineno-11-104" name="__codelineno-11-104" href="#__codelineno-11-104"></a>
</span><span id="__span-11-105"><a id="__codelineno-11-105" name="__codelineno-11-105" href="#__codelineno-11-105"></a>    <span class="c1"># Identify significant land uses (above threshold)</span>
</span><span id="__span-11-106"><a id="__codelineno-11-106" name="__codelineno-11-106" href="#__codelineno-11-106"></a>    <span class="n">significant_landuses</span> <span class="o">=</span> <span class="n">landcover_stats</span><span class="p">[</span><span class="n">landcover_stats</span><span class="p">[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">area_threshold</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-107"><a id="__codelineno-11-107" name="__codelineno-11-107" href="#__codelineno-11-107"></a>    <span class="n">significant_landuses</span> <span class="o">=</span> <span class="n">significant_landuses</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-108"><a id="__codelineno-11-108" name="__codelineno-11-108" href="#__codelineno-11-108"></a>
</span><span id="__span-11-109"><a id="__codelineno-11-109" name="__codelineno-11-109" href="#__codelineno-11-109"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-11-110"><a id="__codelineno-11-110" name="__codelineno-11-110" href="#__codelineno-11-110"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No land uses found with coverage above </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">% threshold&quot;</span><span class="p">)</span>
</span><span id="__span-11-111"><a id="__codelineno-11-111" name="__codelineno-11-111" href="#__codelineno-11-111"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-112"><a id="__codelineno-11-112" name="__codelineno-11-112" href="#__codelineno-11-112"></a>
</span><span id="__span-11-113"><a id="__codelineno-11-113" name="__codelineno-11-113" href="#__codelineno-11-113"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">)</span><span class="si">}</span><span class="s2"> significant land uses (&gt;= </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">% coverage):&quot;</span><span class="p">)</span>
</span><span id="__span-11-114"><a id="__codelineno-11-114" name="__codelineno-11-114" href="#__codelineno-11-114"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">significant_landuses</span><span class="p">[[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">,</span> <span class="s1">&#39;Current_n&#39;</span><span class="p">]])</span>
</span><span id="__span-11-115"><a id="__codelineno-11-115" name="__codelineno-11-115" href="#__codelineno-11-115"></a>
</span><span id="__span-11-116"><a id="__codelineno-11-116" name="__codelineno-11-116" href="#__codelineno-11-116"></a>    <span class="c1"># Filter significant land uses to only those present in the region overrides</span>
</span><span id="__span-11-117"><a id="__codelineno-11-117" name="__codelineno-11-117" href="#__codelineno-11-117"></a>    <span class="n">region_landcover_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</span><span id="__span-11-118"><a id="__codelineno-11-118" name="__codelineno-11-118" href="#__codelineno-11-118"></a>    <span class="n">filtered_landuses</span> <span class="o">=</span> <span class="n">significant_landuses</span><span class="p">[</span>
</span><span id="__span-11-119"><a id="__codelineno-11-119" name="__codelineno-11-119" href="#__codelineno-11-119"></a>        <span class="n">significant_landuses</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">region_landcover_types</span><span class="p">)</span>
</span><span id="__span-11-120"><a id="__codelineno-11-120" name="__codelineno-11-120" href="#__codelineno-11-120"></a>    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-121"><a id="__codelineno-11-121" name="__codelineno-11-121" href="#__codelineno-11-121"></a>
</span><span id="__span-11-122"><a id="__codelineno-11-122" name="__codelineno-11-122" href="#__codelineno-11-122"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_landuses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-11-123"><a id="__codelineno-11-123" name="__codelineno-11-123" href="#__codelineno-11-123"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;None of the significant land uses are present in the regional overrides&quot;</span><span class="p">)</span>
</span><span id="__span-11-124"><a id="__codelineno-11-124" name="__codelineno-11-124" href="#__codelineno-11-124"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-125"><a id="__codelineno-11-125" name="__codelineno-11-125" href="#__codelineno-11-125"></a>
</span><span id="__span-11-126"><a id="__codelineno-11-126" name="__codelineno-11-126" href="#__codelineno-11-126"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Significant land uses present in regional overrides:&quot;</span><span class="p">)</span>
</span><span id="__span-11-127"><a id="__codelineno-11-127" name="__codelineno-11-127" href="#__codelineno-11-127"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">filtered_landuses</span><span class="p">[[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">]])</span>
</span><span id="__span-11-128"><a id="__codelineno-11-128" name="__codelineno-11-128" href="#__codelineno-11-128"></a>
</span><span id="__span-11-129"><a id="__codelineno-11-129" name="__codelineno-11-129" href="#__codelineno-11-129"></a>    <span class="c1"># Check if we&#39;ll exceed the plan limit</span>
</span><span id="__span-11-130"><a id="__codelineno-11-130" name="__codelineno-11-130" href="#__codelineno-11-130"></a>    <span class="n">current_plan_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ras</span><span class="o">.</span><span class="n">plan_df</span><span class="p">)</span>
</span><span id="__span-11-131"><a id="__codelineno-11-131" name="__codelineno-11-131" href="#__codelineno-11-131"></a>    <span class="n">max_plans</span> <span class="o">=</span> <span class="mi">99</span>  <span class="c1"># HEC-RAS limit</span>
</span><span id="__span-11-132"><a id="__codelineno-11-132" name="__codelineno-11-132" href="#__codelineno-11-132"></a>    <span class="n">remaining_plans</span> <span class="o">=</span> <span class="n">max_plans</span> <span class="o">-</span> <span class="n">current_plan_count</span>
</span><span id="__span-11-133"><a id="__codelineno-11-133" name="__codelineno-11-133" href="#__codelineno-11-133"></a>
</span><span id="__span-11-134"><a id="__codelineno-11-134" name="__codelineno-11-134" href="#__codelineno-11-134"></a>    <span class="c1"># Estimate the number of plans needed</span>
</span><span id="__span-11-135"><a id="__codelineno-11-135" name="__codelineno-11-135" href="#__codelineno-11-135"></a>    <span class="n">estimated_plan_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-11-136"><a id="__codelineno-11-136" name="__codelineno-11-136" href="#__codelineno-11-136"></a>
</span><span id="__span-11-137"><a id="__codelineno-11-137" name="__codelineno-11-137" href="#__codelineno-11-137"></a>    <span class="c1"># Create a table to store land use sensitivity information</span>
</span><span id="__span-11-138"><a id="__codelineno-11-138" name="__codelineno-11-138" href="#__codelineno-11-138"></a>    <span class="n">sensitivity_table</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-11-139"><a id="__codelineno-11-139" name="__codelineno-11-139" href="#__codelineno-11-139"></a>
</span><span id="__span-11-140"><a id="__codelineno-11-140" name="__codelineno-11-140" href="#__codelineno-11-140"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landuse</span> <span class="ow">in</span> <span class="n">filtered_landuses</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-11-141"><a id="__codelineno-11-141" name="__codelineno-11-141" href="#__codelineno-11-141"></a>        <span class="n">land_cover</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]</span>
</span><span id="__span-11-142"><a id="__codelineno-11-142" name="__codelineno-11-142" href="#__codelineno-11-142"></a>
</span><span id="__span-11-143"><a id="__codelineno-11-143" name="__codelineno-11-143" href="#__codelineno-11-143"></a>        <span class="c1"># Find this land cover in the region overrides</span>
</span><span id="__span-11-144"><a id="__codelineno-11-144" name="__codelineno-11-144" href="#__codelineno-11-144"></a>        <span class="k">for</span> <span class="n">region_table</span> <span class="ow">in</span> <span class="n">region_tables</span><span class="p">:</span>
</span><span id="__span-11-145"><a id="__codelineno-11-145" name="__codelineno-11-145" href="#__codelineno-11-145"></a>            <span class="c1"># Create mask for this land cover and table</span>
</span><span id="__span-11-146"><a id="__codelineno-11-146" name="__codelineno-11-146" href="#__codelineno-11-146"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-147"><a id="__codelineno-11-147" name="__codelineno-11-147" href="#__codelineno-11-147"></a>                   <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Table Number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region_table</span><span class="p">)</span>
</span><span id="__span-11-148"><a id="__codelineno-11-148" name="__codelineno-11-148" href="#__codelineno-11-148"></a>
</span><span id="__span-11-149"><a id="__codelineno-11-149" name="__codelineno-11-149" href="#__codelineno-11-149"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-11-150"><a id="__codelineno-11-150" name="__codelineno-11-150" href="#__codelineno-11-150"></a>                <span class="k">continue</span>
</span><span id="__span-11-151"><a id="__codelineno-11-151" name="__codelineno-11-151" href="#__codelineno-11-151"></a>
</span><span id="__span-11-152"><a id="__codelineno-11-152" name="__codelineno-11-152" href="#__codelineno-11-152"></a>            <span class="n">current_n</span> <span class="o">=</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s1">&#39;MainChannel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-153"><a id="__codelineno-11-153" name="__codelineno-11-153" href="#__codelineno-11-153"></a>
</span><span id="__span-11-154"><a id="__codelineno-11-154" name="__codelineno-11-154" href="#__codelineno-11-154"></a>            <span class="c1"># Find matching land cover in n_ranges</span>
</span><span id="__span-11-155"><a id="__codelineno-11-155" name="__codelineno-11-155" href="#__codelineno-11-155"></a>            <span class="n">match</span> <span class="o">=</span> <span class="n">n_ranges</span><span class="p">[</span><span class="n">n_ranges</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span>
</span><span id="__span-11-156"><a id="__codelineno-11-156" name="__codelineno-11-156" href="#__codelineno-11-156"></a>            <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-157"><a id="__codelineno-11-157" name="__codelineno-11-157" href="#__codelineno-11-157"></a>                <span class="k">continue</span>
</span><span id="__span-11-158"><a id="__codelineno-11-158" name="__codelineno-11-158" href="#__codelineno-11-158"></a>
</span><span id="__span-11-159"><a id="__codelineno-11-159" name="__codelineno-11-159" href="#__codelineno-11-159"></a>            <span class="n">min_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-160"><a id="__codelineno-11-160" name="__codelineno-11-160" href="#__codelineno-11-160"></a>            <span class="n">max_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-161"><a id="__codelineno-11-161" name="__codelineno-11-161" href="#__codelineno-11-161"></a>
</span><span id="__span-11-162"><a id="__codelineno-11-162" name="__codelineno-11-162" href="#__codelineno-11-162"></a>            <span class="c1"># Count values between min and max at interval spacing, excluding current value</span>
</span><span id="__span-11-163"><a id="__codelineno-11-163" name="__codelineno-11-163" href="#__codelineno-11-163"></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">generate_sensitivity_values</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">,</span> <span class="n">current_n</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-11-164"><a id="__codelineno-11-164" name="__codelineno-11-164" href="#__codelineno-11-164"></a>            <span class="n">num_values</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="__span-11-165"><a id="__codelineno-11-165" name="__codelineno-11-165" href="#__codelineno-11-165"></a>            <span class="n">estimated_plan_count</span> <span class="o">+=</span> <span class="n">num_values</span>
</span><span id="__span-11-166"><a id="__codelineno-11-166" name="__codelineno-11-166" href="#__codelineno-11-166"></a>
</span><span id="__span-11-167"><a id="__codelineno-11-167" name="__codelineno-11-167" href="#__codelineno-11-167"></a>            <span class="c1"># Add to sensitivity table</span>
</span><span id="__span-11-168"><a id="__codelineno-11-168" name="__codelineno-11-168" href="#__codelineno-11-168"></a>            <span class="n">region_name</span> <span class="o">=</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="s1">&#39;Region Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;Region Name&#39;</span> <span class="ow">in</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">region_table</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-169"><a id="__codelineno-11-169" name="__codelineno-11-169" href="#__codelineno-11-169"></a>            <span class="n">sensitivity_table</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-11-170"><a id="__codelineno-11-170" name="__codelineno-11-170" href="#__codelineno-11-170"></a>                <span class="s1">&#39;Land Cover&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-11-171"><a id="__codelineno-11-171" name="__codelineno-11-171" href="#__codelineno-11-171"></a>                <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">region_name</span><span class="p">,</span>
</span><span id="__span-11-172"><a id="__codelineno-11-172" name="__codelineno-11-172" href="#__codelineno-11-172"></a>                <span class="s1">&#39;Table&#39;</span><span class="p">:</span> <span class="n">region_table</span><span class="p">,</span>
</span><span id="__span-11-173"><a id="__codelineno-11-173" name="__codelineno-11-173" href="#__codelineno-11-173"></a>                <span class="s1">&#39;Current n&#39;</span><span class="p">:</span> <span class="n">current_n</span><span class="p">,</span>
</span><span id="__span-11-174"><a id="__codelineno-11-174" name="__codelineno-11-174" href="#__codelineno-11-174"></a>                <span class="s1">&#39;Min n&#39;</span><span class="p">:</span> <span class="n">min_n</span><span class="p">,</span>
</span><span id="__span-11-175"><a id="__codelineno-11-175" name="__codelineno-11-175" href="#__codelineno-11-175"></a>                <span class="s1">&#39;Max n&#39;</span><span class="p">:</span> <span class="n">max_n</span><span class="p">,</span>
</span><span id="__span-11-176"><a id="__codelineno-11-176" name="__codelineno-11-176" href="#__codelineno-11-176"></a>                <span class="s1">&#39;Test Values&#39;</span><span class="p">:</span> <span class="n">num_values</span><span class="p">,</span>
</span><span id="__span-11-177"><a id="__codelineno-11-177" name="__codelineno-11-177" href="#__codelineno-11-177"></a>                <span class="s1">&#39;n Range&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_n</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">max_n</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-178"><a id="__codelineno-11-178" name="__codelineno-11-178" href="#__codelineno-11-178"></a>            <span class="p">})</span>
</span><span id="__span-11-179"><a id="__codelineno-11-179" name="__codelineno-11-179" href="#__codelineno-11-179"></a>
</span><span id="__span-11-180"><a id="__codelineno-11-180" name="__codelineno-11-180" href="#__codelineno-11-180"></a>    <span class="c1"># Print the sensitivity analysis table</span>
</span><span id="__span-11-181"><a id="__codelineno-11-181" name="__codelineno-11-181" href="#__codelineno-11-181"></a>    <span class="k">if</span> <span class="n">sensitivity_table</span><span class="p">:</span>
</span><span id="__span-11-182"><a id="__codelineno-11-182" name="__codelineno-11-182" href="#__codelineno-11-182"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sensitivity Analysis Plan:&quot;</span><span class="p">)</span>
</span><span id="__span-11-183"><a id="__codelineno-11-183" name="__codelineno-11-183" href="#__codelineno-11-183"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="__span-11-184"><a id="__codelineno-11-184" name="__codelineno-11-184" href="#__codelineno-11-184"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Land Cover&#39;</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Region&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Current n&#39;</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;n Range&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Test Values&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-185"><a id="__codelineno-11-185" name="__codelineno-11-185" href="#__codelineno-11-185"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="__span-11-186"><a id="__codelineno-11-186" name="__codelineno-11-186" href="#__codelineno-11-186"></a>        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sensitivity_table</span><span class="p">:</span>
</span><span id="__span-11-187"><a id="__codelineno-11-187" name="__codelineno-11-187" href="#__codelineno-11-187"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Land Cover&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Current n&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;10.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;n Range&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Test Values&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-188"><a id="__codelineno-11-188" name="__codelineno-11-188" href="#__codelineno-11-188"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="__span-11-189"><a id="__codelineno-11-189" name="__codelineno-11-189" href="#__codelineno-11-189"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total estimated plans to be created: </span><span class="si">{</span><span class="n">estimated_plan_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-190"><a id="__codelineno-11-190" name="__codelineno-11-190" href="#__codelineno-11-190"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
</span><span id="__span-11-191"><a id="__codelineno-11-191" name="__codelineno-11-191" href="#__codelineno-11-191"></a>    <span class="k">if</span> <span class="n">estimated_plan_count</span> <span class="o">&gt;</span> <span class="n">remaining_plans</span><span class="p">:</span>
</span><span id="__span-11-192"><a id="__codelineno-11-192" name="__codelineno-11-192" href="#__codelineno-11-192"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">WARNING: This analysis would create approximately </span><span class="si">{</span><span class="n">estimated_plan_count</span><span class="si">}</span><span class="s2"> plans, but only </span><span class="si">{</span><span class="n">remaining_plans</span><span class="si">}</span><span class="s2"> more plans can be added (limit is 99)&quot;</span><span class="p">)</span>
</span><span id="__span-11-193"><a id="__codelineno-11-193" name="__codelineno-11-193" href="#__codelineno-11-193"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Consider adjusting the following to reduce the number of plans:&quot;</span><span class="p">)</span>
</span><span id="__span-11-194"><a id="__codelineno-11-194" name="__codelineno-11-194" href="#__codelineno-11-194"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;1. Increase the area threshold (currently </span><span class="si">{</span><span class="n">area_threshold</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
</span><span id="__span-11-195"><a id="__codelineno-11-195" name="__codelineno-11-195" href="#__codelineno-11-195"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;2. Increase the interval between test values (currently </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-196"><a id="__codelineno-11-196" name="__codelineno-11-196" href="#__codelineno-11-196"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;3. Reduce the min/max ranges for land uses&quot;</span><span class="p">)</span>
</span><span id="__span-11-197"><a id="__codelineno-11-197" name="__codelineno-11-197" href="#__codelineno-11-197"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;4. Select fewer land uses to test&quot;</span><span class="p">)</span>
</span><span id="__span-11-198"><a id="__codelineno-11-198" name="__codelineno-11-198" href="#__codelineno-11-198"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;5. Specify a single region to test (currently </span><span class="si">{</span><span class="s1">&#39;specific region&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">region_name</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;all regions&#39;</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-199"><a id="__codelineno-11-199" name="__codelineno-11-199" href="#__codelineno-11-199"></a>
</span><span id="__span-11-200"><a id="__codelineno-11-200" name="__codelineno-11-200" href="#__codelineno-11-200"></a>        <span class="c1"># Ask for confirmation to continue</span>
</span><span id="__span-11-201"><a id="__codelineno-11-201" name="__codelineno-11-201" href="#__codelineno-11-201"></a>        <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Do you want to continue anyway? (y/n): &quot;</span><span class="p">)</span>
</span><span id="__span-11-202"><a id="__codelineno-11-202" name="__codelineno-11-202" href="#__codelineno-11-202"></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
</span><span id="__span-11-203"><a id="__codelineno-11-203" name="__codelineno-11-203" href="#__codelineno-11-203"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis canceled&quot;</span><span class="p">)</span>
</span><span id="__span-11-204"><a id="__codelineno-11-204" name="__codelineno-11-204" href="#__codelineno-11-204"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-205"><a id="__codelineno-11-205" name="__codelineno-11-205" href="#__codelineno-11-205"></a>
</span><span id="__span-11-206"><a id="__codelineno-11-206" name="__codelineno-11-206" href="#__codelineno-11-206"></a>    <span class="c1"># Store the current (template) plan as base scenario</span>
</span><span id="__span-11-207"><a id="__codelineno-11-207" name="__codelineno-11-207" href="#__codelineno-11-207"></a>    <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[{</span>
</span><span id="__span-11-208"><a id="__codelineno-11-208" name="__codelineno-11-208" href="#__codelineno-11-208"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span>
</span><span id="__span-11-209"><a id="__codelineno-11-209" name="__codelineno-11-209" href="#__codelineno-11-209"></a>        <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-11-210"><a id="__codelineno-11-210" name="__codelineno-11-210" href="#__codelineno-11-210"></a>        <span class="s1">&#39;geom_number&#39;</span><span class="p">:</span> <span class="n">template_geom</span><span class="p">,</span>
</span><span id="__span-11-211"><a id="__codelineno-11-211" name="__codelineno-11-211" href="#__codelineno-11-211"></a>        <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span>
</span><span id="__span-11-212"><a id="__codelineno-11-212" name="__codelineno-11-212" href="#__codelineno-11-212"></a>        <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-213"><a id="__codelineno-11-213" name="__codelineno-11-213" href="#__codelineno-11-213"></a>        <span class="s1">&#39;region_name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-214"><a id="__codelineno-11-214" name="__codelineno-11-214" href="#__codelineno-11-214"></a>        <span class="s1">&#39;table_number&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-215"><a id="__codelineno-11-215" name="__codelineno-11-215" href="#__codelineno-11-215"></a>        <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-216"><a id="__codelineno-11-216" name="__codelineno-11-216" href="#__codelineno-11-216"></a>        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s2">&quot;Original Manning&#39;s n Values&quot;</span>
</span><span id="__span-11-217"><a id="__codelineno-11-217" name="__codelineno-11-217" href="#__codelineno-11-217"></a>    <span class="p">}]</span>
</span><span id="__span-11-218"><a id="__codelineno-11-218" name="__codelineno-11-218" href="#__codelineno-11-218"></a>
</span><span id="__span-11-219"><a id="__codelineno-11-219" name="__codelineno-11-219" href="#__codelineno-11-219"></a>    <span class="c1"># Function to create a modified plan with adjusted Manning&#39;s n values for a specific land use in a region</span>
</span><span id="__span-11-220"><a id="__codelineno-11-220" name="__codelineno-11-220" href="#__codelineno-11-220"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_modified_plan</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="n">table_number</span><span class="p">,</span> <span class="n">region_name</span><span class="p">,</span> <span class="n">new_n_value</span><span class="p">):</span>
</span><span id="__span-11-221"><a id="__codelineno-11-221" name="__codelineno-11-221" href="#__codelineno-11-221"></a>        <span class="c1"># Create a shortid based on land cover, region, and n value</span>
</span><span id="__span-11-222"><a id="__codelineno-11-222" name="__codelineno-11-222" href="#__codelineno-11-222"></a>        <span class="c1"># Convert land cover name to code (e.g. &quot;Open Water&quot; -&gt; &quot;OW&quot;)</span>
</span><span id="__span-11-223"><a id="__codelineno-11-223" name="__codelineno-11-223" href="#__codelineno-11-223"></a>        <span class="n">lc_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">land_cover</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()])</span>
</span><span id="__span-11-224"><a id="__codelineno-11-224" name="__codelineno-11-224" href="#__codelineno-11-224"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lc_code</span><span class="p">:</span>
</span><span id="__span-11-225"><a id="__codelineno-11-225" name="__codelineno-11-225" href="#__codelineno-11-225"></a>            <span class="n">lc_code</span> <span class="o">=</span> <span class="n">land_cover</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-11-226"><a id="__codelineno-11-226" name="__codelineno-11-226" href="#__codelineno-11-226"></a>        <span class="n">lc_code</span> <span class="o">=</span> <span class="n">lc_code</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="__span-11-227"><a id="__codelineno-11-227" name="__codelineno-11-227" href="#__codelineno-11-227"></a>
</span><span id="__span-11-228"><a id="__codelineno-11-228" name="__codelineno-11-228" href="#__codelineno-11-228"></a>        <span class="c1"># Convert region name to code</span>
</span><span id="__span-11-229"><a id="__codelineno-11-229" name="__codelineno-11-229" href="#__codelineno-11-229"></a>        <span class="n">rg_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">region_name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()])</span>
</span><span id="__span-11-230"><a id="__codelineno-11-230" name="__codelineno-11-230" href="#__codelineno-11-230"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rg_code</span><span class="p">:</span>
</span><span id="__span-11-231"><a id="__codelineno-11-231" name="__codelineno-11-231" href="#__codelineno-11-231"></a>            <span class="n">rg_code</span> <span class="o">=</span> <span class="n">region_name</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-11-232"><a id="__codelineno-11-232" name="__codelineno-11-232" href="#__codelineno-11-232"></a>        <span class="n">rg_code</span> <span class="o">=</span> <span class="n">rg_code</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="__span-11-233"><a id="__codelineno-11-233" name="__codelineno-11-233" href="#__codelineno-11-233"></a>
</span><span id="__span-11-234"><a id="__codelineno-11-234" name="__codelineno-11-234" href="#__codelineno-11-234"></a>        <span class="c1"># Format n value for shortid</span>
</span><span id="__span-11-235"><a id="__codelineno-11-235" name="__codelineno-11-235" href="#__codelineno-11-235"></a>        <span class="n">n_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-11-236"><a id="__codelineno-11-236" name="__codelineno-11-236" href="#__codelineno-11-236"></a>        <span class="n">shortid</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;R_</span><span class="si">{</span><span class="n">lc_code</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">rg_code</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n_str</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-237"><a id="__codelineno-11-237" name="__codelineno-11-237" href="#__codelineno-11-237"></a>
</span><span id="__span-11-238"><a id="__codelineno-11-238" name="__codelineno-11-238" href="#__codelineno-11-238"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating plan for &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&#39; with n = </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">}</span><span class="s2"> (ShortID: </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-239"><a id="__codelineno-11-239" name="__codelineno-11-239" href="#__codelineno-11-239"></a>
</span><span id="__span-11-240"><a id="__codelineno-11-240" name="__codelineno-11-240" href="#__codelineno-11-240"></a>        <span class="c1"># Clone the template plan</span>
</span><span id="__span-11-241"><a id="__codelineno-11-241" name="__codelineno-11-241" href="#__codelineno-11-241"></a>        <span class="n">new_plan_number</span> <span class="o">=</span> <span class="n">RasPlan</span><span class="o">.</span><span class="n">clone_plan</span><span class="p">(</span><span class="n">template_plan</span><span class="p">,</span> <span class="n">new_plan_shortid</span><span class="o">=</span><span class="n">shortid</span><span class="p">)</span>
</span><span id="__span-11-242"><a id="__codelineno-11-242" name="__codelineno-11-242" href="#__codelineno-11-242"></a>
</span><span id="__span-11-243"><a id="__codelineno-11-243" name="__codelineno-11-243" href="#__codelineno-11-243"></a>        <span class="c1"># Clone the template geometry</span>
</span><span id="__span-11-244"><a id="__codelineno-11-244" name="__codelineno-11-244" href="#__codelineno-11-244"></a>        <span class="n">new_geom_number</span> <span class="o">=</span> <span class="n">RasPlan</span><span class="o">.</span><span class="n">clone_geom</span><span class="p">(</span><span class="n">template_geom</span><span class="p">)</span>
</span><span id="__span-11-245"><a id="__codelineno-11-245" name="__codelineno-11-245" href="#__codelineno-11-245"></a>
</span><span id="__span-11-246"><a id="__codelineno-11-246" name="__codelineno-11-246" href="#__codelineno-11-246"></a>        <span class="c1"># Set the new plan to use the new geometry</span>
</span><span id="__span-11-247"><a id="__codelineno-11-247" name="__codelineno-11-247" href="#__codelineno-11-247"></a>        <span class="n">RasPlan</span><span class="o">.</span><span class="n">set_geom</span><span class="p">(</span><span class="n">new_plan_number</span><span class="p">,</span> <span class="n">new_geom_number</span><span class="p">)</span>
</span><span id="__span-11-248"><a id="__codelineno-11-248" name="__codelineno-11-248" href="#__codelineno-11-248"></a>
</span><span id="__span-11-249"><a id="__codelineno-11-249" name="__codelineno-11-249" href="#__codelineno-11-249"></a>        <span class="c1"># Get the new geometry file path</span>
</span><span id="__span-11-250"><a id="__codelineno-11-250" name="__codelineno-11-250" href="#__codelineno-11-250"></a>        <span class="n">new_geom_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_geom_number</span><span class="p">,</span> <span class="s1">&#39;full_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-251"><a id="__codelineno-11-251" name="__codelineno-11-251" href="#__codelineno-11-251"></a>
</span><span id="__span-11-252"><a id="__codelineno-11-252" name="__codelineno-11-252" href="#__codelineno-11-252"></a>        <span class="c1"># Copy base overrides unchanged</span>
</span><span id="__span-11-253"><a id="__codelineno-11-253" name="__codelineno-11-253" href="#__codelineno-11-253"></a>        <span class="n">RasGeo</span><span class="o">.</span><span class="n">set_mannings_baseoverrides</span><span class="p">(</span><span class="n">new_geom_path</span><span class="p">,</span> <span class="n">original_baseoverrides</span><span class="p">)</span>
</span><span id="__span-11-254"><a id="__codelineno-11-254" name="__codelineno-11-254" href="#__codelineno-11-254"></a>
</span><span id="__span-11-255"><a id="__codelineno-11-255" name="__codelineno-11-255" href="#__codelineno-11-255"></a>        <span class="c1"># Create modified region overrides</span>
</span><span id="__span-11-256"><a id="__codelineno-11-256" name="__codelineno-11-256" href="#__codelineno-11-256"></a>        <span class="n">modified_regionoverrides</span> <span class="o">=</span> <span class="n">original_regionoverrides</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-257"><a id="__codelineno-11-257" name="__codelineno-11-257" href="#__codelineno-11-257"></a>
</span><span id="__span-11-258"><a id="__codelineno-11-258" name="__codelineno-11-258" href="#__codelineno-11-258"></a>        <span class="c1"># Update the Manning&#39;s n value for this specific land cover type in this region and table</span>
</span><span id="__span-11-259"><a id="__codelineno-11-259" name="__codelineno-11-259" href="#__codelineno-11-259"></a>        <span class="n">region_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">modified_regionoverrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-260"><a id="__codelineno-11-260" name="__codelineno-11-260" href="#__codelineno-11-260"></a>                     <span class="p">(</span><span class="n">modified_regionoverrides</span><span class="p">[</span><span class="s1">&#39;Table Number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">table_number</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-261"><a id="__codelineno-11-261" name="__codelineno-11-261" href="#__codelineno-11-261"></a>                     <span class="p">(</span><span class="n">modified_regionoverrides</span><span class="p">[</span><span class="s1">&#39;Region Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region_name</span><span class="p">)</span>
</span><span id="__span-11-262"><a id="__codelineno-11-262" name="__codelineno-11-262" href="#__codelineno-11-262"></a>
</span><span id="__span-11-263"><a id="__codelineno-11-263" name="__codelineno-11-263" href="#__codelineno-11-263"></a>        <span class="k">if</span> <span class="n">region_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-11-264"><a id="__codelineno-11-264" name="__codelineno-11-264" href="#__codelineno-11-264"></a>            <span class="n">current_n</span> <span class="o">=</span> <span class="n">modified_regionoverrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">region_mask</span><span class="p">,</span> <span class="s1">&#39;MainChannel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-265"><a id="__codelineno-11-265" name="__codelineno-11-265" href="#__codelineno-11-265"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Changing &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; in &#39;</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&#39; (Table </span><span class="si">{</span><span class="n">table_number</span><span class="si">}</span><span class="s2">) from </span><span class="si">{</span><span class="n">current_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-266"><a id="__codelineno-11-266" name="__codelineno-11-266" href="#__codelineno-11-266"></a>            <span class="n">modified_regionoverrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">region_mask</span><span class="p">,</span> <span class="s1">&#39;MainChannel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_n_value</span>
</span><span id="__span-11-267"><a id="__codelineno-11-267" name="__codelineno-11-267" href="#__codelineno-11-267"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-268"><a id="__codelineno-11-268" name="__codelineno-11-268" href="#__codelineno-11-268"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Warning: Land cover &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39; not found in region &#39;</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&#39; (Table </span><span class="si">{</span><span class="n">table_number</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-269"><a id="__codelineno-11-269" name="__codelineno-11-269" href="#__codelineno-11-269"></a>
</span><span id="__span-11-270"><a id="__codelineno-11-270" name="__codelineno-11-270" href="#__codelineno-11-270"></a>        <span class="c1"># Apply the modified region overrides</span>
</span><span id="__span-11-271"><a id="__codelineno-11-271" name="__codelineno-11-271" href="#__codelineno-11-271"></a>        <span class="n">RasGeo</span><span class="o">.</span><span class="n">set_mannings_regionoverrides</span><span class="p">(</span><span class="n">new_geom_path</span><span class="p">,</span> <span class="n">modified_regionoverrides</span><span class="p">)</span>
</span><span id="__span-11-272"><a id="__codelineno-11-272" name="__codelineno-11-272" href="#__codelineno-11-272"></a>
</span><span id="__span-11-273"><a id="__codelineno-11-273" name="__codelineno-11-273" href="#__codelineno-11-273"></a>        <span class="c1"># Store scenario details</span>
</span><span id="__span-11-274"><a id="__codelineno-11-274" name="__codelineno-11-274" href="#__codelineno-11-274"></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-11-275"><a id="__codelineno-11-275" name="__codelineno-11-275" href="#__codelineno-11-275"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-11-276"><a id="__codelineno-11-276" name="__codelineno-11-276" href="#__codelineno-11-276"></a>            <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">new_plan_number</span><span class="p">,</span>
</span><span id="__span-11-277"><a id="__codelineno-11-277" name="__codelineno-11-277" href="#__codelineno-11-277"></a>            <span class="s1">&#39;geom_number&#39;</span><span class="p">:</span> <span class="n">new_geom_number</span><span class="p">,</span>
</span><span id="__span-11-278"><a id="__codelineno-11-278" name="__codelineno-11-278" href="#__codelineno-11-278"></a>            <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="n">shortid</span><span class="p">,</span>
</span><span id="__span-11-279"><a id="__codelineno-11-279" name="__codelineno-11-279" href="#__codelineno-11-279"></a>            <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-11-280"><a id="__codelineno-11-280" name="__codelineno-11-280" href="#__codelineno-11-280"></a>            <span class="s1">&#39;region_name&#39;</span><span class="p">:</span> <span class="n">region_name</span><span class="p">,</span>
</span><span id="__span-11-281"><a id="__codelineno-11-281" name="__codelineno-11-281" href="#__codelineno-11-281"></a>            <span class="s1">&#39;table_number&#39;</span><span class="p">:</span> <span class="n">table_number</span><span class="p">,</span>
</span><span id="__span-11-282"><a id="__codelineno-11-282" name="__codelineno-11-282" href="#__codelineno-11-282"></a>            <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="n">new_n_value</span><span class="p">,</span>
</span><span id="__span-11-283"><a id="__codelineno-11-283" name="__codelineno-11-283" href="#__codelineno-11-283"></a>            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Manning&#39;s n = </span><span class="si">{</span><span class="n">new_n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-11-284"><a id="__codelineno-11-284" name="__codelineno-11-284" href="#__codelineno-11-284"></a>        <span class="p">}</span>
</span><span id="__span-11-285"><a id="__codelineno-11-285" name="__codelineno-11-285" href="#__codelineno-11-285"></a>
</span><span id="__span-11-286"><a id="__codelineno-11-286" name="__codelineno-11-286" href="#__codelineno-11-286"></a>    <span class="c1"># Create plans for each significant land use with varying n values</span>
</span><span id="__span-11-287"><a id="__codelineno-11-287" name="__codelineno-11-287" href="#__codelineno-11-287"></a>    <span class="n">all_plans_to_run</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-11-288"><a id="__codelineno-11-288" name="__codelineno-11-288" href="#__codelineno-11-288"></a>
</span><span id="__span-11-289"><a id="__codelineno-11-289" name="__codelineno-11-289" href="#__codelineno-11-289"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">landuse</span> <span class="ow">in</span> <span class="n">filtered_landuses</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-11-290"><a id="__codelineno-11-290" name="__codelineno-11-290" href="#__codelineno-11-290"></a>        <span class="n">land_cover</span> <span class="o">=</span> <span class="n">landuse</span><span class="p">[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">]</span>
</span><span id="__span-11-291"><a id="__codelineno-11-291" name="__codelineno-11-291" href="#__codelineno-11-291"></a>
</span><span id="__span-11-292"><a id="__codelineno-11-292" name="__codelineno-11-292" href="#__codelineno-11-292"></a>        <span class="c1"># Find matching land cover in n_ranges</span>
</span><span id="__span-11-293"><a id="__codelineno-11-293" name="__codelineno-11-293" href="#__codelineno-11-293"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">n_ranges</span><span class="p">[</span><span class="n">n_ranges</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">]</span>
</span><span id="__span-11-294"><a id="__codelineno-11-294" name="__codelineno-11-294" href="#__codelineno-11-294"></a>
</span><span id="__span-11-295"><a id="__codelineno-11-295" name="__codelineno-11-295" href="#__codelineno-11-295"></a>        <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-296"><a id="__codelineno-11-296" name="__codelineno-11-296" href="#__codelineno-11-296"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: No Manning&#39;s n range found for &#39;</span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&#39;. Skipping.&quot;</span><span class="p">)</span>
</span><span id="__span-11-297"><a id="__codelineno-11-297" name="__codelineno-11-297" href="#__codelineno-11-297"></a>            <span class="k">continue</span>
</span><span id="__span-11-298"><a id="__codelineno-11-298" name="__codelineno-11-298" href="#__codelineno-11-298"></a>
</span><span id="__span-11-299"><a id="__codelineno-11-299" name="__codelineno-11-299" href="#__codelineno-11-299"></a>        <span class="n">min_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-300"><a id="__codelineno-11-300" name="__codelineno-11-300" href="#__codelineno-11-300"></a>        <span class="n">max_n</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-301"><a id="__codelineno-11-301" name="__codelineno-11-301" href="#__codelineno-11-301"></a>
</span><span id="__span-11-302"><a id="__codelineno-11-302" name="__codelineno-11-302" href="#__codelineno-11-302"></a>        <span class="c1"># Process each region table for this land cover</span>
</span><span id="__span-11-303"><a id="__codelineno-11-303" name="__codelineno-11-303" href="#__codelineno-11-303"></a>        <span class="k">for</span> <span class="n">region_table</span> <span class="ow">in</span> <span class="n">region_tables</span><span class="p">:</span>
</span><span id="__span-11-304"><a id="__codelineno-11-304" name="__codelineno-11-304" href="#__codelineno-11-304"></a>            <span class="c1"># Get all regions with this land cover in this table</span>
</span><span id="__span-11-305"><a id="__codelineno-11-305" name="__codelineno-11-305" href="#__codelineno-11-305"></a>            <span class="n">regions_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-306"><a id="__codelineno-11-306" name="__codelineno-11-306" href="#__codelineno-11-306"></a>                          <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Table Number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region_table</span><span class="p">)</span>
</span><span id="__span-11-307"><a id="__codelineno-11-307" name="__codelineno-11-307" href="#__codelineno-11-307"></a>
</span><span id="__span-11-308"><a id="__codelineno-11-308" name="__codelineno-11-308" href="#__codelineno-11-308"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">regions_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-11-309"><a id="__codelineno-11-309" name="__codelineno-11-309" href="#__codelineno-11-309"></a>                <span class="k">continue</span>
</span><span id="__span-11-310"><a id="__codelineno-11-310" name="__codelineno-11-310" href="#__codelineno-11-310"></a>
</span><span id="__span-11-311"><a id="__codelineno-11-311" name="__codelineno-11-311" href="#__codelineno-11-311"></a>            <span class="c1"># Get unique region names for this land cover and table</span>
</span><span id="__span-11-312"><a id="__codelineno-11-312" name="__codelineno-11-312" href="#__codelineno-11-312"></a>            <span class="n">unique_regions</span> <span class="o">=</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">regions_mask</span><span class="p">,</span> <span class="s1">&#39;Region Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</span><span id="__span-11-313"><a id="__codelineno-11-313" name="__codelineno-11-313" href="#__codelineno-11-313"></a>
</span><span id="__span-11-314"><a id="__codelineno-11-314" name="__codelineno-11-314" href="#__codelineno-11-314"></a>            <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">unique_regions</span><span class="p">:</span>
</span><span id="__span-11-315"><a id="__codelineno-11-315" name="__codelineno-11-315" href="#__codelineno-11-315"></a>                <span class="c1"># If a specific region was requested, skip others</span>
</span><span id="__span-11-316"><a id="__codelineno-11-316" name="__codelineno-11-316" href="#__codelineno-11-316"></a>                <span class="k">if</span> <span class="n">region_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">region</span> <span class="o">!=</span> <span class="n">region_name</span><span class="p">:</span>
</span><span id="__span-11-317"><a id="__codelineno-11-317" name="__codelineno-11-317" href="#__codelineno-11-317"></a>                    <span class="k">continue</span>
</span><span id="__span-11-318"><a id="__codelineno-11-318" name="__codelineno-11-318" href="#__codelineno-11-318"></a>
</span><span id="__span-11-319"><a id="__codelineno-11-319" name="__codelineno-11-319" href="#__codelineno-11-319"></a>                <span class="c1"># Create mask for this specific combination</span>
</span><span id="__span-11-320"><a id="__codelineno-11-320" name="__codelineno-11-320" href="#__codelineno-11-320"></a>                <span class="n">specific_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-321"><a id="__codelineno-11-321" name="__codelineno-11-321" href="#__codelineno-11-321"></a>                               <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Table Number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region_table</span><span class="p">)</span> <span class="o">&amp;</span> \
</span><span id="__span-11-322"><a id="__codelineno-11-322" name="__codelineno-11-322" href="#__codelineno-11-322"></a>                               <span class="p">(</span><span class="n">region_overrides</span><span class="p">[</span><span class="s1">&#39;Region Name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">)</span>
</span><span id="__span-11-323"><a id="__codelineno-11-323" name="__codelineno-11-323" href="#__codelineno-11-323"></a>
</span><span id="__span-11-324"><a id="__codelineno-11-324" name="__codelineno-11-324" href="#__codelineno-11-324"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">specific_mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="__span-11-325"><a id="__codelineno-11-325" name="__codelineno-11-325" href="#__codelineno-11-325"></a>                    <span class="k">continue</span>
</span><span id="__span-11-326"><a id="__codelineno-11-326" name="__codelineno-11-326" href="#__codelineno-11-326"></a>
</span><span id="__span-11-327"><a id="__codelineno-11-327" name="__codelineno-11-327" href="#__codelineno-11-327"></a>                <span class="n">current_n</span> <span class="o">=</span> <span class="n">region_overrides</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">specific_mask</span><span class="p">,</span> <span class="s1">&#39;MainChannel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-328"><a id="__codelineno-11-328" name="__codelineno-11-328" href="#__codelineno-11-328"></a>
</span><span id="__span-11-329"><a id="__codelineno-11-329" name="__codelineno-11-329" href="#__codelineno-11-329"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing land cover: </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in region: </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> (Table </span><span class="si">{</span><span class="n">region_table</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-11-330"><a id="__codelineno-11-330" name="__codelineno-11-330" href="#__codelineno-11-330"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current n: </span><span class="si">{</span><span class="n">current_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-331"><a id="__codelineno-11-331" name="__codelineno-11-331" href="#__codelineno-11-331"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Literature range: </span><span class="si">{</span><span class="n">min_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">max_n</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-332"><a id="__codelineno-11-332" name="__codelineno-11-332" href="#__codelineno-11-332"></a>
</span><span id="__span-11-333"><a id="__codelineno-11-333" name="__codelineno-11-333" href="#__codelineno-11-333"></a>                <span class="c1"># Generate test values within the range, excluding the current value</span>
</span><span id="__span-11-334"><a id="__codelineno-11-334" name="__codelineno-11-334" href="#__codelineno-11-334"></a>                <span class="n">test_values</span> <span class="o">=</span> <span class="n">generate_sensitivity_values</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">,</span> <span class="n">current_n</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="__span-11-335"><a id="__codelineno-11-335" name="__codelineno-11-335" href="#__codelineno-11-335"></a>
</span><span id="__span-11-336"><a id="__codelineno-11-336" name="__codelineno-11-336" href="#__codelineno-11-336"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Testing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> values: </span><span class="si">{</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">test_values</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-337"><a id="__codelineno-11-337" name="__codelineno-11-337" href="#__codelineno-11-337"></a>
</span><span id="__span-11-338"><a id="__codelineno-11-338" name="__codelineno-11-338" href="#__codelineno-11-338"></a>                <span class="c1"># Create a plan for each test value</span>
</span><span id="__span-11-339"><a id="__codelineno-11-339" name="__codelineno-11-339" href="#__codelineno-11-339"></a>                <span class="k">for</span> <span class="n">n_value</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">:</span>
</span><span id="__span-11-340"><a id="__codelineno-11-340" name="__codelineno-11-340" href="#__codelineno-11-340"></a>                    <span class="n">new_scenario</span> <span class="o">=</span> <span class="n">create_modified_plan</span><span class="p">(</span><span class="n">land_cover</span><span class="p">,</span> <span class="n">region_table</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">n_value</span><span class="p">)</span>
</span><span id="__span-11-341"><a id="__codelineno-11-341" name="__codelineno-11-341" href="#__codelineno-11-341"></a>                    <span class="n">scenarios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scenario</span><span class="p">)</span>
</span><span id="__span-11-342"><a id="__codelineno-11-342" name="__codelineno-11-342" href="#__codelineno-11-342"></a>                    <span class="n">all_plans_to_run</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">])</span>
</span><span id="__span-11-343"><a id="__codelineno-11-343" name="__codelineno-11-343" href="#__codelineno-11-343"></a>
</span><span id="__span-11-344"><a id="__codelineno-11-344" name="__codelineno-11-344" href="#__codelineno-11-344"></a>    <span class="c1"># Save scenario information</span>
</span><span id="__span-11-345"><a id="__codelineno-11-345" name="__codelineno-11-345" href="#__codelineno-11-345"></a>    <span class="n">scenario_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scenarios</span><span class="p">)</span>
</span><span id="__span-11-346"><a id="__codelineno-11-346" name="__codelineno-11-346" href="#__codelineno-11-346"></a>    <span class="n">scenario_info_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="s2">&quot;scenarios.csv&quot;</span>
</span><span id="__span-11-347"><a id="__codelineno-11-347" name="__codelineno-11-347" href="#__codelineno-11-347"></a>    <span class="n">scenario_info</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">scenario_info_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-11-348"><a id="__codelineno-11-348" name="__codelineno-11-348" href="#__codelineno-11-348"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Scenario information saved to: </span><span class="si">{</span><span class="n">scenario_info_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-349"><a id="__codelineno-11-349" name="__codelineno-11-349" href="#__codelineno-11-349"></a>
</span><span id="__span-11-350"><a id="__codelineno-11-350" name="__codelineno-11-350" href="#__codelineno-11-350"></a>    <span class="c1"># Run the plans (excluding the template which is already computed)</span>
</span><span id="__span-11-351"><a id="__codelineno-11-351" name="__codelineno-11-351" href="#__codelineno-11-351"></a>    <span class="n">plans_to_run</span> <span class="o">=</span> <span class="p">[</span><span class="n">plan</span> <span class="k">for</span> <span class="n">plan</span> <span class="ow">in</span> <span class="n">all_plans_to_run</span> <span class="k">if</span> <span class="n">plan</span> <span class="o">!=</span> <span class="n">template_plan</span><span class="p">]</span>
</span><span id="__span-11-352"><a id="__codelineno-11-352" name="__codelineno-11-352" href="#__codelineno-11-352"></a>
</span><span id="__span-11-353"><a id="__codelineno-11-353" name="__codelineno-11-353" href="#__codelineno-11-353"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">plans_to_run</span><span class="p">:</span>
</span><span id="__span-11-354"><a id="__codelineno-11-354" name="__codelineno-11-354" href="#__codelineno-11-354"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No plans to run.&quot;</span><span class="p">)</span>
</span><span id="__span-11-355"><a id="__codelineno-11-355" name="__codelineno-11-355" href="#__codelineno-11-355"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;scenarios&#39;</span><span class="p">:</span> <span class="n">scenarios</span><span class="p">,</span> <span class="s1">&#39;output_folder&#39;</span><span class="p">:</span> <span class="n">results_dir</span><span class="p">}</span>
</span><span id="__span-11-356"><a id="__codelineno-11-356" name="__codelineno-11-356" href="#__codelineno-11-356"></a>
</span><span id="__span-11-357"><a id="__codelineno-11-357" name="__codelineno-11-357" href="#__codelineno-11-357"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Running </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">plans_to_run</span><span class="p">)</span><span class="si">}</span><span class="s2"> plans in parallel...&quot;</span><span class="p">)</span>
</span><span id="__span-11-358"><a id="__codelineno-11-358" name="__codelineno-11-358" href="#__codelineno-11-358"></a>    <span class="n">execution_results</span> <span class="o">=</span> <span class="n">RasCmdr</span><span class="o">.</span><span class="n">compute_parallel</span><span class="p">(</span>
</span><span id="__span-11-359"><a id="__codelineno-11-359" name="__codelineno-11-359" href="#__codelineno-11-359"></a>        <span class="n">plan_number</span><span class="o">=</span><span class="n">plans_to_run</span><span class="p">,</span>
</span><span id="__span-11-360"><a id="__codelineno-11-360" name="__codelineno-11-360" href="#__codelineno-11-360"></a>        <span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">,</span>
</span><span id="__span-11-361"><a id="__codelineno-11-361" name="__codelineno-11-361" href="#__codelineno-11-361"></a>        <span class="n">num_cores</span><span class="o">=</span><span class="n">num_cores</span><span class="p">,</span>
</span><span id="__span-11-362"><a id="__codelineno-11-362" name="__codelineno-11-362" href="#__codelineno-11-362"></a>        <span class="n">clear_geompre</span><span class="o">=</span><span class="kc">True</span>
</span><span id="__span-11-363"><a id="__codelineno-11-363" name="__codelineno-11-363" href="#__codelineno-11-363"></a>    <span class="p">)</span>
</span><span id="__span-11-364"><a id="__codelineno-11-364" name="__codelineno-11-364" href="#__codelineno-11-364"></a>
</span><span id="__span-11-365"><a id="__codelineno-11-365" name="__codelineno-11-365" href="#__codelineno-11-365"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Execution results:&quot;</span><span class="p">)</span>
</span><span id="__span-11-366"><a id="__codelineno-11-366" name="__codelineno-11-366" href="#__codelineno-11-366"></a>    <span class="k">for</span> <span class="n">plan</span><span class="p">,</span> <span class="n">success</span> <span class="ow">in</span> <span class="n">execution_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-11-367"><a id="__codelineno-11-367" name="__codelineno-11-367" href="#__codelineno-11-367"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Plan </span><span class="si">{</span><span class="n">plan</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39;Successful&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-368"><a id="__codelineno-11-368" name="__codelineno-11-368" href="#__codelineno-11-368"></a>
</span><span id="__span-11-369"><a id="__codelineno-11-369" name="__codelineno-11-369" href="#__codelineno-11-369"></a>    <span class="c1"># If point of interest provided, extract and compare results</span>
</span><span id="__span-11-370"><a id="__codelineno-11-370" name="__codelineno-11-370" href="#__codelineno-11-370"></a>    <span class="k">if</span> <span class="n">point_of_interest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-371"><a id="__codelineno-11-371" name="__codelineno-11-371" href="#__codelineno-11-371"></a>        <span class="c1"># Get geometry HDF path for cell identification</span>
</span><span id="__span-11-372"><a id="__codelineno-11-372" name="__codelineno-11-372" href="#__codelineno-11-372"></a>        <span class="n">geom_hdf_path</span> <span class="o">=</span> <span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ras</span><span class="o">.</span><span class="n">geom_df</span><span class="p">[</span><span class="s1">&#39;geom_number&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">template_geom</span><span class="p">,</span> <span class="s1">&#39;hdf_path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-11-373"><a id="__codelineno-11-373" name="__codelineno-11-373" href="#__codelineno-11-373"></a>
</span><span id="__span-11-374"><a id="__codelineno-11-374" name="__codelineno-11-374" href="#__codelineno-11-374"></a>        <span class="c1"># Find the nearest mesh cell</span>
</span><span id="__span-11-375"><a id="__codelineno-11-375" name="__codelineno-11-375" href="#__codelineno-11-375"></a>        <span class="n">mesh_cells_gdf</span> <span class="o">=</span> <span class="n">HdfMesh</span><span class="o">.</span><span class="n">get_mesh_cell_points</span><span class="p">(</span><span class="n">geom_hdf_path</span><span class="p">)</span>
</span><span id="__span-11-376"><a id="__codelineno-11-376" name="__codelineno-11-376" href="#__codelineno-11-376"></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">geom</span><span class="p">:</span> <span class="n">geom</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">point_of_interest</span><span class="p">))</span>
</span><span id="__span-11-377"><a id="__codelineno-11-377" name="__codelineno-11-377" href="#__codelineno-11-377"></a>        <span class="n">nearest_idx</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
</span><span id="__span-11-378"><a id="__codelineno-11-378" name="__codelineno-11-378" href="#__codelineno-11-378"></a>        <span class="n">mesh_cell_id</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">,</span> <span class="s1">&#39;cell_id&#39;</span><span class="p">]</span>
</span><span id="__span-11-379"><a id="__codelineno-11-379" name="__codelineno-11-379" href="#__codelineno-11-379"></a>        <span class="n">mesh_name</span> <span class="o">=</span> <span class="n">mesh_cells_gdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">,</span> <span class="s1">&#39;mesh_name&#39;</span><span class="p">]</span>
</span><span id="__span-11-380"><a id="__codelineno-11-380" name="__codelineno-11-380" href="#__codelineno-11-380"></a>
</span><span id="__span-11-381"><a id="__codelineno-11-381" name="__codelineno-11-381" href="#__codelineno-11-381"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Nearest cell ID: </span><span class="si">{</span><span class="n">mesh_cell_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-382"><a id="__codelineno-11-382" name="__codelineno-11-382" href="#__codelineno-11-382"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distance: </span><span class="si">{</span><span class="n">distances</span><span class="p">[</span><span class="n">nearest_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> units&quot;</span><span class="p">)</span>
</span><span id="__span-11-383"><a id="__codelineno-11-383" name="__codelineno-11-383" href="#__codelineno-11-383"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mesh area: </span><span class="si">{</span><span class="n">mesh_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-384"><a id="__codelineno-11-384" name="__codelineno-11-384" href="#__codelineno-11-384"></a>
</span><span id="__span-11-385"><a id="__codelineno-11-385" name="__codelineno-11-385" href="#__codelineno-11-385"></a>        <span class="c1"># Extract results for each scenario</span>
</span><span id="__span-11-386"><a id="__codelineno-11-386" name="__codelineno-11-386" href="#__codelineno-11-386"></a>        <span class="n">all_results</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-11-387"><a id="__codelineno-11-387" name="__codelineno-11-387" href="#__codelineno-11-387"></a>        <span class="n">max_ws_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-11-388"><a id="__codelineno-11-388" name="__codelineno-11-388" href="#__codelineno-11-388"></a>
</span><span id="__span-11-389"><a id="__codelineno-11-389" name="__codelineno-11-389" href="#__codelineno-11-389"></a>        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
</span><span id="__span-11-390"><a id="__codelineno-11-390" name="__codelineno-11-390" href="#__codelineno-11-390"></a>            <span class="n">plan_number</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-11-391"><a id="__codelineno-11-391" name="__codelineno-11-391" href="#__codelineno-11-391"></a>            <span class="n">land_cover</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span>
</span><span id="__span-11-392"><a id="__codelineno-11-392" name="__codelineno-11-392" href="#__codelineno-11-392"></a>            <span class="n">region_name</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">]</span>
</span><span id="__span-11-393"><a id="__codelineno-11-393" name="__codelineno-11-393" href="#__codelineno-11-393"></a>            <span class="n">n_value</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span>
</span><span id="__span-11-394"><a id="__codelineno-11-394" name="__codelineno-11-394" href="#__codelineno-11-394"></a>            <span class="n">shortid</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span>
</span><span id="__span-11-395"><a id="__codelineno-11-395" name="__codelineno-11-395" href="#__codelineno-11-395"></a>
</span><span id="__span-11-396"><a id="__codelineno-11-396" name="__codelineno-11-396" href="#__codelineno-11-396"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-11-397"><a id="__codelineno-11-397" name="__codelineno-11-397" href="#__codelineno-11-397"></a>                <span class="n">results_xr</span> <span class="o">=</span> <span class="n">HdfResultsMesh</span><span class="o">.</span><span class="n">get_mesh_cells_timeseries</span><span class="p">(</span><span class="n">plan_number</span><span class="p">,</span> <span class="n">ras_object</span><span class="o">=</span><span class="n">ras</span><span class="p">)</span>
</span><span id="__span-11-398"><a id="__codelineno-11-398" name="__codelineno-11-398" href="#__codelineno-11-398"></a>
</span><span id="__span-11-399"><a id="__codelineno-11-399" name="__codelineno-11-399" href="#__codelineno-11-399"></a>                <span class="c1"># Extract water surface data</span>
</span><span id="__span-11-400"><a id="__codelineno-11-400" name="__codelineno-11-400" href="#__codelineno-11-400"></a>                <span class="n">ws_data</span> <span class="o">=</span> <span class="n">results_xr</span><span class="p">[</span><span class="n">mesh_name</span><span class="p">][</span><span class="s1">&#39;Water Surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cell_id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mesh_cell_id</span><span class="p">))</span>
</span><span id="__span-11-401"><a id="__codelineno-11-401" name="__codelineno-11-401" href="#__codelineno-11-401"></a>
</span><span id="__span-11-402"><a id="__codelineno-11-402" name="__codelineno-11-402" href="#__codelineno-11-402"></a>                <span class="c1"># Convert to DataFrame</span>
</span><span id="__span-11-403"><a id="__codelineno-11-403" name="__codelineno-11-403" href="#__codelineno-11-403"></a>                <span class="n">ws_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="__span-11-404"><a id="__codelineno-11-404" name="__codelineno-11-404" href="#__codelineno-11-404"></a>                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ws_data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-11-405"><a id="__codelineno-11-405" name="__codelineno-11-405" href="#__codelineno-11-405"></a>                    <span class="s1">&#39;water_surface&#39;</span><span class="p">:</span> <span class="n">ws_data</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-11-406"><a id="__codelineno-11-406" name="__codelineno-11-406" href="#__codelineno-11-406"></a>                <span class="p">})</span>
</span><span id="__span-11-407"><a id="__codelineno-11-407" name="__codelineno-11-407" href="#__codelineno-11-407"></a>
</span><span id="__span-11-408"><a id="__codelineno-11-408" name="__codelineno-11-408" href="#__codelineno-11-408"></a>                <span class="c1"># Store results</span>
</span><span id="__span-11-409"><a id="__codelineno-11-409" name="__codelineno-11-409" href="#__codelineno-11-409"></a>                <span class="n">max_ws</span> <span class="o">=</span> <span class="n">ws_df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</span><span id="__span-11-410"><a id="__codelineno-11-410" name="__codelineno-11-410" href="#__codelineno-11-410"></a>
</span><span id="__span-11-411"><a id="__codelineno-11-411" name="__codelineno-11-411" href="#__codelineno-11-411"></a>                <span class="n">all_results</span><span class="p">[</span><span class="n">plan_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-11-412"><a id="__codelineno-11-412" name="__codelineno-11-412" href="#__codelineno-11-412"></a>                    <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="n">scenario</span><span class="p">,</span>
</span><span id="__span-11-413"><a id="__codelineno-11-413" name="__codelineno-11-413" href="#__codelineno-11-413"></a>                    <span class="s1">&#39;df&#39;</span><span class="p">:</span> <span class="n">ws_df</span><span class="p">,</span>
</span><span id="__span-11-414"><a id="__codelineno-11-414" name="__codelineno-11-414" href="#__codelineno-11-414"></a>                    <span class="s1">&#39;max_water_surface&#39;</span><span class="p">:</span> <span class="n">max_ws</span>
</span><span id="__span-11-415"><a id="__codelineno-11-415" name="__codelineno-11-415" href="#__codelineno-11-415"></a>                <span class="p">}</span>
</span><span id="__span-11-416"><a id="__codelineno-11-416" name="__codelineno-11-416" href="#__codelineno-11-416"></a>
</span><span id="__span-11-417"><a id="__codelineno-11-417" name="__codelineno-11-417" href="#__codelineno-11-417"></a>                <span class="n">max_ws_values</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="__span-11-418"><a id="__codelineno-11-418" name="__codelineno-11-418" href="#__codelineno-11-418"></a>                    <span class="s1">&#39;plan_number&#39;</span><span class="p">:</span> <span class="n">plan_number</span><span class="p">,</span>
</span><span id="__span-11-419"><a id="__codelineno-11-419" name="__codelineno-11-419" href="#__codelineno-11-419"></a>                    <span class="s1">&#39;shortid&#39;</span><span class="p">:</span> <span class="n">shortid</span><span class="p">,</span>
</span><span id="__span-11-420"><a id="__codelineno-11-420" name="__codelineno-11-420" href="#__codelineno-11-420"></a>                    <span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="n">land_cover</span><span class="p">,</span>
</span><span id="__span-11-421"><a id="__codelineno-11-421" name="__codelineno-11-421" href="#__codelineno-11-421"></a>                    <span class="s1">&#39;region_name&#39;</span><span class="p">:</span> <span class="n">region_name</span><span class="p">,</span>
</span><span id="__span-11-422"><a id="__codelineno-11-422" name="__codelineno-11-422" href="#__codelineno-11-422"></a>                    <span class="s1">&#39;n_value&#39;</span><span class="p">:</span> <span class="n">n_value</span><span class="p">,</span>
</span><span id="__span-11-423"><a id="__codelineno-11-423" name="__codelineno-11-423" href="#__codelineno-11-423"></a>                    <span class="s1">&#39;max_water_surface&#39;</span><span class="p">:</span> <span class="n">max_ws</span>
</span><span id="__span-11-424"><a id="__codelineno-11-424" name="__codelineno-11-424" href="#__codelineno-11-424"></a>                <span class="p">})</span>
</span><span id="__span-11-425"><a id="__codelineno-11-425" name="__codelineno-11-425" href="#__codelineno-11-425"></a>
</span><span id="__span-11-426"><a id="__codelineno-11-426" name="__codelineno-11-426" href="#__codelineno-11-426"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">: Max WSE = </span><span class="si">{</span><span class="n">max_ws</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-427"><a id="__codelineno-11-427" name="__codelineno-11-427" href="#__codelineno-11-427"></a>
</span><span id="__span-11-428"><a id="__codelineno-11-428" name="__codelineno-11-428" href="#__codelineno-11-428"></a>                <span class="c1"># Save time series to CSV</span>
</span><span id="__span-11-429"><a id="__codelineno-11-429" name="__codelineno-11-429" href="#__codelineno-11-429"></a>                <span class="n">ws_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;timeseries_</span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-11-430"><a id="__codelineno-11-430" name="__codelineno-11-430" href="#__codelineno-11-430"></a>
</span><span id="__span-11-431"><a id="__codelineno-11-431" name="__codelineno-11-431" href="#__codelineno-11-431"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-11-432"><a id="__codelineno-11-432" name="__codelineno-11-432" href="#__codelineno-11-432"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Error extracting results for </span><span class="si">{</span><span class="n">shortid</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-433"><a id="__codelineno-11-433" name="__codelineno-11-433" href="#__codelineno-11-433"></a>
</span><span id="__span-11-434"><a id="__codelineno-11-434" name="__codelineno-11-434" href="#__codelineno-11-434"></a>        <span class="c1"># Create summary DataFrame</span>
</span><span id="__span-11-435"><a id="__codelineno-11-435" name="__codelineno-11-435" href="#__codelineno-11-435"></a>        <span class="k">if</span> <span class="n">max_ws_values</span><span class="p">:</span>
</span><span id="__span-11-436"><a id="__codelineno-11-436" name="__codelineno-11-436" href="#__codelineno-11-436"></a>            <span class="n">max_ws_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">max_ws_values</span><span class="p">)</span>
</span><span id="__span-11-437"><a id="__codelineno-11-437" name="__codelineno-11-437" href="#__codelineno-11-437"></a>            <span class="n">max_ws_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">results_dir</span> <span class="o">/</span> <span class="s2">&quot;max_water_surface_summary.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-11-438"><a id="__codelineno-11-438" name="__codelineno-11-438" href="#__codelineno-11-438"></a>
</span><span id="__span-11-439"><a id="__codelineno-11-439" name="__codelineno-11-439" href="#__codelineno-11-439"></a>            <span class="c1"># Create plots by land cover type and region</span>
</span><span id="__span-11-440"><a id="__codelineno-11-440" name="__codelineno-11-440" href="#__codelineno-11-440"></a>            <span class="n">land_cover_region_combinations</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-11-441"><a id="__codelineno-11-441" name="__codelineno-11-441" href="#__codelineno-11-441"></a>
</span><span id="__span-11-442"><a id="__codelineno-11-442" name="__codelineno-11-442" href="#__codelineno-11-442"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">max_ws_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
</span><span id="__span-11-443"><a id="__codelineno-11-443" name="__codelineno-11-443" href="#__codelineno-11-443"></a>                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-444"><a id="__codelineno-11-444" name="__codelineno-11-444" href="#__codelineno-11-444"></a>                    <span class="n">combination</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">])</span>
</span><span id="__span-11-445"><a id="__codelineno-11-445" name="__codelineno-11-445" href="#__codelineno-11-445"></a>                    <span class="k">if</span> <span class="n">combination</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">land_cover_region_combinations</span><span class="p">:</span>
</span><span id="__span-11-446"><a id="__codelineno-11-446" name="__codelineno-11-446" href="#__codelineno-11-446"></a>                        <span class="n">land_cover_region_combinations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
</span><span id="__span-11-447"><a id="__codelineno-11-447" name="__codelineno-11-447" href="#__codelineno-11-447"></a>
</span><span id="__span-11-448"><a id="__codelineno-11-448" name="__codelineno-11-448" href="#__codelineno-11-448"></a>            <span class="c1"># Create sensitivity plots for each land cover + region combination</span>
</span><span id="__span-11-449"><a id="__codelineno-11-449" name="__codelineno-11-449" href="#__codelineno-11-449"></a>            <span class="k">for</span> <span class="n">land_cover</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">land_cover_region_combinations</span><span class="p">:</span>
</span><span id="__span-11-450"><a id="__codelineno-11-450" name="__codelineno-11-450" href="#__codelineno-11-450"></a>                <span class="c1"># Filter scenarios for this combination</span>
</span><span id="__span-11-451"><a id="__codelineno-11-451" name="__codelineno-11-451" href="#__codelineno-11-451"></a>                <span class="n">combo_scenarios</span> <span class="o">=</span> <span class="n">max_ws_df</span><span class="p">[</span>
</span><span id="__span-11-452"><a id="__codelineno-11-452" name="__codelineno-11-452" href="#__codelineno-11-452"></a>                    <span class="p">(</span><span class="n">max_ws_df</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span><span class="p">)</span> <span class="o">&amp;</span> 
</span><span id="__span-11-453"><a id="__codelineno-11-453" name="__codelineno-11-453" href="#__codelineno-11-453"></a>                    <span class="p">(</span><span class="n">max_ws_df</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span><span class="p">)</span>
</span><span id="__span-11-454"><a id="__codelineno-11-454" name="__codelineno-11-454" href="#__codelineno-11-454"></a>                <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-11-455"><a id="__codelineno-11-455" name="__codelineno-11-455" href="#__codelineno-11-455"></a>
</span><span id="__span-11-456"><a id="__codelineno-11-456" name="__codelineno-11-456" href="#__codelineno-11-456"></a>                <span class="c1"># Add the template scenario</span>
</span><span id="__span-11-457"><a id="__codelineno-11-457" name="__codelineno-11-457" href="#__codelineno-11-457"></a>                <span class="n">template_row</span> <span class="o">=</span> <span class="n">max_ws_df</span><span class="p">[</span><span class="n">max_ws_df</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Template&#39;</span><span class="p">]</span>
</span><span id="__span-11-458"><a id="__codelineno-11-458" name="__codelineno-11-458" href="#__codelineno-11-458"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-459"><a id="__codelineno-11-459" name="__codelineno-11-459" href="#__codelineno-11-459"></a>                    <span class="n">combo_scenarios</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">template_row</span><span class="p">,</span> <span class="n">combo_scenarios</span><span class="p">])</span>
</span><span id="__span-11-460"><a id="__codelineno-11-460" name="__codelineno-11-460" href="#__codelineno-11-460"></a>
</span><span id="__span-11-461"><a id="__codelineno-11-461" name="__codelineno-11-461" href="#__codelineno-11-461"></a>                <span class="k">if</span> <span class="n">combo_scenarios</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-462"><a id="__codelineno-11-462" name="__codelineno-11-462" href="#__codelineno-11-462"></a>                    <span class="k">continue</span>
</span><span id="__span-11-463"><a id="__codelineno-11-463" name="__codelineno-11-463" href="#__codelineno-11-463"></a>
</span><span id="__span-11-464"><a id="__codelineno-11-464" name="__codelineno-11-464" href="#__codelineno-11-464"></a>                <span class="c1"># Sort by n_value</span>
</span><span id="__span-11-465"><a id="__codelineno-11-465" name="__codelineno-11-465" href="#__codelineno-11-465"></a>                <span class="n">combo_scenarios</span> <span class="o">=</span> <span class="n">combo_scenarios</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;n_value&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-11-466"><a id="__codelineno-11-466" name="__codelineno-11-466" href="#__codelineno-11-466"></a>
</span><span id="__span-11-467"><a id="__codelineno-11-467" name="__codelineno-11-467" href="#__codelineno-11-467"></a>                <span class="c1"># Create plot</span>
</span><span id="__span-11-468"><a id="__codelineno-11-468" name="__codelineno-11-468" href="#__codelineno-11-468"></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-11-469"><a id="__codelineno-11-469" name="__codelineno-11-469" href="#__codelineno-11-469"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">combo_scenarios</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">],</span> <span class="n">combo_scenarios</span><span class="p">[</span><span class="s1">&#39;max_water_surface&#39;</span><span class="p">],</span> 
</span><span id="__span-11-470"><a id="__codelineno-11-470" name="__codelineno-11-470" href="#__codelineno-11-470"></a>                         <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-11-471"><a id="__codelineno-11-471" name="__codelineno-11-471" href="#__codelineno-11-471"></a>
</span><span id="__span-11-472"><a id="__codelineno-11-472" name="__codelineno-11-472" href="#__codelineno-11-472"></a>                <span class="c1"># Add template point in a different color if it exists</span>
</span><span id="__span-11-473"><a id="__codelineno-11-473" name="__codelineno-11-473" href="#__codelineno-11-473"></a>                <span class="n">template_idx</span> <span class="o">=</span> <span class="n">combo_scenarios</span><span class="p">[</span><span class="n">combo_scenarios</span><span class="p">[</span><span class="s1">&#39;shortid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Template&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</span><span id="__span-11-474"><a id="__codelineno-11-474" name="__codelineno-11-474" href="#__codelineno-11-474"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_idx</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-475"><a id="__codelineno-11-475" name="__codelineno-11-475" href="#__codelineno-11-475"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">combo_scenarios</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">template_idx</span><span class="p">,</span> <span class="s1">&#39;n_value&#39;</span><span class="p">],</span> 
</span><span id="__span-11-476"><a id="__codelineno-11-476" name="__codelineno-11-476" href="#__codelineno-11-476"></a>                                <span class="n">combo_scenarios</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">template_idx</span><span class="p">,</span> <span class="s1">&#39;max_water_surface&#39;</span><span class="p">],</span>
</span><span id="__span-11-477"><a id="__codelineno-11-477" name="__codelineno-11-477" href="#__codelineno-11-477"></a>                                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Template&#39;</span><span class="p">)</span>
</span><span id="__span-11-478"><a id="__codelineno-11-478" name="__codelineno-11-478" href="#__codelineno-11-478"></a>
</span><span id="__span-11-479"><a id="__codelineno-11-479" name="__codelineno-11-479" href="#__codelineno-11-479"></a>                <span class="c1"># Add labels and title</span>
</span><span id="__span-11-480"><a id="__codelineno-11-480" name="__codelineno-11-480" href="#__codelineno-11-480"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-481"><a id="__codelineno-11-481" name="__codelineno-11-481" href="#__codelineno-11-481"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Maximum Water Surface Elevation (ft)&quot;</span><span class="p">)</span>
</span><span id="__span-11-482"><a id="__codelineno-11-482" name="__codelineno-11-482" href="#__codelineno-11-482"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sensitivity to </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> Manning&#39;s n Value in </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-483"><a id="__codelineno-11-483" name="__codelineno-11-483" href="#__codelineno-11-483"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-11-484"><a id="__codelineno-11-484" name="__codelineno-11-484" href="#__codelineno-11-484"></a>
</span><span id="__span-11-485"><a id="__codelineno-11-485" name="__codelineno-11-485" href="#__codelineno-11-485"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">template_idx</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="__span-11-486"><a id="__codelineno-11-486" name="__codelineno-11-486" href="#__codelineno-11-486"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-11-487"><a id="__codelineno-11-487" name="__codelineno-11-487" href="#__codelineno-11-487"></a>
</span><span id="__span-11-488"><a id="__codelineno-11-488" name="__codelineno-11-488" href="#__codelineno-11-488"></a>                <span class="c1"># Save plot</span>
</span><span id="__span-11-489"><a id="__codelineno-11-489" name="__codelineno-11-489" href="#__codelineno-11-489"></a>                <span class="n">safe_lc</span> <span class="o">=</span> <span class="n">land_cover</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-11-490"><a id="__codelineno-11-490" name="__codelineno-11-490" href="#__codelineno-11-490"></a>                <span class="n">safe_rg</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-11-491"><a id="__codelineno-11-491" name="__codelineno-11-491" href="#__codelineno-11-491"></a>                <span class="n">plot_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;sensitivity_</span><span class="si">{</span><span class="n">safe_lc</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">safe_rg</span><span class="si">}</span><span class="s2">.png&quot;</span>
</span><span id="__span-11-492"><a id="__codelineno-11-492" name="__codelineno-11-492" href="#__codelineno-11-492"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-11-493"><a id="__codelineno-11-493" name="__codelineno-11-493" href="#__codelineno-11-493"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_path</span><span class="p">)</span>
</span><span id="__span-11-494"><a id="__codelineno-11-494" name="__codelineno-11-494" href="#__codelineno-11-494"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-11-495"><a id="__codelineno-11-495" name="__codelineno-11-495" href="#__codelineno-11-495"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-11-496"><a id="__codelineno-11-496" name="__codelineno-11-496" href="#__codelineno-11-496"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created sensitivity plot for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-497"><a id="__codelineno-11-497" name="__codelineno-11-497" href="#__codelineno-11-497"></a>
</span><span id="__span-11-498"><a id="__codelineno-11-498" name="__codelineno-11-498" href="#__codelineno-11-498"></a>            <span class="c1"># Create time series comparison plots for each land cover + region combination</span>
</span><span id="__span-11-499"><a id="__codelineno-11-499" name="__codelineno-11-499" href="#__codelineno-11-499"></a>            <span class="k">for</span> <span class="n">land_cover</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">land_cover_region_combinations</span><span class="p">:</span>
</span><span id="__span-11-500"><a id="__codelineno-11-500" name="__codelineno-11-500" href="#__codelineno-11-500"></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="__span-11-501"><a id="__codelineno-11-501" name="__codelineno-11-501" href="#__codelineno-11-501"></a>
</span><span id="__span-11-502"><a id="__codelineno-11-502" name="__codelineno-11-502" href="#__codelineno-11-502"></a>                <span class="c1"># Get template results</span>
</span><span id="__span-11-503"><a id="__codelineno-11-503" name="__codelineno-11-503" href="#__codelineno-11-503"></a>                <span class="n">template_plan</span> <span class="o">=</span> <span class="n">scenarios</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-11-504"><a id="__codelineno-11-504" name="__codelineno-11-504" href="#__codelineno-11-504"></a>                <span class="k">if</span> <span class="n">template_plan</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">:</span>
</span><span id="__span-11-505"><a id="__codelineno-11-505" name="__codelineno-11-505" href="#__codelineno-11-505"></a>                    <span class="n">template_df</span> <span class="o">=</span> <span class="n">all_results</span><span class="p">[</span><span class="n">template_plan</span><span class="p">][</span><span class="s1">&#39;df&#39;</span><span class="p">]</span>
</span><span id="__span-11-506"><a id="__codelineno-11-506" name="__codelineno-11-506" href="#__codelineno-11-506"></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">template_df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">template_df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">],</span> 
</span><span id="__span-11-507"><a id="__codelineno-11-507" name="__codelineno-11-507" href="#__codelineno-11-507"></a>                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Template&#39;</span><span class="p">)</span>
</span><span id="__span-11-508"><a id="__codelineno-11-508" name="__codelineno-11-508" href="#__codelineno-11-508"></a>
</span><span id="__span-11-509"><a id="__codelineno-11-509" name="__codelineno-11-509" href="#__codelineno-11-509"></a>                <span class="c1"># Filter scenarios for this combination</span>
</span><span id="__span-11-510"><a id="__codelineno-11-510" name="__codelineno-11-510" href="#__codelineno-11-510"></a>                <span class="n">combo_scenarios</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-11-511"><a id="__codelineno-11-511" name="__codelineno-11-511" href="#__codelineno-11-511"></a>                    <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scenarios</span> 
</span><span id="__span-11-512"><a id="__codelineno-11-512" name="__codelineno-11-512" href="#__codelineno-11-512"></a>                    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;land_cover&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">land_cover</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;region_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">region</span>
</span><span id="__span-11-513"><a id="__codelineno-11-513" name="__codelineno-11-513" href="#__codelineno-11-513"></a>                <span class="p">]</span>
</span><span id="__span-11-514"><a id="__codelineno-11-514" name="__codelineno-11-514" href="#__codelineno-11-514"></a>
</span><span id="__span-11-515"><a id="__codelineno-11-515" name="__codelineno-11-515" href="#__codelineno-11-515"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">combo_scenarios</span><span class="p">:</span>
</span><span id="__span-11-516"><a id="__codelineno-11-516" name="__codelineno-11-516" href="#__codelineno-11-516"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-11-517"><a id="__codelineno-11-517" name="__codelineno-11-517" href="#__codelineno-11-517"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-11-518"><a id="__codelineno-11-518" name="__codelineno-11-518" href="#__codelineno-11-518"></a>                    <span class="k">continue</span>
</span><span id="__span-11-519"><a id="__codelineno-11-519" name="__codelineno-11-519" href="#__codelineno-11-519"></a>
</span><span id="__span-11-520"><a id="__codelineno-11-520" name="__codelineno-11-520" href="#__codelineno-11-520"></a>                <span class="c1"># Setup colormap for n values</span>
</span><span id="__span-11-521"><a id="__codelineno-11-521" name="__codelineno-11-521" href="#__codelineno-11-521"></a>                <span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">combo_scenarios</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="__span-11-522"><a id="__codelineno-11-522" name="__codelineno-11-522" href="#__codelineno-11-522"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">n_values</span><span class="p">:</span>
</span><span id="__span-11-523"><a id="__codelineno-11-523" name="__codelineno-11-523" href="#__codelineno-11-523"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-11-524"><a id="__codelineno-11-524" name="__codelineno-11-524" href="#__codelineno-11-524"></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-11-525"><a id="__codelineno-11-525" name="__codelineno-11-525" href="#__codelineno-11-525"></a>                    <span class="k">continue</span>
</span><span id="__span-11-526"><a id="__codelineno-11-526" name="__codelineno-11-526" href="#__codelineno-11-526"></a>
</span><span id="__span-11-527"><a id="__codelineno-11-527" name="__codelineno-11-527" href="#__codelineno-11-527"></a>                <span class="n">min_n</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_values</span><span class="p">)</span>
</span><span id="__span-11-528"><a id="__codelineno-11-528" name="__codelineno-11-528" href="#__codelineno-11-528"></a>                <span class="n">max_n</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_values</span><span class="p">)</span>
</span><span id="__span-11-529"><a id="__codelineno-11-529" name="__codelineno-11-529" href="#__codelineno-11-529"></a>                <span class="n">norm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">min_n</span><span class="p">,</span> <span class="n">max_n</span><span class="p">)</span>
</span><span id="__span-11-530"><a id="__codelineno-11-530" name="__codelineno-11-530" href="#__codelineno-11-530"></a>                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span>
</span><span id="__span-11-531"><a id="__codelineno-11-531" name="__codelineno-11-531" href="#__codelineno-11-531"></a>
</span><span id="__span-11-532"><a id="__codelineno-11-532" name="__codelineno-11-532" href="#__codelineno-11-532"></a>                <span class="c1"># Plot each scenario</span>
</span><span id="__span-11-533"><a id="__codelineno-11-533" name="__codelineno-11-533" href="#__codelineno-11-533"></a>                <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">combo_scenarios</span><span class="p">:</span>
</span><span id="__span-11-534"><a id="__codelineno-11-534" name="__codelineno-11-534" href="#__codelineno-11-534"></a>                    <span class="n">plan_number</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;plan_number&#39;</span><span class="p">]</span>
</span><span id="__span-11-535"><a id="__codelineno-11-535" name="__codelineno-11-535" href="#__codelineno-11-535"></a>                    <span class="n">n_value</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;n_value&#39;</span><span class="p">]</span>
</span><span id="__span-11-536"><a id="__codelineno-11-536" name="__codelineno-11-536" href="#__codelineno-11-536"></a>
</span><span id="__span-11-537"><a id="__codelineno-11-537" name="__codelineno-11-537" href="#__codelineno-11-537"></a>                    <span class="k">if</span> <span class="n">plan_number</span> <span class="ow">in</span> <span class="n">all_results</span> <span class="ow">and</span> <span class="n">n_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-11-538"><a id="__codelineno-11-538" name="__codelineno-11-538" href="#__codelineno-11-538"></a>                        <span class="n">df</span> <span class="o">=</span> <span class="n">all_results</span><span class="p">[</span><span class="n">plan_number</span><span class="p">][</span><span class="s1">&#39;df&#39;</span><span class="p">]</span>
</span><span id="__span-11-539"><a id="__codelineno-11-539" name="__codelineno-11-539" href="#__codelineno-11-539"></a>                        <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">n_value</span><span class="p">))</span>
</span><span id="__span-11-540"><a id="__codelineno-11-540" name="__codelineno-11-540" href="#__codelineno-11-540"></a>                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;water_surface&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> 
</span><span id="__span-11-541"><a id="__codelineno-11-541" name="__codelineno-11-541" href="#__codelineno-11-541"></a>                                 <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;n = </span><span class="si">{</span><span class="n">n_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-542"><a id="__codelineno-11-542" name="__codelineno-11-542" href="#__codelineno-11-542"></a>
</span><span id="__span-11-543"><a id="__codelineno-11-543" name="__codelineno-11-543" href="#__codelineno-11-543"></a>                <span class="c1"># Add labels and title</span>
</span><span id="__span-11-544"><a id="__codelineno-11-544" name="__codelineno-11-544" href="#__codelineno-11-544"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="__span-11-545"><a id="__codelineno-11-545" name="__codelineno-11-545" href="#__codelineno-11-545"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water Surface Elevation (ft)&quot;</span><span class="p">)</span>
</span><span id="__span-11-546"><a id="__codelineno-11-546" name="__codelineno-11-546" href="#__codelineno-11-546"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WSE Time Series for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-547"><a id="__codelineno-11-547" name="__codelineno-11-547" href="#__codelineno-11-547"></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-11-548"><a id="__codelineno-11-548" name="__codelineno-11-548" href="#__codelineno-11-548"></a>
</span><span id="__span-11-549"><a id="__codelineno-11-549" name="__codelineno-11-549" href="#__codelineno-11-549"></a>                <span class="c1"># Add colorbar</span>
</span><span id="__span-11-550"><a id="__codelineno-11-550" name="__codelineno-11-550" href="#__codelineno-11-550"></a>                <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
</span><span id="__span-11-551"><a id="__codelineno-11-551" name="__codelineno-11-551" href="#__codelineno-11-551"></a>                <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
</span><span id="__span-11-552"><a id="__codelineno-11-552" name="__codelineno-11-552" href="#__codelineno-11-552"></a>                <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</span><span id="__span-11-553"><a id="__codelineno-11-553" name="__codelineno-11-553" href="#__codelineno-11-553"></a>                <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-554"><a id="__codelineno-11-554" name="__codelineno-11-554" href="#__codelineno-11-554"></a>
</span><span id="__span-11-555"><a id="__codelineno-11-555" name="__codelineno-11-555" href="#__codelineno-11-555"></a>                <span class="c1"># Save plot</span>
</span><span id="__span-11-556"><a id="__codelineno-11-556" name="__codelineno-11-556" href="#__codelineno-11-556"></a>                <span class="n">safe_lc</span> <span class="o">=</span> <span class="n">land_cover</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-11-557"><a id="__codelineno-11-557" name="__codelineno-11-557" href="#__codelineno-11-557"></a>                <span class="n">safe_rg</span> <span class="o">=</span> <span class="n">region</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="__span-11-558"><a id="__codelineno-11-558" name="__codelineno-11-558" href="#__codelineno-11-558"></a>                <span class="n">plot_path</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;timeseries_</span><span class="si">{</span><span class="n">safe_lc</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">safe_rg</span><span class="si">}</span><span class="s2">.png&quot;</span>
</span><span id="__span-11-559"><a id="__codelineno-11-559" name="__codelineno-11-559" href="#__codelineno-11-559"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-11-560"><a id="__codelineno-11-560" name="__codelineno-11-560" href="#__codelineno-11-560"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_path</span><span class="p">)</span>
</span><span id="__span-11-561"><a id="__codelineno-11-561" name="__codelineno-11-561" href="#__codelineno-11-561"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-11-562"><a id="__codelineno-11-562" name="__codelineno-11-562" href="#__codelineno-11-562"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-11-563"><a id="__codelineno-11-563" name="__codelineno-11-563" href="#__codelineno-11-563"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created time series plot for </span><span class="si">{</span><span class="n">land_cover</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-564"><a id="__codelineno-11-564" name="__codelineno-11-564" href="#__codelineno-11-564"></a>
</span><span id="__span-11-565"><a id="__codelineno-11-565" name="__codelineno-11-565" href="#__codelineno-11-565"></a>    <span class="c1"># Return results</span>
</span><span id="__span-11-566"><a id="__codelineno-11-566" name="__codelineno-11-566" href="#__codelineno-11-566"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-11-567"><a id="__codelineno-11-567" name="__codelineno-11-567" href="#__codelineno-11-567"></a>        <span class="s1">&#39;scenarios&#39;</span><span class="p">:</span> <span class="n">scenarios</span><span class="p">,</span>
</span><span id="__span-11-568"><a id="__codelineno-11-568" name="__codelineno-11-568" href="#__codelineno-11-568"></a>        <span class="s1">&#39;execution_results&#39;</span><span class="p">:</span> <span class="n">execution_results</span> <span class="k">if</span> <span class="s1">&#39;execution_results&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-569"><a id="__codelineno-11-569" name="__codelineno-11-569" href="#__codelineno-11-569"></a>        <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">all_results</span> <span class="k">if</span> <span class="s1">&#39;all_results&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-570"><a id="__codelineno-11-570" name="__codelineno-11-570" href="#__codelineno-11-570"></a>        <span class="s1">&#39;max_ws_summary&#39;</span><span class="p">:</span> <span class="n">max_ws_df</span> <span class="k">if</span> <span class="s1">&#39;max_ws_df&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-11-571"><a id="__codelineno-11-571" name="__codelineno-11-571" href="#__codelineno-11-571"></a>        <span class="s1">&#39;significant_landuses&#39;</span><span class="p">:</span> <span class="n">filtered_landuses</span><span class="p">,</span>
</span><span id="__span-11-572"><a id="__codelineno-11-572" name="__codelineno-11-572" href="#__codelineno-11-572"></a>        <span class="s1">&#39;output_folder&#39;</span><span class="p">:</span> <span class="n">results_dir</span>
</span><span id="__span-11-573"><a id="__codelineno-11-573" name="__codelineno-11-573" href="#__codelineno-11-573"></a>    <span class="p">}</span>
</span></code></pre></div>
<hr />
<hr />
<h2 id="important-engineering-note-on-regional-overrides"> Important Engineering Note on Regional Overrides<a class="headerlink" href="#important-engineering-note-on-regional-overrides" title="Permanent link">&para;</a></h2>
<p>We are using a HEC Example project with regional overriddes in the main channel.  A better application would be to vary values individually within larger calibration regions.  A further explanation follows: </p>
<p><strong>Main Channel vs. Floodplain Application:</strong></p>
<p>For <strong>main channel</strong> regional overrides, a <strong>bulk sensitivity approach</strong> is typically more appropriate (see notebook 105 for bulk Manning's n variation). This is because:</p>
<ol>
<li><strong>Land use-based roughness</strong> values are derived from satellite imagery, which may not correlate well with main channel hydraulic roughness</li>
<li><strong>Main channel roughness</strong> is typically governed by bed material, channel shape, and vegetation conditionsnot upland land cover classifications</li>
<li><strong>Bulk variation</strong> allows testing a continuous range of main channel n values without land use constraints</li>
</ol>
<p><strong>This Methodology Best Applied To:</strong>
- Large calibration regions within the 2D mesh area
- Floodplain zones with distinct land cover characteristics
- Areas where satellite-derived land use correlates with hydraulic roughness</p>
<p><strong>For Main Channel Calibration:</strong>
- Use the bulk sensitivity approach from notebook 105
- Create multiple regional overrides to test different main channel reaches independently
- Consider physical channel characteristics rather than land cover when selecting test values</p>
<p><strong>Note on Example Project:</strong>
This notebook demonstrates the regional sensitivity methodology using the BaldEagleCrkMulti2D main channel region due to limited availability of example models with large floodplain calibration regions. In practice, apply this approach to appropriate floodplain or mesh regions where land cover-based roughness is hydraulically meaningful.</p>
<h2 id="executing-regional-override-sensitivity-analysis">Executing Regional Override Sensitivity Analysis<a class="headerlink" href="#executing-regional-override-sensitivity-analysis" title="Permanent link">&para;</a></h2>
<h3 id="configuration-parameters_1">Configuration Parameters<a class="headerlink" href="#configuration-parameters_1" title="Permanent link">&para;</a></h3>
<p>The following example demonstrates how to run the regional override sensitivity analysis with the BaldEagleCrkMulti2D sample project.</p>
<p><strong>Key Parameters (in addition to base parameters):</strong>
- <code>region_name</code>: Specific region to analyze (e.g., "Main Channel"), or <code>None</code> to analyze all regions
- All other parameters match the base sensitivity function</p>
<p><strong>Region-Specific Behavior:</strong>
- Only land covers present in the specified region(s) will be tested
- The function automatically filters significant land uses based on region membership
- Multiple regions with the same land cover will be tested independently</p>
<h3 id="execution-steps_1">Execution Steps<a class="headerlink" href="#execution-steps_1" title="Permanent link">&para;</a></h3>
<ol>
<li>Use the same project from the base analysis (already extracted)</li>
<li>Configure regional analysis parameters (note the <code>region_name</code> parameter)</li>
<li>Run the sensitivity analysis</li>
<li>Review region-specific results in the output folder</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Define the mannings n max and min values as a range. </span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">manning_data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;NoData&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Barren Land Rock/Sand/Clay&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cultivated Crops&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deciduous Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, High Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Low Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Medium Intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Developed, Open Space&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Emergent Herbaceous Wetlands&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Evergreen Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Grassland/Herbaceous&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Mixed Forest&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Open Water&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Pasture/Hay&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Shrub/Scrub&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">},</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    <span class="p">{</span><span class="s2">&quot;Land Cover Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Woody Wetlands&quot;</span><span class="p">,</span> <span class="s2">&quot;min_n&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s2">&quot;max_n&quot;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">}</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="p">]</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="c1"># Create DataFrame</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="n">manning_minmax_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">manning_data</span><span class="p">)</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="c1"># Calculate the midpoint value</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;mid_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;min_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">manning_minmax_df</span><span class="p">[</span><span class="s1">&#39;max_n&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="c1"># Sort by land cover name</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="n">manning_minmax_df</span> <span class="o">=</span> <span class="n">manning_minmax_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Land Cover Name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="c1"># Print summary information</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manning&#39;s n value ranges for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> land cover types:&quot;</span><span class="p">)</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="nb">print</span><span class="p">(</span><span class="n">manning_minmax_df</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Example usage for Regional Overrides Sensitivity Analysis</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1"># To run this, uncomment the code, adjust parameters as needed, and execute the cell</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1"># 1. Define source and destination paths</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="c1">#    (We use the original extracted project as source, not the BOMIS one)</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="n">source_project_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;example_projects&quot;</span> <span class="o">/</span> <span class="s2">&quot;BaldEagleCrkMulti2D&quot;</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="c1"># 2. Create a specific folder for Regional Override Multi-Interval Sensitivity (ROMIS)</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="n">project_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&quot;example_projects&quot;</span> <span class="o">/</span> <span class="s2">&quot;BaldEagleCrkMulti2D_ROMIS&quot;</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c1"># Clean up if it already exists</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="k">if</span> <span class="n">project_folder</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">project_folder</span><span class="p">)</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="c1"># Copy the source project to the ROMIS folder</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating dedicated ROMIS project folder...&quot;</span><span class="p">)</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">source_project_folder</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">)</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created: </span><span class="si">{</span><span class="n">project_folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="c1"># 3. Initialize the ROMIS project</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="c1">#    (This updates the global &#39;ras&#39; object to point to this new folder, replacing the BOMIS context)</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="n">init_ras_project</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">RAS_VERSION</span><span class="p">)</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="c1"># Define parameters</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="n">template_plan</span> <span class="o">=</span> <span class="n">PLAN</span>  <span class="c1"># Plan 03 has regional overrides</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="n">point_of_interest</span> <span class="o">=</span> <span class="n">POINT_OF_INTEREST</span> <span class="c1"># Coordinates for regional analysis</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="c1"># Execute the template plan first (required for mesh cell identification and result extraction)</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> before sensitivity analysis...&quot;</span><span class="p">)</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="n">RasCmdr</span><span class="o">.</span><span class="n">compute_plan</span><span class="p">(</span><span class="n">template_plan</span><span class="p">,</span> <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">)</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Template plan </span><span class="si">{</span><span class="n">template_plan</span><span class="si">}</span><span class="s2"> execution complete.&quot;</span><span class="p">)</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="c1"># Run the regional sensitivity analysis</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="n">run_region_sensitivity_results</span> <span class="o">=</span> <span class="n">individual_landuse_sensitivity_region</span><span class="p">(</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>    <span class="n">project_folder</span><span class="o">=</span><span class="n">project_folder</span><span class="p">,</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a>    <span class="n">template_plan</span><span class="o">=</span><span class="n">template_plan</span><span class="p">,</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a>    <span class="n">point_of_interest</span><span class="o">=</span><span class="n">point_of_interest</span><span class="p">,</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a>    <span class="n">area_threshold</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># Only analyze land uses covering at least 10% of the mesh area</span>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a>    <span class="n">interval</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>       <span class="c1"># Adjust interval to reduce the number of test values</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a>    <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a>    <span class="n">num_cores</span><span class="o">=</span><span class="n">NUM_CORES</span><span class="p">,</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a>    <span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;Main Channel&quot;</span><span class="p">,</span>  <span class="c1"># Specify a region or set to None for all regions</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a>    <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;Regional_Landuse_Sensitivity&quot;</span><span class="p">,</span>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a>    <span class="n">n_ranges</span><span class="o">=</span><span class="n">manning_minmax_df</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Print summary information</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">if</span> <span class="n">run_region_sensitivity_results</span><span class="p">:</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analysis complete! Results saved to:&quot;</span><span class="p">,</span> <span class="n">run_region_sensitivity_results</span><span class="p">[</span><span class="s1">&#39;output_folder&#39;</span><span class="p">])</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="k">if</span> <span class="s1">&#39;significant_landuses&#39;</span> <span class="ow">in</span> <span class="n">run_region_sensitivity_results</span><span class="p">:</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Significant land uses analyzed in regions:&quot;</span><span class="p">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">run_region_sensitivity_results</span><span class="p">[</span><span class="s1">&#39;significant_landuses&#39;</span><span class="p">][[</span><span class="s1">&#39;Land Cover Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">]])</span>
</span></code></pre></div>
<hr />
<h2 id="regional-override-sensitivity-results">Regional Override Sensitivity Results<a class="headerlink" href="#regional-override-sensitivity-results" title="Permanent link">&para;</a></h2>
<h3 id="interpreting-regional-results">Interpreting Regional Results<a class="headerlink" href="#interpreting-regional-results" title="Permanent link">&para;</a></h3>
<p>The following plots show sensitivity analysis results for regional Manning's n overrides from the BaldEagleCrkMulti2D example project (Plan 03). The plots follow the same format as the base sensitivity results, but focus on parameters within specific calibration regions.</p>
<p><strong>Key Differences from Base Results:</strong>
- Plots are labeled with both land cover type AND region name
- Changes affect only the specified region, not the entire mesh
- Sensitivity may be higher or lower depending on the hydraulic importance of the region
- Useful for understanding which regional parameters require the most careful calibration</p>
<p><strong>Regional vs. Base Comparison:</strong>
- Compare the magnitude of water surface changes between regional and base sensitivity
- Regional parameters that cause large changes should be prioritized in calibration
- If a land cover has low sensitivity in a particular region, it may be acceptable to use default values</p>
<p><strong>Application to Your Models:</strong>
- Identify which regions have the strongest influence on your points of interest
- Focus calibration efforts on high-sensitivity regions
- Consider simplifying regions with low sensitivity</p>
<hr />
<h3 id="results-from-baldeaglecrkmulti2d-plan-03-main-channel-region">Results from BaldEagleCrkMulti2D, Plan 03 (Main Channel Region)<a class="headerlink" href="#results-from-baldeaglecrkmulti2d-plan-03-main-channel-region" title="Permanent link">&para;</a></h3>
<hr />
<h1 id="summary-and-best-practices">Summary and Best Practices<a class="headerlink" href="#summary-and-best-practices" title="Permanent link">&para;</a></h1>
<h2 id="key-takeaways">Key Takeaways<a class="headerlink" href="#key-takeaways" title="Permanent link">&para;</a></h2>
<h3 id="analysis-methodology">Analysis Methodology<a class="headerlink" href="#analysis-methodology" title="Permanent link">&para;</a></h3>
<p>This notebook demonstrated two complementary approaches to Manning's n sensitivity analysis:</p>
<ol>
<li><strong>Base Override Sensitivity</strong>: Tests global land cover roughness parameters across the entire 2D mesh</li>
<li><strong>Regional Override Sensitivity</strong>: Tests localized roughness parameters within specific calibration regions</li>
</ol>
<p>Both approaches use literature-based ranges to ensure physically reasonable parameter variations and automatically generate comprehensive visualizations.</p>
<h3 id="practical-applications">Practical Applications<a class="headerlink" href="#practical-applications" title="Permanent link">&para;</a></h3>
<p><strong>When to Use Base Sensitivity:</strong>
- Initial model exploration and parameter importance ranking
- Models with uniform land cover distributions
- Assessing global calibration uncertainty
- Identifying which land covers dominate model response</p>
<p><strong>When to Use Regional Sensitivity:</strong>
- Main channel calibration (use bulk approach from notebook 105)
- Localized parameter testing in specific hydraulic zones
- Floodplain region calibration with distinct characteristics
- Focused calibration in areas of interest</p>
<h3 id="calibration-workflow-recommendations">Calibration Workflow Recommendations<a class="headerlink" href="#calibration-workflow-recommendations" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Start with base sensitivity</strong> to identify globally important land covers</li>
<li><strong>Rank parameters by sensitivity</strong> - focus on land covers causing largest water surface changes</li>
<li><strong>Use regional sensitivity</strong> for localized refinement in hydraulically important areas</li>
<li><strong>Iterate with observed data</strong> - compare sensitivity results against measured water surfaces</li>
<li><strong>Document assumptions</strong> - record which parameters were adjusted and why</li>
</ol>
<h3 id="computational-efficiency-tips">Computational Efficiency Tips<a class="headerlink" href="#computational-efficiency-tips" title="Permanent link">&para;</a></h3>
<p><strong>Plan Count Management:</strong>
- Use larger <code>interval</code> values (e.g., 0.02-0.05) to reduce plan count
- Increase <code>area_threshold</code> to focus only on dominant land covers
- Target specific regions rather than analyzing all regions simultaneously
- HEC-RAS limits projects to 99 plans maximum</p>
<p><strong>Parallel Execution:</strong>
- Balance <code>max_workers</code> and <code>num_cores</code> based on available CPU and RAM
- Rule of thumb: <code>max_workers * num_cores  total_logical_cores</code>
- Monitor system resources during execution
- Consider sequential execution for very large or memory-intensive models</p>
<h3 id="output-files">Output Files<a class="headerlink" href="#output-files" title="Permanent link">&para;</a></h3>
<p>Each analysis creates a structured output folder containing:
- <code>scenarios.csv</code>: Complete plan inventory with parameter values
- <code>max_water_surface_summary.csv</code>: Peak water surface elevations for all scenarios
- <code>timeseries_*.csv</code>: Complete hydrographs for each scenario
- <code>sensitivity_*.png</code>: Parameter sensitivity plots
- <code>timeseries_*.png</code>: Time series comparison plots</p>
<h3 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Compare with observed data</strong>: Use sensitivity plots to guide calibration toward measured values</li>
<li><strong>Uncertainty quantification</strong>: Analyze the range of results to understand prediction uncertainty</li>
<li><strong>Spatial analysis</strong>: Extract results at multiple points to understand spatial variability</li>
<li><strong>Multi-objective calibration</strong>: Consider multiple performance metrics beyond peak water surface</li>
</ul>
<h3 id="related-notebooks">Related Notebooks<a class="headerlink" href="#related-notebooks" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Notebook 105</strong>: Bulk Manning's n sensitivity analysis (recommended for main channel calibration)</li>
<li><strong>Notebook 09</strong>: Plan parameter operations for additional customization</li>
<li><strong>Notebook 08</strong>: Parallel execution techniques for large-scale analyses</li>
</ul>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p><strong>Manning's n Value Resources:</strong>
- Chow, V.T. (1959). Open-Channel Hydraulics. McGraw-Hill
- Arcement, G.J., &amp; Schneider, V.R. (1989). Guide for Selecting Manning's Roughness Coefficients. USGS Water Supply Paper 2339
- HEC-RAS Hydraulic Reference Manual (current version)</p>
<p><strong>Sensitivity Analysis:</strong>
- Saltelli, A., et al. (2008). Global Sensitivity Analysis: The Primer. Wiley
- Tate, E., et al. (2015). Uncertainty Analysis for Flood Risk Assessment. Natural Hazards</p>
<hr />
<p><em>End of Notebook</em></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="December 20, 2025 13:34:08 UTC">December 20, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="December 20, 2025 13:34:08 UTC">December 20, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/gpt-cmdr/ras-commander" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@GPT_Commander" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
      
    
  </body>
</html>